# PyCaret 店長向け操作ガイド / Store Manager's User Guide

<div align="center">

![PyCaret Logo](../images/logo.png)

**Version 3.4.0**
**最終更新日 / Last Updated: 2025-10-08**

</div>

---

## 📚 目次 / Table of Contents

### 日本語セクション
1. [はじめに](#はじめに)
2. [PyCaretとは](#pycaretとは)
3. [インストール方法](#インストール方法)
4. [基本的な使い方](#基本的な使い方)
5. [実践例：売上予測](#実践例売上予測)
6. [よくある質問](#よくある質問)

### English Section
1. [Introduction](#introduction)
2. [What is PyCaret](#what-is-pycaret)
3. [Installation](#installation)
4. [Basic Usage](#basic-usage)
5. [Practical Example: Sales Forecasting](#practical-example-sales-forecasting)
6. [FAQ](#faq)

---

## 日本語 / Japanese

### はじめに

このガイドは、店舗運営やビジネス分析を行う店長・マネージャー向けに、PyCaretを使った機械学習の基本操作を説明します。プログラミング経験が少ない方でも、簡単にデータ分析と予測モデルを作成できます。

**対象者:**
- 店舗管理者
- ビジネスアナリスト
- データ分析初心者
- 売上予測や在庫管理の担当者

### PyCaretとは

PyCaretは、Pythonで使える**ローコード機械学習ライブラリ**です。

**主な特徴:**
- ✅ **簡単**: わずか数行のコードで高度な分析が可能
- ✅ **自動化**: モデル選択とチューニングを自動実行
- ✅ **可視化**: グラフやダッシュボードで結果を視覚的に確認
- ✅ **オープンソース**: 無料で誰でも使用可能

**できること:**
- 📊 売上予測
- 📈 顧客分類（セグメンテーション）
- 🔍 異常検知（不正検知、在庫異常など）
- ⏰ 時系列予測（需要予測）
- 📦 クラスタリング（顧客グループ分け）

### インストール方法

#### ステップ1: Pythonのインストール確認

まず、Pythonがインストールされているか確認します。

```bash
# コマンドプロンプトまたはターミナルで実行
python --version
```

**必要なバージョン:** Python 3.9, 3.10, 3.11, または 3.12

#### ステップ2: PyCaretのインストール

```bash
# 基本インストール
pip install pycaret

# フル機能版（推奨）
pip install pycaret[full]
```

**インストール時間:** 約5〜10分（インターネット速度により変動）

#### ステップ3: 動作確認

```python
# PythonインタラクティブシェルまたはJupyter Notebookで実行
import pycaret
print(pycaret.__version__)  # 3.4.0 と表示されればOK
```

### 基本的な使い方

#### 1. データの準備

PyCaretは、ExcelやCSVファイルを直接読み込めます。

```python
import pandas as pd

# CSVファイルの読み込み
data = pd.read_csv('売上データ.csv')

# Excelファイルの読み込み
data = pd.read_excel('売上データ.xlsx')

# データの確認
print(data.head())  # 最初の5行を表示
```

#### 2. 分類モデル（顧客分類の例）

```python
from pycaret.classification import *

# セットアップ（初期設定）
s = setup(data, target='購入有無', session_id=123)

# 最適なモデルを自動選択
best_model = compare_models()

# モデルの評価
evaluate_model(best_model)

# 予測の実行
predictions = predict_model(best_model, data=新規データ)
```

#### 3. 回帰モデル（売上予測の例）

```python
from pycaret.regression import *

# セットアップ
s = setup(data, target='売上金額', session_id=123)

# 最適なモデルを自動選択
best_model = compare_models()

# モデルの評価
evaluate_model(best_model)

# 予測の実行
predictions = predict_model(best_model)
```

#### 4. 時系列予測（需要予測の例）

```python
from pycaret.time_series import *

# セットアップ
s = setup(data, target='日次売上', fh=30, session_id=123)

# モデルの比較と選択
best_model = compare_models()

# 30日先までの予測
forecast = predict_model(best_model, fh=30)

# 結果のプロット
plot_model(best_model, plot='forecast')
```

### 実践例：売上予測

#### シナリオ
月次売上データから、次の3ヶ月の売上を予測します。

#### データの形式

| 日付       | 売上金額 | 来客数 | プロモーション |
|-----------|---------|--------|--------------|
| 2024-01-01 | 150000  | 120    | なし         |
| 2024-01-02 | 180000  | 145    | あり         |
| 2024-01-03 | 160000  | 130    | なし         |

#### 完全なコード例

```python
# 1. ライブラリのインポート
import pandas as pd
from pycaret.regression import *

# 2. データの読み込み
sales_data = pd.read_csv('月次売上.csv')

# 3. 日付型に変換
sales_data['日付'] = pd.to_datetime(sales_data['日付'])

# 4. 初期設定
reg_setup = setup(
    data=sales_data,
    target='売上金額',
    session_id=123,
    normalize=True,           # データの正規化
    feature_selection=True,   # 重要な特徴の自動選択
    remove_outliers=True      # 異常値の除去
)

# 5. 複数のモデルを比較
best_model = compare_models(n_select=3, sort='RMSE')

# 6. モデルの調整（ハイパーパラメータチューニング）
tuned_model = tune_model(best_model)

# 7. モデルの評価
evaluate_model(tuned_model)

# 8. 予測の実行
predictions = predict_model(tuned_model)

# 9. モデルの保存
save_model(tuned_model, '売上予測モデル')

# 10. 新しいデータで予測
new_data = pd.read_csv('新規データ.csv')
new_predictions = predict_model(tuned_model, data=new_data)

# 11. 結果をExcelに保存
new_predictions.to_excel('予測結果.xlsx', index=False)
```

### よくある質問

#### Q1: プログラミング経験がなくても使えますか？
**A:** はい、PyCaretはローコード設計のため、基本的なPythonの知識があれば使用できます。Jupyter NotebookやGoogle Colabを使えば、さらに簡単です。

#### Q2: どのくらいのデータ量が必要ですか？
**A:** 最低100行程度のデータがあれば分析可能ですが、精度を高めるには1000行以上が推奨されます。

#### Q3: 予測精度を上げるにはどうすればいいですか？
**A:**
- より多くのデータを収集する
- 関連性の高い特徴量（列）を追加する
- `tune_model()`でモデルを最適化する
- アンサンブル学習（`blend_models()`や`stack_models()`）を使う

#### Q4: エラーが出た場合はどうすればいいですか？
**A:** [トラブルシューティングガイド](../troubleshooting/common-issues.md)を参照してください。

#### Q5: 商用利用は可能ですか？
**A:** はい、PyCaretはMITライセンスで提供されており、商用利用も無料です。

---

## English

### Introduction

This guide provides store managers and business analysts with a comprehensive introduction to using PyCaret for machine learning tasks. Even with minimal programming experience, you can create powerful data analysis and predictive models.

**Target Audience:**
- Store managers
- Business analysts
- Data analysis beginners
- Sales forecasting and inventory management personnel

### What is PyCaret

PyCaret is a **low-code machine learning library** in Python.

**Key Features:**
- ✅ **Simple**: Perform advanced analysis with just a few lines of code
- ✅ **Automated**: Automatic model selection and tuning
- ✅ **Visualization**: Visual results through graphs and dashboards
- ✅ **Open Source**: Free for everyone

**Capabilities:**
- 📊 Sales forecasting
- 📈 Customer classification (segmentation)
- 🔍 Anomaly detection (fraud detection, inventory anomalies)
- ⏰ Time series forecasting (demand prediction)
- 📦 Clustering (customer grouping)

### Installation

#### Step 1: Verify Python Installation

First, check if Python is installed.

```bash
# Run in command prompt or terminal
python --version
```

**Required Version:** Python 3.9, 3.10, 3.11, or 3.12

#### Step 2: Install PyCaret

```bash
# Basic installation
pip install pycaret

# Full version (recommended)
pip install pycaret[full]
```

**Installation Time:** Approximately 5-10 minutes (varies with internet speed)

#### Step 3: Verify Installation

```python
# Run in Python interactive shell or Jupyter Notebook
import pycaret
print(pycaret.__version__)  # Should display 3.4.0
```

### Basic Usage

#### 1. Data Preparation

PyCaret can directly read Excel or CSV files.

```python
import pandas as pd

# Load CSV file
data = pd.read_csv('sales_data.csv')

# Load Excel file
data = pd.read_excel('sales_data.xlsx')

# View data
print(data.head())  # Display first 5 rows
```

#### 2. Classification Model (Customer Classification Example)

```python
from pycaret.classification import *

# Setup (initial configuration)
s = setup(data, target='purchase', session_id=123)

# Automatically select best model
best_model = compare_models()

# Evaluate model
evaluate_model(best_model)

# Make predictions
predictions = predict_model(best_model, data=new_data)
```

#### 3. Regression Model (Sales Forecasting Example)

```python
from pycaret.regression import *

# Setup
s = setup(data, target='sales_amount', session_id=123)

# Automatically select best model
best_model = compare_models()

# Evaluate model
evaluate_model(best_model)

# Make predictions
predictions = predict_model(best_model)
```

#### 4. Time Series Forecasting (Demand Forecasting Example)

```python
from pycaret.time_series import *

# Setup
s = setup(data, target='daily_sales', fh=30, session_id=123)

# Compare and select models
best_model = compare_models()

# Forecast 30 days ahead
forecast = predict_model(best_model, fh=30)

# Plot results
plot_model(best_model, plot='forecast')
```

### Practical Example: Sales Forecasting

#### Scenario
Predict sales for the next 3 months using monthly sales data.

#### Data Format

| Date       | Sales | Customers | Promotion |
|-----------|-------|-----------|-----------|
| 2024-01-01 | 150000 | 120      | No        |
| 2024-01-02 | 180000 | 145      | Yes       |
| 2024-01-03 | 160000 | 130      | No        |

#### Complete Code Example

```python
# 1. Import libraries
import pandas as pd
from pycaret.regression import *

# 2. Load data
sales_data = pd.read_csv('monthly_sales.csv')

# 3. Convert to datetime
sales_data['Date'] = pd.to_datetime(sales_data['Date'])

# 4. Setup
reg_setup = setup(
    data=sales_data,
    target='Sales',
    session_id=123,
    normalize=True,           # Normalize data
    feature_selection=True,   # Auto-select important features
    remove_outliers=True      # Remove outliers
)

# 5. Compare multiple models
best_model = compare_models(n_select=3, sort='RMSE')

# 6. Tune model (hyperparameter tuning)
tuned_model = tune_model(best_model)

# 7. Evaluate model
evaluate_model(tuned_model)

# 8. Make predictions
predictions = predict_model(tuned_model)

# 9. Save model
save_model(tuned_model, 'sales_forecast_model')

# 10. Predict on new data
new_data = pd.read_csv('new_data.csv')
new_predictions = predict_model(tuned_model, data=new_data)

# 11. Save results to Excel
new_predictions.to_excel('predictions.xlsx', index=False)
```

### FAQ

#### Q1: Can I use this without programming experience?
**A:** Yes, PyCaret's low-code design means you can use it with basic Python knowledge. Using Jupyter Notebook or Google Colab makes it even easier.

#### Q2: How much data do I need?
**A:** Analysis is possible with as little as 100 rows, but 1000+ rows are recommended for better accuracy.

#### Q3: How can I improve prediction accuracy?
**A:**
- Collect more data
- Add relevant features (columns)
- Optimize models with `tune_model()`
- Use ensemble learning (`blend_models()` or `stack_models()`)

#### Q4: What should I do if I get an error?
**A:** Refer to the [Troubleshooting Guide](../troubleshooting/common-issues.md).

#### Q5: Can I use this commercially?
**A:** Yes, PyCaret is provided under the MIT license and is free for commercial use.

---

## 📞 サポート / Support

### 日本語サポート
- Slack: [PyCaret Community](https://join.slack.com/t/pycaret/shared_invite/zt-row9phbm-BoJdEVPYnGf7_NxNBP307w)
- GitHub Discussions: [ディスカッション](https://github.com/pycaret/pycaret/discussions)

### English Support
- Documentation: [https://pycaret.gitbook.io/](https://pycaret.gitbook.io/)
- Tutorials: [https://pycaret.gitbook.io/docs/get-started/tutorials](https://pycaret.gitbook.io/docs/get-started/tutorials)
- YouTube: [PyCaret Channel](https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g)

---

**© 2025 PyCaret. Licensed under MIT License.**
