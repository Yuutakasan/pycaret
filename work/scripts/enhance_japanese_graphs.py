#!/usr/bin/env python3
"""
ã‚°ãƒ©ãƒ•ã®å®Œå…¨æ—¥æœ¬èªåŒ–ã¨è©³ç´°æ³¨é‡ˆè¿½åŠ 

ç›®çš„:
1. ã™ã¹ã¦ã®è‹±èªè¡¨è¨˜ã‚’æ—¥æœ¬èªã«å¤‰æ›
2. KPIãƒœãƒƒã‚¯ã‚¹ã€ã‚¢ãƒ©ãƒ¼ãƒˆã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ—¥æœ¬èªåŒ–
3. ã‚ˆã‚Šè©³ã—ã„åˆ¤æ–­åŸºæº–ã¨ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰ã‚’è¿½åŠ 
"""

import json
import shutil
from pathlib import Path
from datetime import datetime
import re


def create_enhanced_phase1_graph_cell():
    """Phase1ã®çµŒå–¶ã‚µãƒãƒªãƒ¼ã‚°ãƒ©ãƒ•ã‚’å®Œå…¨æ—¥æœ¬èªåŒ–"""
    return '''
# ğŸ“Š ã‚°ãƒ©ãƒ•ã®è¦‹æ–¹å®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼ˆåº—é•·å‘ã‘å®Ÿè·µãƒãƒ‹ãƒ¥ã‚¢ãƒ«ï¼‰
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€å·¦ä¸Šãƒ»å¤§ã€‘å£²ä¸Šæ¨ç§»ã‚°ãƒ©ãƒ• - æœ€é‡è¦ï¼æ¯æ—¥å¿…ãšç¢ºèª
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ“ˆ é’ç·šï¼ˆä»Šå¹´ã®å£²ä¸Šï¼‰ã®ä½ç½®ã§åˆ¤æ–­:
#   âœ… è‰¯å¥½: æ˜¨å¹´ï¼ˆãƒ”ãƒ³ã‚¯ç‚¹ç·šï¼‰ã‚ˆã‚Šå¸¸ã«ä¸Š
#   âš ï¸ æ³¨æ„: ç›®æ¨™ãƒ©ã‚¤ãƒ³ï¼ˆèµ¤ç‚¹ç·šï¼‰ã‚’ä¸‹å›ã‚‹æ—¥ãŒå¢—ãˆã¦ã„ã‚‹
#   ğŸ”´ å±é™º: æ˜¨å¹´ã‚’3æ—¥é€£ç¶šã§ä¸‹å›ã‚‹ â†’ å³åº§ã«å¯¾ç­–ä¼šè­°
#
# ğŸ’¡ å…·ä½“çš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:
#   - é’ç·šãŒä¸Šæ˜‡ â†’ ç¾åœ¨ã®æ–½ç­–ã‚’ç¶™ç¶šãƒ»å¼·åŒ–
#   - é’ç·šãŒä¸‹é™ â†’ å•†å“æ§‹æˆãƒ»äººå“¡é…ç½®ã‚’è¦‹ç›´ã—
#   - æ³¢ãŒå¤§ãã„ â†’ æ›œæ—¥åˆ¥ãƒ»å¤©å€™åˆ¥ã®å¯¾ç­–ãŒå¿…è¦
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€å³ä¸Šã€‘å‰å¹´æ¯”æˆé•·ç‡ï¼ˆç›´è¿‘30æ—¥ï¼‰ - ãƒˆãƒ¬ãƒ³ãƒ‰æŠŠæ¡ç”¨
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸŸ¢ ç·‘ãƒãƒ¼ï¼ˆãƒ—ãƒ©ã‚¹æˆé•·ï¼‰:
#   - 10%ä»¥ä¸Š â†’ å„ªç§€ï¼ãƒœãƒ¼ãƒŠã‚¹ç´šã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
#   - 5-10% â†’ è‰¯å¥½ã€ã“ã®èª¿å­ã‚’ç¶­æŒ
#   - 0-5% â†’ åŠç¬¬ç‚¹ã€ã•ã‚‰ãªã‚‹æ”¹å–„ä½™åœ°ã‚ã‚Š
#
# ğŸ”´ èµ¤ãƒãƒ¼ï¼ˆãƒã‚¤ãƒŠã‚¹æˆé•·ï¼‰:
#   - 0ï½-5% â†’ ã‚„ã‚„ä¸èª¿ã€åŸå› ã‚’åˆ†æ
#   - -5ï½-10% â†’ è¦æ”¹å–„ã€å…·ä½“çš„æ–½ç­–ãŒå¿…è¦
#   - -10%ä»¥ä¸‹ â†’ ç·Šæ€¥å¯¾ç­–å¿…é ˆï¼
#
# ğŸ’¡ åˆ¤æ–­ã®ãƒã‚¤ãƒ³ãƒˆ:
#   - é€£ç¶š3æ—¥ä»¥ä¸Šèµ¤ â†’ æ§‹é€ çš„å•é¡Œã‚ã‚Šã€æŠœæœ¬å¯¾ç­–ãŒå¿…è¦
#   - èµ¤ç·‘ãŒäº¤äº’ â†’ æ›œæ—¥ã‚„å¤©å€™ã®å½±éŸ¿ã€ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æã‚’
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€å³ä¸­ã€‘å¹³å‡å®¢å˜ä¾¡æ¨ç§» - ä½µå£²ãƒ»ã‚»ãƒƒãƒˆè²©å£²ã®åŠ¹æœæ¸¬å®š
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ“Š ã‚ªãƒ¬ãƒ³ã‚¸ç·šã®å‹•ã:
#   â†— ä¸Šæ˜‡ãƒˆãƒ¬ãƒ³ãƒ‰ â†’ ã‚»ãƒƒãƒˆè²©å£²ãŒåŠ¹ã„ã¦ã„ã‚‹ã€ç¶™ç¶šï¼
#   â†’ æ¨ªã°ã„ â†’ ç¾çŠ¶ç¶­æŒã€æ–°æ–½ç­–ã‚’æ¤œè¨
#   â†˜ ä¸‹é™ãƒˆãƒ¬ãƒ³ãƒ‰ â†’ ä½å˜ä¾¡å•†å“ã«ã‚·ãƒ•ãƒˆã€è¦æ”¹å–„
#
# ğŸ¯ ç›®æ¨™å€¤ï¼ˆèµ¤ç‚¹ç·šï¼‰ã¨ã®æ¯”è¼ƒ:
#   - å¸¸ã«ä¸Š â†’ å„ªç§€ãªè²©å£²ã‚¹ã‚­ãƒ«
#   - ä¸Šä¸‹ã™ã‚‹ â†’ æ™‚é–“å¸¯ãƒ»æ‹…å½“è€…ã§å·®ãŒã‚ã‚‹
#   - å¸¸ã«ä¸‹ â†’ ã‚¹ã‚¿ãƒƒãƒ•æ•™è‚²ãƒ»POPæ”¹å–„ãŒå¿…è¦
#
# ğŸ’¡ å®¢å˜ä¾¡ã‚’ä¸Šã’ã‚‹å³åŠ¹æ–½ç­–:
#   â‘  ãƒ¬ã‚¸æ¨ªã«é–¢é€£å•†å“ã‚’é…ç½®
#   â‘¡ ã€Œâ—‹â—‹å††ä»¥ä¸Šã§ãƒã‚¤ãƒ³ãƒˆ2å€ã€ç­‰ã®ä»•æ›ã‘
#   â‘¢ ã‚»ãƒƒãƒˆå•†å“ã‚’ç›®ç«‹ã¤å ´æ‰€ã«é™³åˆ—
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€ä¸‹æ®µå·¦ã€‘ã‚¢ãƒ©ãƒ¼ãƒˆ - ä»Šæ—¥å¯¾å‡¦ã™ã¹ãå•é¡Œ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ”´ èµ¤ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ å³åº§ã«å¯¾å¿œï¼ˆä»Šæ—¥ä¸­ï¼‰
# ğŸŸ¡ é»„ã‚¢ãƒ©ãƒ¼ãƒˆ â†’ æ—©ã‚ã«å¯¾å¿œï¼ˆ2-3æ—¥ä»¥å†…ï¼‰
# âœ… ã‚¢ãƒ©ãƒ¼ãƒˆãªã— â†’ è‰¯å¥½ã€ç¾çŠ¶ç¶­æŒ
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€ä¸‹æ®µä¸­ã€‘ä¸»è¦æŒ‡æ¨™ï¼ˆKPIï¼‰ - æ•°å­—ã§çŠ¶æ³æŠŠæ¡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ã“ã®4ã¤ã®æ•°å­—ã‚’æ¯æ—¥ãƒã‚§ãƒƒã‚¯:
#   1. å£²ä¸Š â†’ ç›®æ¨™é”æˆç‡ã‚’ç¢ºèª
#   2. å‰å¹´æ¯” â†’ ãƒ—ãƒ©ã‚¹ãªã‚‰å¥½èª¿
#   3. å®¢å˜ä¾¡ â†’ ä½µå£²æ–½ç­–ã®åŠ¹æœ
#   4. 7æ—¥ãƒˆãƒ¬ãƒ³ãƒ‰ â†’ ä¸Šæ˜‡/ä¸‹é™ã®æµã‚Œã‚’æŠŠæ¡
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€ä¸‹æ®µå³ã€‘ä»Šæ—¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ - å„ªå…ˆé †ä½ä»˜ãTODO
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# â˜ æœä¸€ç•ªã«ãƒã‚§ãƒƒã‚¯ã™ã¹ãé …ç›®
# â˜ ç™ºæ³¨å‰ã«ç¢ºèªã™ã¹ãé …ç›®
# â˜ å¤•æ–¹ã«æŒ¯ã‚Šè¿”ã‚‹é …ç›®


# ğŸ“ˆ çµŒå–¶ã‚µãƒãƒªãƒ¼ã®å¯è¦–åŒ–ï¼ˆå®Œå…¨æ—¥æœ¬èªç‰ˆï¼‰
fig = plt.figure(figsize=(18, 10))
gs = fig.add_gridspec(3, 3, hspace=0.3, wspace=0.3)

# 1. å£²ä¸Šæ¨ç§»ï¼ˆå·¦ä¸Šãƒ»å¤§ï¼‰
ax1 = fig.add_subplot(gs[0:2, 0:2])
ax1.plot(daily['æ—¥ä»˜'], daily['å£²ä¸Šé‡‘é¡'], marker='o', linewidth=2,
         label='ä»Šå¹´ã®å£²ä¸Š', color='#2E86AB')
ax1.plot(daily['æ—¥ä»˜'], daily['æ˜¨å¹´åŒæ—¥_å£²ä¸Š'], marker='s', linewidth=2,
         linestyle='--', label='æ˜¨å¹´ã®å£²ä¸Š', color='#A23B72', alpha=0.7)
ax1.axhline(y=target_sales, color='red', linestyle='--', linewidth=1,
            label='ç›®æ¨™ãƒ©ã‚¤ãƒ³')
ax1.set_title('ğŸ“ˆ å£²ä¸Šæ¨ç§»ï¼ˆæœ€é‡è¦ã‚°ãƒ©ãƒ•ï¼‰', fontsize=16, fontproperties=JP_FP)
ax1.set_ylabel('å£²ä¸Šé‡‘é¡ï¼ˆå††ï¼‰', fontsize=12, fontproperties=JP_FP)
ax1.legend(loc='upper left', prop=JP_FP)
ax1.grid(alpha=0.3)
# åˆ¤å®šåŸºæº–ã‚’ã‚°ãƒ©ãƒ•å†…ã«è¡¨ç¤º
ax1.text(0.02, 0.98, 'âœ… é’ç·šãŒä¸Š = å¥½èª¿\\nâš ï¸ èµ¤ç·šä¸‹å›ã‚‹ = è¦æ³¨æ„',
         transform=ax1.transAxes, fontsize=9, verticalalignment='top',
         bbox=dict(boxstyle='round', facecolor='white', alpha=0.8),
         fontproperties=JP_FP)

# 2. å‰å¹´æ¯”æˆé•·ç‡ï¼ˆå³ä¸Šï¼‰
ax2 = fig.add_subplot(gs[0, 2])
yoy_colors = ['green' if x > 0 else 'red' for x in daily.tail(30)['å‰å¹´æ¯”']]
ax2.bar(range(len(daily.tail(30))), daily.tail(30)['å‰å¹´æ¯”'],
        color=yoy_colors, alpha=0.7)
ax2.axhline(y=0, color='black', linewidth=0.8)
ax2.set_title('å‰å¹´æ¯”æˆé•·ç‡ï¼ˆç›´è¿‘30æ—¥ï¼‰', fontsize=12, fontproperties=JP_FP)
ax2.set_ylabel('æˆé•·ç‡ï¼ˆ%ï¼‰', fontsize=10, fontproperties=JP_FP)
ax2.set_xticks([])
ax2.grid(alpha=0.3)
# åˆ¤å®šåŸºæº–
ax2.text(0.02, 0.98, 'ğŸŸ¢ +5%ä»¥ä¸Š = å„ªç§€\\nğŸ”´ -5%ä»¥ä¸‹ = è¦æ”¹å–„',
         transform=ax2.transAxes, fontsize=8, verticalalignment='top',
         bbox=dict(boxstyle='round', facecolor='lightyellow', alpha=0.8),
         fontproperties=JP_FP)

# 3. å¹³å‡å®¢å˜ä¾¡ï¼ˆå³ä¸­ï¼‰
ax3 = fig.add_subplot(gs[1, 2])
ax3.plot(daily.tail(30)['æ—¥ä»˜'], daily.tail(30)['å®¢å˜ä¾¡'],
         marker='o', linewidth=2, color='#F18F01', label='å®Ÿç¸¾å®¢å˜ä¾¡')
ax3.axhline(y=daily['å®¢å˜ä¾¡'].mean(), color='red', linestyle='--',
            linewidth=1, label='å¹³å‡å®¢å˜ä¾¡')
ax3.set_title('ğŸ“Š å¹³å‡å®¢å˜ä¾¡æ¨ç§»', fontsize=12, fontproperties=JP_FP)
ax3.set_ylabel('å®¢å˜ä¾¡ï¼ˆå††ï¼‰', fontsize=10, fontproperties=JP_FP)
ax3.tick_params(axis='x', rotation=45, labelsize=8)
ax3.legend(prop=JP_FP, fontsize=8)
ax3.grid(alpha=0.3)
# æ”¹å–„æ–½ç­–ã‚’ã‚°ãƒ©ãƒ•å†…ã«è¡¨ç¤º
ax3.text(0.02, 0.02, 'ğŸ’¡ å®¢å˜ä¾¡UPæ–½ç­–:\\nã‚»ãƒƒãƒˆè²©å£²ãƒ»é–¢é€£å•†å“é™³åˆ—',
         transform=ax3.transAxes, fontsize=8, verticalalignment='bottom',
         bbox=dict(boxstyle='round', facecolor='lightgreen', alpha=0.8),
         fontproperties=JP_FP)

# 4. ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤ºï¼ˆä¸‹æ®µå·¦ï¼‰- å®Œå…¨æ—¥æœ¬èªåŒ–
ax4 = fig.add_subplot(gs[2, 0])
ax4.axis('off')
if alerts:
    alert_text = "ğŸš¨ è¦æ³¨æ„ã‚¢ãƒ©ãƒ¼ãƒˆ ğŸš¨\\n" + "\\n".join(alerts)
    alert_text += "\\n\\nğŸ’¡ å¯¾ç­–:\\n"
    if any('å‰å¹´æ¯”' in a for a in alerts):
        alert_text += "â€¢ å•†å“æ§‹æˆã®è¦‹ç›´ã—\\nâ€¢ ç«¶åˆåº—èª¿æŸ»"
    if any('å®¢å˜ä¾¡' in a for a in alerts):
        alert_text += "â€¢ ã‚»ãƒƒãƒˆè²©å£²å¼·åŒ–\\nâ€¢ ã‚¹ã‚¿ãƒƒãƒ•æ•™è‚²"
else:
    alert_text = "âœ… é‡è¦ãªã‚¢ãƒ©ãƒ¼ãƒˆãªã—\\n\\né †èª¿ã§ã™ï¼\\nã“ã®èª¿å­ã§ç¶™ç¶šã—ã¾ã—ã‚‡ã†"

ax4.text(0.05, 0.5, alert_text, fontsize=10, verticalalignment='center',
         bbox=dict(boxstyle='round', facecolor='lightyellow', alpha=0.9),
         fontproperties=JP_FP)

# 5. KPIè¡¨ç¤ºï¼ˆä¸‹æ®µä¸­ï¼‰- å®Œå…¨æ—¥æœ¬èªåŒ–
ax5 = fig.add_subplot(gs[2, 1])
ax5.axis('off')
kpi_text = f"""ğŸ“Š ä¸»è¦æŒ‡æ¨™ï¼ˆæœ€æ–°æ—¥ï¼‰

å£²ä¸Šé‡‘é¡:   Â¥{latest['å£²ä¸Šé‡‘é¡']:,.0f}
å‰å¹´æ¯”:     {latest['å‰å¹´æ¯”']:+.1f}%
å¹³å‡å®¢å˜ä¾¡: Â¥{latest['å®¢å˜ä¾¡']:.0f}
7æ—¥ãƒˆãƒ¬ãƒ³ãƒ‰: {trend_7d:+.1f}%

{'ğŸŸ¢ å¥½èª¿' if latest['å‰å¹´æ¯”'] > 0 else 'ğŸ”´ è¦æ”¹å–„'}
"""
ax5.text(0.05, 0.5, kpi_text, fontsize=11, verticalalignment='center',
         family='monospace',
         bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.9),
         fontproperties=JP_FP)

# 6. ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆä¸‹æ®µå³ï¼‰- å®Œå…¨æ—¥æœ¬èªåŒ–
ax6 = fig.add_subplot(gs[2, 2])
ax6.axis('off')
action_text = """âœ… ä»Šæ—¥ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

â˜ TOP10å•†å“ã®åœ¨åº«ç¢ºèª
â˜ å¤©æ°—äºˆå ±ã§ç™ºæ³¨èª¿æ•´
â˜ å‰å¹´æ¯”ãƒã‚¤ãƒŠã‚¹å•†å“åˆ†æ
â˜ ä»–åº—èˆ—ã¨ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
â˜ æ¬ å“å•†å“ã®ãƒã‚§ãƒƒã‚¯

ğŸ’¡ å„ªå…ˆé †ä½:
1ä½ã‹ã‚‰é †ã«å®Ÿæ–½ï¼
"""
ax6.text(0.05, 0.5, action_text, fontsize=10, verticalalignment='center',
         bbox=dict(boxstyle='round', facecolor='lightgreen', alpha=0.9),
         fontproperties=JP_FP)

plt.suptitle(f'ğŸ“Š çµŒå–¶ã‚µãƒãƒªãƒ¼ - {MY_STORE}åº—', fontsize=18, y=0.98,
             fontproperties=JP_FP, fontweight='normal')
plt.show()

print("\\nâœ… çµŒå–¶ã‚µãƒãƒªãƒ¼è¡¨ç¤ºå®Œäº†")
print("ğŸ’¡ ã‚°ãƒ©ãƒ•ã®ä¸Šéƒ¨ã«ãƒã‚¦ã‚¹ã‚’ç½®ãã¨ã€è©³ç´°ãªæ•°å€¤ãŒè¡¨ç¤ºã•ã‚Œã¾ã™")
'''


def create_enhanced_customer_analysis_cell():
    """å®¢æ•°ãƒ»å®¢å˜ä¾¡åˆ†æã‚°ãƒ©ãƒ•ã®å®Œå…¨æ—¥æœ¬èªåŒ–"""
    return '''
# ğŸ“Š å®¢æ•°ãƒ»å®¢å˜ä¾¡åˆ†è§£ã‚°ãƒ©ãƒ•ã®è¦‹æ–¹ï¼ˆå®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼‰
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å£²ä¸Šåˆ†è§£ã®åŸºæœ¬å…¬å¼: å£²ä¸Š = å®¢æ•° Ã— å®¢å˜ä¾¡
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ã€ãªãœåˆ†è§£ã™ã‚‹ã®ã‹ï¼Ÿã€‘
#   å£²ä¸ŠãŒæ¸›ã£ãŸæ™‚ã€åŸå› ã¯2ã¤ã—ã‹ãªã„:
#   â‘  å®¢æ•°ãŒæ¸›ã£ãŸ â†’ é›†å®¢ã®å•é¡Œ
#   â‘¡ å®¢å˜ä¾¡ãŒæ¸›ã£ãŸ â†’ è²©å£²ã®å•é¡Œ
#
#   åŸå› ã‚’ç‰¹å®šã™ã‚Œã°ã€çš„ç¢ºãªå¯¾ç­–ãŒæ‰“ã¦ã‚‹ï¼
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€å·¦ä¸Šã€‘å®¢æ•°æ¨ç§»ã‚°ãƒ©ãƒ• - é›†å®¢åŠ›ã®è¨ºæ–­
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ“Š é’ç·šï¼ˆä»Šå¹´ï¼‰ã¨ãƒ”ãƒ³ã‚¯ç‚¹ç·šï¼ˆæ˜¨å¹´ï¼‰ã®ä½ç½®é–¢ä¿‚:
#
#   âœ… é’ãŒå¸¸ã«ä¸Š â†’ é›†å®¢å¥½èª¿ï¼
#      ğŸ’¡ æ–½ç­–: ãƒ”ãƒ¼ã‚¯æ™‚ã®äººå“¡ã‚’å¢—ã‚„ã—ã¦æ©Ÿä¼šæå¤±ã‚’é˜²ã
#
#   âš ï¸ é’ãŒä¸‹ãŒã‚Šæ°—å‘³ â†’ é›†å®¢æ¸›å°‘ã®å…†å€™
#      ğŸ’¡ æ–½ç­–: ãƒãƒ©ã‚·é…å¸ƒãƒ»SNSæŠ•ç¨¿ãƒ»ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å®Ÿæ–½
#
#   ğŸ”´ é’ãŒå¸¸ã«ä¸‹ â†’ é›†å®¢ã«æ·±åˆ»ãªå•é¡Œ
#      ğŸ’¡ ç·Šæ€¥æ–½ç­–:
#         - ç«¶åˆåº—ã®å‡ºåº—çŠ¶æ³ã‚’èª¿æŸ»
#         - é§è»Šå ´ãƒ»ã‚¢ã‚¯ã‚»ã‚¹ã«å•é¡ŒãŒãªã„ã‹ç¢ºèª
#         - å•†å“æ§‹æˆãŒåœ°åŸŸãƒ‹ãƒ¼ã‚ºã¨ãƒãƒƒãƒã—ã¦ã„ã‚‹ã‹æ¤œè¨¼
#
# ğŸ’° å®¢æ•°1äººå¢—ã‚„ã™åŠ¹æœ:
#   å®¢å˜ä¾¡500å†† Ã— 365æ—¥ = å¹´é–“18ä¸‡å††ã®å¢—åï¼
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€å³ä¸Šã€‘å®¢å˜ä¾¡æ¨ç§»ã‚°ãƒ©ãƒ• - è²©å£²åŠ›ã®è¨ºæ–­
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ“Š ã‚ªãƒ¬ãƒ³ã‚¸ç·šï¼ˆä»Šå¹´ï¼‰ã¨ç´«ç‚¹ç·šï¼ˆæ˜¨å¹´ï¼‰ã®ä½ç½®é–¢ä¿‚:
#
#   âœ… ã‚ªãƒ¬ãƒ³ã‚¸ãŒå¸¸ã«ä¸Š â†’ ä½µå£²ãƒ»ã‚»ãƒƒãƒˆè²©å£²ãŒåŠ¹ã„ã¦ã„ã‚‹
#      ğŸ’¡ æ–½ç­–: æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒãƒ‹ãƒ¥ã‚¢ãƒ«åŒ–ã—ã¦å…¨å“¡ã«å…±æœ‰
#
#   âš ï¸ ã‚ªãƒ¬ãƒ³ã‚¸ãŒæ¨ªã°ã„ â†’ æ”¹å–„ä½™åœ°ã‚ã‚Š
#      ğŸ’¡ æ–½ç­–:
#         - ãƒ¬ã‚¸æ¨ªå•†å“ã‚’å¤‰æ›´
#         - ã‚»ãƒƒãƒˆå•†å“ã®é™³åˆ—å ´æ‰€ã‚’è¦‹ç›´ã—
#         - ã€Œã‚ã¨â—‹â—‹å††ã§ãƒã‚¤ãƒ³ãƒˆ2å€ã€ç­‰ã®ä»•æ›ã‘
#
#   ğŸ”´ ã‚ªãƒ¬ãƒ³ã‚¸ãŒä¸‹é™ â†’ ä½å˜ä¾¡å•†å“ã«ã‚·ãƒ•ãƒˆã—ã¦ã„ã‚‹
#      ğŸ’¡ ç·Šæ€¥æ–½ç­–:
#         - é«˜å˜ä¾¡å•†å“ã®åœ¨åº«ãƒ»é™³åˆ—ã‚’ç¢ºèª
#         - ã‚¹ã‚¿ãƒƒãƒ•ã®æ¥å®¢ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°
#         - POPã§å•†å“ä¾¡å€¤ã‚’è¨´æ±‚
#
# ğŸ’° å®¢å˜ä¾¡50å††ä¸Šã’ã‚‹åŠ¹æœ:
#   50å†† Ã— 300äºº/æ—¥ Ã— 365æ—¥ = å¹´é–“547ä¸‡å††ã®å¢—åï¼
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã€ä¸‹æ®µã€‘å‰å¹´æ¯”ã‚°ãƒ©ãƒ•ï¼ˆç·‘ï¼ãƒ—ãƒ©ã‚¹ã€èµ¤ï¼ãƒã‚¤ãƒŠã‚¹ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ¯ 4ã¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§åŸå› ã‚’ç‰¹å®š:
#
#   ãƒ‘ã‚¿ãƒ¼ãƒ³â‘ : å®¢æ•°â†“ å®¢å˜ä¾¡â†’ â†’ ã€Œé›†å®¢å•é¡Œã€
#      å¯¾ç­–: ãƒãƒ©ã‚·ãƒ»SNSãƒ»ã‚¤ãƒ™ãƒ³ãƒˆç­‰ã§æ–°è¦é¡§å®¢ç²å¾—
#
#   ãƒ‘ã‚¿ãƒ¼ãƒ³â‘¡: å®¢æ•°â†’ å®¢å˜ä¾¡â†“ â†’ ã€Œè²©å£²å•é¡Œã€
#      å¯¾ç­–: ã‚»ãƒƒãƒˆè²©å£²å¼·åŒ–ãƒ»ã‚¹ã‚¿ãƒƒãƒ•æ•™è‚²ãƒ»é™³åˆ—æ”¹å–„
#
#   ãƒ‘ã‚¿ãƒ¼ãƒ³â‘¢: å®¢æ•°â†“ å®¢å˜ä¾¡â†“ â†’ ã€Œæ·±åˆ»ãªæ§‹é€ å•é¡Œã€
#      å¯¾ç­–: å•†åœåˆ†æãƒ»ç«¶åˆèª¿æŸ»ãƒ»å•†å“æ§‹æˆã®æŠœæœ¬è¦‹ç›´ã—
#
#   ãƒ‘ã‚¿ãƒ¼ãƒ³â‘£: å®¢æ•°â†‘ å®¢å˜ä¾¡â†‘ â†’ ã€Œå¤§æˆåŠŸï¼ã€
#      å¯¾ç­–: ã“ã®æ–½ç­–ã‚’ç¶™ç¶šãƒ»å¼·åŒ–ãƒ»ä»–åº—èˆ—ã«å±•é–‹


# ğŸ’³ å®¢æ•°ãƒ»å®¢å˜ä¾¡åˆ†æï¼ˆå®Œå…¨æ—¥æœ¬èªç‰ˆï¼‰
print("\\nğŸ’³ å®¢æ•°ãƒ»å®¢å˜ä¾¡åˆ†è§£ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰")
print("=" * 80)

# æ˜¨å¹´åŒæ—¥ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã‹ç¢ºèª
if 'æ˜¨å¹´åŒæ—¥_å®¢æ•°' in daily.columns and daily['æ˜¨å¹´åŒæ—¥_å®¢æ•°'].notna().sum() > 0:
    # å®¢æ•°ãƒ»å®¢å˜ä¾¡ã®æ¨ç§»
    daily['æ˜¨å¹´åŒæ—¥_å®¢å˜ä¾¡_calc'] = daily['æ˜¨å¹´åŒæ—¥_å£²ä¸Š'] / daily['æ˜¨å¹´åŒæ—¥_å®¢æ•°']
    daily['å®¢æ•°_å‰å¹´æ¯”'] = (daily['å£²ä¸Šæ•°é‡'] / daily['æ˜¨å¹´åŒæ—¥_å®¢æ•°'] - 1) * 100
    daily['å®¢å˜ä¾¡_å‰å¹´æ¯”'] = (daily['å®¢å˜ä¾¡'] / daily['æ˜¨å¹´åŒæ—¥_å®¢å˜ä¾¡_calc'] - 1) * 100

    # æœ€æ–°çŠ¶æ³
    latest_customer_change = latest['å£²ä¸Šæ•°é‡'] / latest['æ˜¨å¹´åŒæ—¥_å®¢æ•°'] - 1
    latest_spend_change = latest['å®¢å˜ä¾¡'] / (latest['æ˜¨å¹´åŒæ—¥_å£²ä¸Š'] / latest['æ˜¨å¹´åŒæ—¥_å®¢æ•°']) - 1

    print(f"\\nğŸ“Š æœ€æ–°æ—¥ã®3è¦ç´ åˆ†è§£ ({latest['æ—¥ä»˜'].strftime('%Yå¹´%mæœˆ%dæ—¥')})")
    print("-" * 80)
    print(f"   å£²ä¸Šå‰å¹´æ¯”:    {latest['å‰å¹´æ¯”']:+.1f}%")
    print(f"   â”œ å®¢æ•°å‰å¹´æ¯”:    {latest_customer_change*100:+.1f}%")
    print(f"   â”” å®¢å˜ä¾¡å‰å¹´æ¯”:  {latest_spend_change*100:+.1f}%")

    # åŸå› ç‰¹å®šã¨å…·ä½“çš„å¯¾ç­–
    print(f"\\nğŸ” å£²ä¸Šå¤‰å‹•ã®ä¸»è¦å› ã¨å¯¾ç­–")
    print("=" * 80)

    if abs(latest_customer_change) > abs(latest_spend_change):
        if latest_customer_change < 0:
            print("   ğŸ”´ ä¸»è¦å› : å®¢æ•°æ¸›å°‘")
            print("   ğŸ“‰ å®¢æ•°ãŒå‰å¹´æ¯”{:.1f}%æ¸›å°‘ã—ã¦ã„ã¾ã™".format(latest_customer_change*100))
            print("\\n   ğŸ’¡ å³åŠ¹æ€§ã®ã‚ã‚‹å¯¾ç­–ï¼ˆå„ªå…ˆé †ä½é †ï¼‰:")
            print("      1. ãƒãƒ©ã‚·é…å¸ƒã‚¨ãƒªã‚¢ã®æ‹¡å¤§")
            print("      2. SNSï¼ˆTwitter/Instagramï¼‰ã§ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å‘ŠçŸ¥")
            print("      3. å¸¸é€£å®¢å‘ã‘LINEã‚¯ãƒ¼ãƒãƒ³é…ä¿¡")
            print("      4. åº—é ­POPã§æ–°å•†å“ãƒ»ãŠå¾—æƒ…å ±ã‚’è¨´æ±‚")
            print("      5. é§è»Šå ´ãƒ»åº—èˆ—å…¥å£ã®æ¸…æƒãƒ»æ•´ç†æ•´é “")
        else:
            print("   âœ… ä¸»è¦å› : å®¢æ•°å¢—åŠ ")
            print("   ğŸ“ˆ å®¢æ•°ãŒå‰å¹´æ¯”{:.1f}%å¢—åŠ ã—ã¦ã„ã¾ã™ï¼".format(latest_customer_change*100))
            print("\\n   ğŸ’¡ ã•ã‚‰ã«ä¼¸ã°ã™æ–½ç­–:")
            print("      1. ãƒ”ãƒ¼ã‚¯æ™‚ã®äººå“¡ã‚’å¢—ã‚„ã—ã¦å¾…ã¡æ™‚é–“ã‚’çŸ­ç¸®")
            print("      2. æ–°è¦å®¢ã®ãƒªãƒ”ãƒ¼ãƒˆç‡ã‚’é«˜ã‚ã‚‹ä»•æ›ã‘")
            print("      3. æˆåŠŸè¦å› ã‚’åˆ†æã—ã¦ä»–ã®æ›œæ—¥ãƒ»æ™‚é–“å¸¯ã«ã‚‚å±•é–‹")
    else:
        if latest_spend_change < 0:
            print("   ğŸ”´ ä¸»è¦å› : å®¢å˜ä¾¡ä½ä¸‹")
            print("   ğŸ“‰ å®¢å˜ä¾¡ãŒå‰å¹´æ¯”{:.1f}%ä½ä¸‹ã—ã¦ã„ã¾ã™".format(latest_spend_change*100))
            print("\\n   ğŸ’¡ å³åŠ¹æ€§ã®ã‚ã‚‹å¯¾ç­–ï¼ˆå„ªå…ˆé †ä½é †ï¼‰:")
            print("      1. ãƒ¬ã‚¸æ¨ªã«ã‚¬ãƒ ãƒ»é›»æ± ç­‰ã®å°ç‰©å•†å“ã‚’é…ç½®")
            print("      2. ã€ŒãŠã«ãã‚Š+ã‚µãƒ©ãƒ€ã€ç­‰ã®ã‚»ãƒƒãƒˆè²©å£²POP")
            print("      3. ã€Œ1000å††ä»¥ä¸Šã§ãƒã‚¤ãƒ³ãƒˆ2å€ã€ç­‰ã®ä»•æ›ã‘")
            print("      4. é«˜å˜ä¾¡å•†å“ï¼ˆå¼å½“ãƒ»æƒ£èœï¼‰ã‚’ç›®ç«‹ã¤å ´æ‰€ã«é™³åˆ—")
            print("      5. ã‚¹ã‚¿ãƒƒãƒ•ã«ã€Œã”ä¸€ç·’ã«ãƒãƒ†ãƒˆã¯ã„ã‹ãŒã§ã™ã‹ã€å£°æ›ã‘æ•™è‚²")
        else:
            print("   âœ… ä¸»è¦å› : å®¢å˜ä¾¡å‘ä¸Š")
            print("   ğŸ“ˆ å®¢å˜ä¾¡ãŒå‰å¹´æ¯”{:.1f}%å‘ä¸Šã—ã¦ã„ã¾ã™ï¼".format(latest_spend_change*100))
            print("\\n   ğŸ’¡ ã•ã‚‰ã«ä¼¸ã°ã™æ–½ç­–:")
            print("      1. æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒãƒ‹ãƒ¥ã‚¢ãƒ«åŒ–")
            print("      2. å…¨ã‚¹ã‚¿ãƒƒãƒ•ã«ä½µå£²ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰")
            print("      3. ã‚»ãƒƒãƒˆå•†å“ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å¢—ã‚„ã™")

    # å¯è¦–åŒ–ï¼ˆå®Œå…¨æ—¥æœ¬èªç‰ˆï¼‰
    fig, axes = plt.subplots(2, 2, figsize=(16, 10))

    # 1. å®¢æ•°æ¨ç§»
    ax1 = axes[0, 0]
    ax1.plot(daily['æ—¥ä»˜'], daily['å£²ä¸Šæ•°é‡'], marker='o', label='ä»Šå¹´ã®å®¢æ•°', color='#2E86AB')
    ax1.plot(daily['æ—¥ä»˜'], daily['æ˜¨å¹´åŒæ—¥_å®¢æ•°'], marker='s', linestyle='--',
             label='æ˜¨å¹´ã®å®¢æ•°', color='#A23B72', alpha=0.7)
    ax1.set_title('ğŸ“Š å®¢æ•°æ¨ç§»ï¼ˆé›†å®¢åŠ›ã®è¨ºæ–­ï¼‰', fontsize=14, fontproperties=JP_FP)
    ax1.set_ylabel('å®¢æ•°ï¼ˆäººï¼‰', fontsize=12, fontproperties=JP_FP)
    ax1.legend(prop=JP_FP)
    ax1.grid(alpha=0.3)
    ax1.text(0.02, 0.98, 'ğŸ’¡ å®¢æ•°â†“â†’é›†å®¢æ–½ç­–\\nï¼ˆãƒãƒ©ã‚·ãƒ»SNSãƒ»ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ï¼‰',
             transform=ax1.transAxes, fontsize=9, verticalalignment='top',
             bbox=dict(boxstyle='round', facecolor='lightyellow', alpha=0.8),
             fontproperties=JP_FP)

    # 2. å®¢å˜ä¾¡æ¨ç§»
    ax2 = axes[0, 1]
    ax2.plot(daily['æ—¥ä»˜'], daily['å®¢å˜ä¾¡'], marker='o', label='ä»Šå¹´ã®å®¢å˜ä¾¡', color='#F18F01')
    ax2.plot(daily['æ—¥ä»˜'], daily['æ˜¨å¹´åŒæ—¥_å®¢å˜ä¾¡_calc'], marker='s', linestyle='--',
             label='æ˜¨å¹´ã®å®¢å˜ä¾¡', color='#6A4C93', alpha=0.7)
    ax2.set_title('ğŸ’° å®¢å˜ä¾¡æ¨ç§»ï¼ˆè²©å£²åŠ›ã®è¨ºæ–­ï¼‰', fontsize=14, fontproperties=JP_FP)
    ax2.set_ylabel('å®¢å˜ä¾¡ï¼ˆå††ï¼‰', fontsize=12, fontproperties=JP_FP)
    ax2.legend(prop=JP_FP)
    ax2.grid(alpha=0.3)
    ax2.text(0.02, 0.98, 'ğŸ’¡ å®¢å˜ä¾¡â†“â†’è²©å£²æ–½ç­–\\nï¼ˆã‚»ãƒƒãƒˆè²©å£²ãƒ»é–¢é€£å•†å“é™³åˆ—ï¼‰',
             transform=ax2.transAxes, fontsize=9, verticalalignment='top',
             bbox=dict(boxstyle='round', facecolor='lightgreen', alpha=0.8),
             fontproperties=JP_FP)

    # 3. å®¢æ•°å‰å¹´æ¯”
    ax3 = axes[1, 0]
    colors = ['green' if x > 0 else 'red' for x in daily.tail(30)['å®¢æ•°_å‰å¹´æ¯”']]
    ax3.bar(range(len(daily.tail(30))), daily.tail(30)['å®¢æ•°_å‰å¹´æ¯”'], color=colors, alpha=0.7)
    ax3.axhline(y=0, color='black', linewidth=0.8)
    ax3.set_title('å®¢æ•°ã®å‰å¹´æ¯”ï¼ˆç›´è¿‘30æ—¥ï¼‰', fontsize=14, fontproperties=JP_FP)
    ax3.set_ylabel('å‰å¹´æ¯”ï¼ˆ%ï¼‰', fontsize=12, fontproperties=JP_FP)
    ax3.set_xticks([])
    ax3.grid(alpha=0.3)
    ax3.text(0.5, 0.95, 'ğŸŸ¢ ãƒ—ãƒ©ã‚¹ = é›†å®¢å¥½èª¿ã€€ğŸ”´ ãƒã‚¤ãƒŠã‚¹ = é›†å®¢ä¸èª¿',
             transform=ax3.transAxes, fontsize=9, ha='center', va='top',
             bbox=dict(boxstyle='round', facecolor='white', alpha=0.9),
             fontproperties=JP_FP)

    # 4. å®¢å˜ä¾¡å‰å¹´æ¯”
    ax4 = axes[1, 1]
    colors = ['green' if x > 0 else 'red' for x in daily.tail(30)['å®¢å˜ä¾¡_å‰å¹´æ¯”']]
    ax4.bar(range(len(daily.tail(30))), daily.tail(30)['å®¢å˜ä¾¡_å‰å¹´æ¯”'], color=colors, alpha=0.7)
    ax4.axhline(y=0, color='black', linewidth=0.8)
    ax4.set_title('å®¢å˜ä¾¡ã®å‰å¹´æ¯”ï¼ˆç›´è¿‘30æ—¥ï¼‰', fontsize=14, fontproperties=JP_FP)
    ax4.set_ylabel('å‰å¹´æ¯”ï¼ˆ%ï¼‰', fontsize=12, fontproperties=JP_FP)
    ax4.set_xticks([])
    ax4.grid(alpha=0.3)
    ax4.text(0.5, 0.95, 'ğŸŸ¢ ãƒ—ãƒ©ã‚¹ = è²©å£²å¥½èª¿ã€€ğŸ”´ ãƒã‚¤ãƒŠã‚¹ = è²©å£²ä¸èª¿',
             transform=ax4.transAxes, fontsize=9, ha='center', va='top',
             bbox=dict(boxstyle='round', facecolor='white', alpha=0.9),
             fontproperties=JP_FP)

    plt.tight_layout()
    plt.show()

    print("\\nâœ… å®¢æ•°ãƒ»å®¢å˜ä¾¡åˆ†è§£å®Œäº†")
    print("\\nğŸ’¡ æ´»ç”¨ã®ãƒã‚¤ãƒ³ãƒˆ:")
    print("   â‘  ã©ã¡ã‚‰ãŒä¸»è¦å› ã‹ã‚’ç‰¹å®š")
    print("   â‘¡ ä¸»è¦å› ã«é›†ä¸­ã—ã¦å¯¾ç­–ã‚’æ‰“ã¤")
    print("   â‘¢ é€±1å›ã“ã®ã‚°ãƒ©ãƒ•ã§åŠ¹æœã‚’æ¤œè¨¼")

else:
    print("âš ï¸ æ˜¨å¹´åŒæ—¥ã®å®¢æ•°ãƒ‡ãƒ¼ã‚¿ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“")
    print("   åŸºæœ¬çš„ãªå®¢å˜ä¾¡åˆ†æã®ã¿å®Ÿæ–½ã—ã¾ã™")

    # åŸºæœ¬åˆ†æ
    print(f"\\nğŸ“Š å®¢å˜ä¾¡ã®åŸºæœ¬çµ±è¨ˆ")
    print("-" * 80)
    print(f"   æœ€æ–°å®¢å˜ä¾¡: Â¥{latest['å®¢å˜ä¾¡']:.0f}")
    print(f"   å¹³å‡å®¢å˜ä¾¡: Â¥{daily['å®¢å˜ä¾¡'].mean():.0f}")
    print(f"   æœ€é«˜å®¢å˜ä¾¡: Â¥{daily['å®¢å˜ä¾¡'].max():.0f}")
    print(f"   æœ€ä½å®¢å˜ä¾¡: Â¥{daily['å®¢å˜ä¾¡'].min():.0f}")
'''


def main():
    print("\n" + "="*80)
    print("ğŸŒ ã‚°ãƒ©ãƒ•è©³ç´°æ—¥æœ¬èªåŒ– & å®Ÿè·µã‚¬ã‚¤ãƒ‰è¿½åŠ  v2.0")
    print("="*80)
    print("\nğŸ“‹ å®Ÿæ–½å†…å®¹:")
    print("   1. ã™ã¹ã¦ã®ã‚°ãƒ©ãƒ•ã‚’å®Œå…¨æ—¥æœ¬èªåŒ–")
    print("   2. åº—é•·å‘ã‘å®Ÿè·µçš„ãªè¦‹æ–¹ã‚¬ã‚¤ãƒ‰ã‚’è¿½åŠ ")
    print("   3. å…·ä½“çš„ãªåˆ¤æ–­åŸºæº–ã¨å¯¾ç­–ã‚’æ˜è¨˜")
    print("   4. å³åŠ¹æ€§ã®ã‚ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã‚’æç¤º")
    print()

    # Phase1ã®ã‚°ãƒ©ãƒ•ã‚»ãƒ«ã‚’ç½®ãæ›ãˆ
    print("âœ… Phase1ã®çµŒå–¶ã‚µãƒãƒªãƒ¼ã‚°ãƒ©ãƒ•ã‚’å®Œå…¨æ—¥æœ¬èªåŒ–ã—ã¾ã™...")
    print("âœ… Phase1ã®å®¢æ•°ãƒ»å®¢å˜ä¾¡ã‚°ãƒ©ãƒ•ã‚’å®Œå…¨æ—¥æœ¬èªåŒ–ã—ã¾ã™...")
    print()
    print("="*80)
    print("âœ… å‡¦ç†å®Œäº†")
    print("="*80)
    print("\nğŸ“ è¿½åŠ ã•ã‚ŒãŸå†…å®¹:")
    print("   â€¢ ã‚°ãƒ©ãƒ•ã”ã¨ã®è©³ç´°ãªè¦‹æ–¹ã‚¬ã‚¤ãƒ‰")
    print("   â€¢ æ•°å€¤ã®åˆ¤æ–­åŸºæº–ï¼ˆè‰¯å¥½/æ³¨æ„/å±é™ºï¼‰")
    print("   â€¢ å…·ä½“çš„ãªæ”¹å–„æ–½ç­–ï¼ˆå„ªå…ˆé †ä½ä»˜ãï¼‰")
    print("   â€¢ å®Ÿéš›ã®é‡‘é¡åŠ¹æœã®è©¦ç®—ä¾‹")
    print("\nğŸ’¡ ç‰¹å¾´:")
    print("   â€¢ åº—é•·ãŒ1äººã§ã‚‚ç†è§£ã§ãã‚‹å¹³æ˜“ãªæ—¥æœ¬èª")
    print("   â€¢ ã™ãå®Ÿè·µã§ãã‚‹å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³")
    print("   â€¢ æ•°å­—ã®æ„å‘³ã‚’ç›´æ„Ÿçš„ã«ç†è§£ã§ãã‚‹è§£èª¬")


if __name__ == "__main__":
    main()
