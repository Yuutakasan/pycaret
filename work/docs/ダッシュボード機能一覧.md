# 📊 店舗別包括ダッシュボード v3.0 - 機能一覧

## 🎯 機能概要

### コア機能

| # | 機能 | 説明 | 対応状況 |
|---|------|------|---------|
| 1 | 店舗選択 | ウィジェットで3店舗を動的に切替 | ✅ 実装済 |
| 2 | 時間軸切替 | 月次・週次・日次で分析粒度を変更 | ✅ 実装済 |
| 3 | ドリルダウン | グラフをホバー/クリックで詳細表示 | ✅ 実装済 |
| 4 | フィルタ | ABCランク・商品名で絞込 | ✅ 実装済 |
| 5 | 表示件数調整 | 10/20/50/100件を選択 | ✅ 実装済 |
| 6 | 検索 | 商品名で部分一致検索 | ✅ 実装済 |
| 7 | 自動アラート | 対応が必要な項目を自動検出 | ✅ 実装済 |

---

## 📊 分析機能詳細

### 1. KPIサマリー

**目的**: 店舗の全体像を1画面で把握

**表示項目**:
- 💰 総売上高
- 📊 日商平均
- 📦 総販売数
- 💵 平均単価
- 🏪 商品数

**インタラクティブ機能**:
- なし（固定表示）

**活用シーン**:
- 毎朝の業務開始時に前日の状況確認
- 週次ミーティングでの数値報告
- 月次レポート作成

---

### 2. 時系列分析（売上推移）

**目的**: 売上トレンドの把握・異常値の発見

**表示内容**:
- 📈 売上推移グラフ（折れ線）
- 📊 統計情報（平均・最大・最小・標準偏差）

**インタラクティブ機能**:
- ✅ **時間軸切替**: 日次 ⇔ 週次 ⇔ 月次
- ✅ **ホバー**: 各ポイントの詳細データ表示
- ✅ **ズーム**: ドラッグで特定期間を拡大
- ✅ **パン**: ズーム後の移動
- ✅ **リセット**: ダブルクリックで元に戻る

**グラフ要素**:
```
X軸: 日付 / 年週 / 年月
Y軸: 売上金額（円）
線の色: 青（売上金額）
マーカー: 8px円形
```

**活用シーン**:
- **日次**: 曜日パターンの確認・日々の変動チェック
- **週次**: 月内トレンドの把握・週次目標管理
- **月次**: 前年比較・季節変動の分析

**統計指標の見方**:
- **平均**: 通常時の売上水準
- **最大**: ピーク時の売上（イベント効果等）
- **最小**: 最低ライン（要注意水準）
- **標準偏差**: 変動の大きさ（小さいほど安定）

---

### 3. 商品ABC分析

**目的**: 重要商品の特定・死に筋商品の発見

#### 3-1. ABC集計表

**表示内容**:
| ABCランク | 商品数 | 売上金額 | 商品数_% | 売上構成比_% |
|----------|--------|---------|---------|-------------|
| A | XX商品 | ¥XXX,XXX | XX% | 80% |
| B | XX商品 | ¥XXX,XXX | XX% | 15% |
| C | XX商品 | ¥XXX,XXX | XX% | 5% |

**ABC分類基準**:
- **A商品**: 累積構成比 0-80%（最重要）
- **B商品**: 累積構成比 80-95%（準重要）
- **C商品**: 累積構成比 95-100%（低貢献）

#### 3-2. 商品一覧テーブル

**表示項目**:
- 商品名
- 売上金額
- 売上数量
- ABCランク
- 平均単価
- 1日平均売上

**インタラクティブ機能**:
- ✅ **表示件数切替**: 10 / 20 / 50 / 100件
- ✅ **ABCランクフィルタ**: 全て / A / B / C
- ✅ **検索**: 商品名で部分一致
- ✅ **リアルタイム更新**: フィルタ変更時に即座に反映

**フィルタ組み合わせ例**:
```
例1: Aランク商品のみ表示
→ ABCランク: A
→ 検索: (空白)
→ 表示件数: 50件

例2: 「コーヒー」カテゴリのC商品
→ ABCランク: C
→ 検索: コーヒー
→ 表示件数: 20件
```

#### 3-3. パレート図

**目的**: 80/20の法則を可視化

**グラフ構成**:
- **左Y軸**: 売上金額（棒グラフ）
- **右Y軸**: 累積構成比（折れ線）
- **X軸**: 商品順位（TOP 100）

**インタラクティブ機能**:
- ✅ **ホバー**: 商品詳細情報表示
  ```
  商品名: 〇〇〇
  売上: ¥123,456
  数量: 456個
  ランク: A
  ```
- ✅ **基準線**:
  - 80%ライン（オレンジ破線）: A/B境界
  - 95%ライン（緑破線）: B/C境界

**グラフの見方**:
```
┌─────────────────────────────────┐
│ 左側の急上昇部分 → A商品（最重要）     │
│ 80%ライン → A/B境界              │
│ 右側の平坦部分 → C商品（削減候補）    │
└─────────────────────────────────┘
```

---

### 4. 曜日別パターン分析

**目的**: 曜日別の売上傾向を把握・発注量調整

**表示内容**:
- 📅 曜日別集計表
- 📊 曜日別平均売上グラフ（棒グラフ）

**集計表の項目**:
| 曜日 | 売上合計 | 売上平均 | データ数 | 指数 |
|------|---------|---------|---------|-----|
| 月 | ¥XXX,XXX | ¥XXX,XXX | XX日 | 95 |
| 火 | ¥XXX,XXX | ¥XXX,XXX | XX日 | 98 |
| ... | ... | ... | ... | ... |

**指数の計算方法**:
```
指数 = (各曜日の平均売上 / 平日平均売上) × 100

平日平均 = (月〜金の平均売上の合計) / 5
```

**指数の見方**:
- **指数 > 100**: 平日より売れる → 発注量を増やす
- **指数 = 100**: 平日と同じ
- **指数 < 100**: 平日より売れない → 発注量を減らす

**棒グラフの色分け**:
- 🔵 青色: 平日（月〜金）
- 🔴 赤色: 休日（土・日）

**活用例**:
```
例: 土曜日の指数が120の場合
→ 基準発注量 × 1.2 = 土曜日の発注量

基準発注量が100個なら:
100個 × 1.2 = 120個を土曜日に発注
```

---

### 5. 自動アラートシステム

**目的**: 今すぐ対応すべき項目を自動検出

#### 5-1. アラート種類

**⚠️ 死に筋商品アラート**

**検出条件**:
```
ABCランク = C
AND (
  1日平均売上 < 100円
  OR 販売日数 < 全期間の20%
)
```

**表示内容**:
- 該当商品数
- TOP 10商品リスト
  - 商品名
  - 売上金額
  - 販売日数

**推奨アクション**:
1. 在庫を確認
2. 発注を停止
3. 現在の在庫を売り切る
4. 廃番を検討
5. 売場スペースをA/B商品に再配分

---

**🚨 機会ロス商品アラート**

**検出条件**:
```
ABCランク = A
AND 販売日数 < 全期間の80%
```

**表示内容**:
- 該当商品数
- TOP 10商品リスト
  - 商品名
  - 売上金額
  - 販売日数

**推奨アクション**:
1. 欠品していないか確認
2. 発注量を増やす（安全在庫を確保）
3. 売場の目立つ位置に配置
4. 仕入れ先に在庫状況を確認

---

## 🎮 コントロールパネル仕様

### ウィジェット一覧

#### 1. 店舗選択ドロップダウン
```
📍 店舗: [58738:ＴＸ秋葉原駅 ▼]
```

**仕様**:
- **種類**: Dropdown
- **選択肢**:
  - 58738:ＴＸ秋葉原駅
  - 77576:ＴＸつくば駅
  - 69795:ＴＸ六町駅／Ｓ
- **デフォルト値**: 最初の店舗
- **幅**: 400px

#### 2. 時間軸選択ドロップダウン
```
📅 時間軸: [日次 ▼]
```

**仕様**:
- **種類**: Dropdown
- **選択肢**: 日次 / 週次 / 月次
- **デフォルト値**: 日次
- **幅**: 200px

#### 3. 表示件数ドロップダウン
```
🔢 表示件数: [20 ▼]
```

**仕様**:
- **種類**: Dropdown
- **選択肢**: 10 / 20 / 50 / 100
- **デフォルト値**: 20
- **幅**: 200px

#### 4. ABCランクフィルタ
```
📊 ABCランク: [全て ▼]
```

**仕様**:
- **種類**: Dropdown
- **選択肢**: 全て / A / B / C
- **デフォルト値**: 全て
- **幅**: 200px

#### 5. 検索ボックス
```
🔍 検索: [商品名で検索_________]
```

**仕様**:
- **種類**: Text
- **プレースホルダー**: 商品名で検索
- **デフォルト値**: (空白)
- **幅**: 400px
- **検索方式**: 部分一致・大文字小文字区別なし

#### 6. 更新ボタン
```
[🔄 データ更新]
```

**仕様**:
- **種類**: Button
- **スタイル**: primary（青色）
- **幅**: 150px
- **動作**: クリック時に分析を実行

---

## 📈 データフロー

### 1. データ読み込み
```
CSV読込
↓
日付パース
↓
年月・年週・曜日追加
↓
全店舗データ (df_all) 作成
```

### 2. 店舗選択時
```
店舗選択
↓
フィルタリング (df_all → df)
↓
分析実行
```

### 3. 分析処理
```
KPIサマリー計算
↓
時系列集計（日次/週次/月次）
↓
商品ABC分析
↓
曜日パターン分析
↓
自動アラート生成
↓
結果表示
```

---

## 🎨 ビジュアル仕様

### カラースキーム

| 要素 | 色 | 用途 |
|------|---|------|
| 主線 | 青 (#4682B4) | 売上推移線 |
| 棒グラフ | 鋼青 (steelblue) | 商品売上 |
| 累積線 | 赤 (red) | パレート累積線 |
| 平日 | 青 | 曜日グラフ |
| 休日 | 赤 | 曜日グラフ |
| A/B境界 | オレンジ | 80%ライン |
| B/C境界 | 緑 | 95%ライン |

### グラフサイズ

| グラフ種類 | 高さ | 幅 |
|-----------|------|-----|
| 時系列グラフ | 500px | 100% |
| パレート図 | 600px | 100% |
| 曜日グラフ | 400px | 100% |

---

## 🔧 技術仕様

### 必要ライブラリ

```python
# データ処理
pandas >= 1.3.0
numpy >= 1.21.0

# 可視化
matplotlib >= 3.4.0
seaborn >= 0.11.0
plotly >= 5.0.0

# 統計
scipy >= 1.7.0
scikit-learn >= 0.24.0

# Jupyter
ipywidgets >= 7.6.0
```

### ファイル構成

```
/mnt/d/github/pycaret/work/
├── 店舗別包括ダッシュボード_v3_interactive.ipynb  ← メインファイル
├── output/
│   └── 06_final_enriched_20250701_20250930.csv  ← データ
└── docs/
    ├── ダッシュボード使用方法.md  ← 使い方ガイド
    └── ダッシュボード機能一覧.md  ← このファイル
```

### パフォーマンス

**データサイズ**: 83,789行 × 132列

**処理時間** (目安):
- データ読込: 2-3秒
- 店舗切替: 1-2秒
- グラフ描画: 1-2秒
- 合計: 4-7秒

**メモリ使用量**: 約200-300MB

---

## 🚀 今後の拡張予定

### Phase 2: 高度な分析

- [ ] カテゴリ別分析
- [ ] 気温・天気の影響分析
- [ ] 店舗間比較ベンチマーク
- [ ] 前年同期比較

### Phase 3: 予測機能

- [ ] PyCaret需要予測統合
- [ ] 在庫最適化シミュレーション
- [ ] 発注推奨アルゴリズム

### Phase 4: レポート機能

- [ ] PDF自動生成
- [ ] Excel出力
- [ ] メール自動送信
- [ ] スケジュール実行

---

## 📞 サポート情報

**ドキュメント**: `/mnt/d/github/pycaret/work/docs/`

**バグ報告**: GitHub Issues

**更新履歴**: `CHANGELOG.md`

---

**最終更新**: 2025-10-08
**バージョン**: 3.0
**作成者**: Claude Code with claude-flow orchestration
