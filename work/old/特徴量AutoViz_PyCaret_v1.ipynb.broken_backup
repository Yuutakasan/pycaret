{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": "# ğŸ” ç‰¹å¾´é‡åˆ†æï¼ˆAutoViz + PyCaretï¼‰v1 â€” AIå£²ä¸Šäºˆæ¸¬ãƒ„ãƒ¼ãƒ«\n\n## ğŸ“˜ ã“ã®ãƒ„ãƒ¼ãƒ«ã®ç›®çš„\n**AIãŒå£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•åˆ†æã—ã€ã€Œä½•ãŒå£²ä¸Šã«åŠ¹ãã‹ã€ã‚’æ•™ãˆã¦ãã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚**\n\n### ğŸ¯ ã§ãã‚‹ã“ã¨\n1. ã‚°ãƒ©ãƒ•ã§è¦–è¦šçš„ã«å£²ä¸Šãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¢ºèªï¼ˆAutoVizï¼‰\n2. AI ãŒé‡è¦ãªè¦å› ã‚’è‡ªå‹•ã§è¦‹ã¤ã‘ã‚‹ï¼ˆPyCaretï¼‰\n3. äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã€ç²¾åº¦ã‚’æ•°å€¤ã§ç¢ºèª\n\n---\n\n## ğŸš€ ä½¿ã„æ–¹ï¼ˆç°¡å˜3ã‚¹ãƒ†ãƒƒãƒ—ï¼‰\n1. **ã‚»ãƒ«ã‚’ä¸Šã‹ã‚‰é †ã«å®Ÿè¡Œ**ï¼ˆå„ã‚»ãƒ«ã§ Shift+Enter ã‚’æŠ¼ã™ï¼‰\n2. **ã‚°ãƒ©ãƒ•ã‚’è¦‹ã¦ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¢ºèª**\n3. **é‡è¦åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã§ã€æ³¨ç›®ã™ã¹ãè¦å› ã‚’ç‰¹å®š**\n\n---\n\n**ãã‚Œã§ã¯ã€ä»¥ä¸‹ã®ã‚»ãƒ«ã‚’é †ç•ªã«å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã€Œä½•ã‚’è¦‹ã‚‹ã‹ã€ã€Œã©ã†åˆ¤æ–­ã™ã‚‹ã‹ã€ãŒæ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚**"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": "# ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ç’°å¢ƒ\nimport warnings; warnings.filterwarnings('ignore')\nimport os, sys\nfrom pathlib import Path\nimport pandas as pd, numpy as np\n\n# æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆï¼ˆMatplotlib/Plotlyï¼‰\nimport font_setup  # IPAGothicç­‰ã‚’è‡ªå‹•è¨­å®š\n\n# AutoViz\ntry:\n    from autoviz.AutoViz_Class import AutoViz_Class\n    AV_OK = True\nexcept Exception:\n    AV_OK = False\n\n# PyCaretï¼ˆå›å¸°ï¼‰\ntry:\n    from pycaret.regression import setup, compare_models, pull, finalize_model, predict_model, plot_model\n    PYC_OK = True\nexcept Exception:\n    PYC_OK = False\n\n# ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±\nprint(f'Python: {sys.version.split()[0]}')\nprint(f'pandas: {pd.__version__}, numpy: {np.__version__}')\nprint(f'AutoViz: {AV_OK}, PyCaret.regression: {PYC_OK}')\n\n# PyCaretã®æœ€å°ã‚µãƒ³ãƒ—ãƒ«æ•°ï¼ˆ3-fold CVã«å¿…è¦ï¼‰\nMIN_SAMPLES_PYCARET = 100\n\n# ========================================\n# ğŸš€ GPUæ¤œå‡ºã¨è¨­å®š\n# ========================================\nprint('\\n' + '='*60)\nprint('ğŸ–¥ï¸ GPUæ¤œå‡º')\nprint('='*60)\n\n# GPUåˆ©ç”¨å¯èƒ½æ€§ã‚’ãƒã‚§ãƒƒã‚¯\nGPU_AVAILABLE = False\nGPU_DEVICE = 'cpu'\n\ntry:\n    import torch\n    if torch.cuda.is_available():\n        GPU_AVAILABLE = True\n        GPU_DEVICE = 'cuda'\n        print(f'âœ… NVIDIA GPUæ¤œå‡º: {torch.cuda.get_device_name(0)}')\n        print(f'   CUDA Version: {torch.version.cuda}')\n        print(f'   GPU Memory: {torch.cuda.get_device_properties(0).total_memory / 1024**3:.1f} GB')\n    else:\n        print('âš ï¸ PyTorch installed but no CUDA GPU found')\nexcept ImportError:\n    print('â„¹ï¸ PyTorch not installed (GPU detection skipped)')\n\n# LightGBM GPUå¯¾å¿œãƒã‚§ãƒƒã‚¯\ntry:\n    import lightgbm as lgb\n    if GPU_AVAILABLE:\n        print('âœ… LightGBM GPUå¯¾å¿œ: å¯èƒ½')\n    else:\n        print('â„¹ï¸  LightGBM: CPU mode')\nexcept ImportError:\n    print('â„¹ï¸ LightGBM not installed')\n\n# XGBoost GPUå¯¾å¿œãƒã‚§ãƒƒã‚¯\ntry:\n    import xgboost as xgb\n    if GPU_AVAILABLE:\n        print('âœ… XGBoost GPUå¯¾å¿œ: å¯èƒ½')\n    else:\n        print('â„¹ï¸ XGBoost: CPU mode')\nexcept ImportError:\n    print('â„¹ï¸ XGBoost not installed')\n\n# CatBoost GPUå¯¾å¿œãƒã‚§ãƒƒã‚¯\ntry:\n    import catboost\n    if GPU_AVAILABLE:\n        print('âœ… CatBoost GPUå¯¾å¿œ: å¯èƒ½')\n    else:\n        print('â„¹ï¸ CatBoost: CPU mode')\nexcept ImportError:\n    print('â„¹ï¸ CatBoost not installed')\n\n# GPUä½¿ç”¨ãƒ•ãƒ©ã‚°ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¤‰æ›´å¯èƒ½ï¼‰\nUSE_GPU = GPU_AVAILABLE  # Trueã«è¨­å®šã™ã‚‹ã¨GPUã‚’ä½¿ç”¨ï¼ˆGPUãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆã®ã¿ï¼‰\n\nif USE_GPU:\n    print(f'\\nğŸš€ GPUä½¿ç”¨: æœ‰åŠ¹ï¼ˆæ¨å®š2ï½10å€é«˜é€ŸåŒ–ï¼‰')\n    print(f'   Device: {GPU_DEVICE}')\nelse:\n    print(f'\\nâ„¹ï¸ GPUä½¿ç”¨: ç„¡åŠ¹ï¼ˆCPUãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œï¼‰')\n    if GPU_AVAILABLE:\n        print('   ğŸ’¡ ãƒ’ãƒ³ãƒˆ: ä¸Šã®ã‚»ãƒ«ã§ USE_GPU = True ã«è¨­å®šã™ã‚‹ã¨GPUä½¿ç”¨å¯èƒ½')\n\nprint('='*60)"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ========================================",
    "# ğŸ”§ GPU/CPU ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ å¤‰æ›ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£",
    "# ========================================",
    "",
    "def to_gpu(df):",
    "    \"\"\"pandasãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’GPU (cuDF) ã«å¤‰æ›ï¼ˆUSE_GPU=Trueã®å ´åˆã®ã¿ï¼‰\"\"\"",
    "    if USE_GPU and CUDF_AVAILABLE and df is not None and not df.empty:",
    "        try:",
    "            import cudf",
    "            return cudf.from_pandas(df)",
    "        except Exception as e:",
    "            print(f'âš ï¸ GPUå¤‰æ›å¤±æ•—ã€CPUãƒ¢ãƒ¼ãƒ‰ç¶™ç¶š: {e}')",
    "            return df",
    "    return df",
    "",
    "def to_cpu(df):",
    "    \"\"\"cuDFãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’pandasã«å¤‰æ›\"\"\"",
    "    if df is None:",
    "        return None",
    "    try:",
    "        import cudf",
    "        if isinstance(df, cudf.DataFrame):",
    "            return df.to_pandas()",
    "    except:",
    "        pass",
    "    return df",
    "",
    "# GPUãƒ¡ãƒ¢ãƒªä½¿ç”¨çŠ¶æ³è¡¨ç¤º",
    "def show_gpu_memory():",
    "    if GPU_AVAILABLE:",
    "        try:",
    "            import torch",
    "            allocated = torch.cuda.memory_allocated(0) / 1024**3",
    "            reserved = torch.cuda.memory_reserved(0) / 1024**3",
    "            print(f'ğŸ“Š GPU Memory: {allocated:.2f}GB allocated, {reserved:.2f}GB reserved')",
    "        except:",
    "            pass",
    "",
    "if USE_GPU and CUDF_AVAILABLE:",
    "    print('âœ… GPUé«˜é€ŸåŒ–ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£: æº–å‚™å®Œäº†')",
    "    print('   to_gpu(df) ã§GPUå‡¦ç†ã€to_cpu(df) ã§CPUæˆ»ã—')",
    "    show_gpu_memory()",
    "else:",
    "    print('â„¹ï¸ CPUå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ï¼ˆGPUãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã¯ç„¡åŠ¹ï¼‰')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "# ãƒ•ã‚©ãƒ³ãƒˆå¼·åˆ¶ãƒªã‚»ãƒƒãƒˆï¼ˆæ—¥æœ¬èªå¯¾å¿œ / AutoVizå¯¾ç­–ï¼‰\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.font_manager as fm\n",
    "import seaborn as sns\n",
    "try:\n",
    "    import japanize_matplotlib; japanize_matplotlib.japanize()\n",
    "except Exception:\n",
    "    pass\n",
    "candidates = ['IPAGothic','IPAexGothic','Noto Sans CJK JP','Noto Sans JP','Yu Gothic','Meiryo','Hiragino Sans','MS Gothic']\n",
    "avail = []\n",
    "try:\n",
    "    names = [getattr(f,'name','') for f in fm.fontManager.ttflist]\n",
    "    for nm in candidates:\n",
    "        if any(nm in n for n in names):\n",
    "            if nm not in avail:\n",
    "                avail.append(nm)\n",
    "except Exception:\n",
    "    pass\n",
    "if not avail:\n",
    "    avail = ['Noto Sans CJK JP','IPAGothic','DejaVu Sans']\n",
    "plt.rcParams['font.family'] = 'sans-serif'\n",
    "plt.rcParams['font.sans-serif'] = avail + ['DejaVu Sans']\n",
    "plt.rcParams['font.serif'] = ['Noto Serif CJK JP','IPAMincho','DejaVu Serif']\n",
    "plt.rcParams['axes.unicode_minus'] = False\n",
    "try:\n",
    "    sns.set_theme(rc={'font.family':'sans-serif','font.sans-serif': plt.rcParams['font.sans-serif']})\n",
    "except Exception:\n",
    "    pass\n",
    "print('ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š:', plt.rcParams['font.family'], 'â†’', plt.rcParams['font.sans-serif'][:3], '...')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": "## ğŸ“‚ ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿\n\n### ğŸ¯ **ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„**\nå£²ä¸Šãƒ‡ãƒ¼ã‚¿ï¼ˆCSVå½¢å¼ï¼‰ã‚’è‡ªå‹•æ¤œå‡ºã—ã¦èª­ã¿è¾¼ã¿ã¾ã™ã€‚\n\n### ğŸ‘€ **åº—é•·ãŒç¢ºèªã™ã¹ãã“ã¨**\nå®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š\n```\n[INFO] globæ¤œå‡º: output/06_final_enriched_20250701_20250930.csv\n[INFO] åˆ—åå¤‰æ›: 8/8 ä»¶é©ç”¨ â†’ ['store_id', 'sku_id', 'date'...]\nèª­ã¿è¾¼ã¿å®Œäº†: 06_final_enriched_20250930.csv | shape=(50000, 40) | memory=15.2MB\n```\n\n**æ„å‘³**:\n- `shape=(50000, 40)` â†’ 50,000è¡ŒÃ—40åˆ—ã®ãƒ‡ãƒ¼ã‚¿\n- `memory=15.2MB` â†’ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡\n\n**åˆ¤æ–­ãƒã‚¤ãƒ³ãƒˆ**:\n- ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ â†’ `output`ãƒ•ã‚©ãƒ«ãƒ€ã«CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã‹ç¢ºèª\n- ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆ â†’ ãƒ‡ãƒ¼ã‚¿æœŸé–“ã‚’çŸ­ç¸®æ¤œè¨\n\n---\n\n**æ¬¡ã®ã‚»ãƒ«ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ â†“**"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": "def pick_enriched_csv():\n    \"\"\"\n    enriched CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•æ¤œå‡º\n    å„ªå…ˆé †: ç’°å¢ƒå¤‰æ•° â†’ globæœ€æ–° â†’ æ—¢å®šå€¤\n    \"\"\"\n    for env in ('DATA_PATH','ENRICHED_CSV'):\n        p = os.environ.get(env)\n        if p and Path(p).exists():\n            print(f'[INFO] ç’°å¢ƒå¤‰æ•° {env} ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—: {p}')\n            return Path(p)\n    d = Path('output')\n    if d.exists():\n        c = sorted(d.glob('06_final_enriched_*.csv'), reverse=True)\n        if c:\n            print(f'[INFO] globæ¤œå‡º: {c[0]}')\n            return c[0]\n    f = Path('output/06_final_enriched_20250701_20250930.csv')\n    if f.exists():\n        print(f'[INFO] æ—¢å®šãƒ•ã‚¡ã‚¤ãƒ«ä½¿ç”¨: {f}')\n        return f\n    return None\n\nCSV_PATH = pick_enriched_csv()\nif not CSV_PATH:\n    raise FileNotFoundError('output/06_final_enriched_*.csv ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚work/output ã«é…ç½®ã€ã¾ãŸã¯ç’°å¢ƒå¤‰æ•° DATA_PATH ã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚')\n\n# ãƒ¡ãƒ¢ãƒªãƒã‚§ãƒƒã‚¯ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰\ntry:\n    import psutil\n    file_size_mb = CSV_PATH.stat().st_size / (1024**2)\n    available_mem_mb = psutil.virtual_memory().available / (1024**2)\n    if file_size_mb > available_mem_mb * 0.5:\n        print(f'[WARNING] ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º {file_size_mb:.1f}MB ãŒåˆ©ç”¨å¯èƒ½ãƒ¡ãƒ¢ãƒªã®50%è¶…')\nexcept ImportError:\n    pass\n\ndf_raw = pd.read_csv(CSV_PATH, encoding='utf-8-sig')\ndf = df_raw.copy()\n\n# åˆ—åæ­£è¦åŒ–ï¼ˆå­˜åœ¨ã™ã‚Œã°ï¼‰\nrename_map = {\n    'åº—èˆ—':'store_id','å•†å“å':'sku_id','æ—¥ä»˜':'date','å£²ä¸Šæ•°é‡':'qty','å£²ä¸Šé‡‘é¡':'sales_amt',\n    'ãƒ•ã‚§ã‚¤ã‚¹ããã‚Šå¤§åˆ†é¡':'category_l','ãƒ•ã‚§ã‚¤ã‚¹ããã‚Šä¸­åˆ†é¡':'category_m','ãƒ•ã‚§ã‚¤ã‚¹ããã‚Šå°åˆ†é¡':'category_s'\n}\nrenamed = {k:v for k,v in rename_map.items() if k in df.columns}\ndf = df.rename(columns=renamed)\nprint(f'[INFO] åˆ—åå¤‰æ›: {len(renamed)}/{len(rename_map)} ä»¶é©ç”¨ â†’ {list(renamed.values())}')\n\nif 'date' in df.columns: df['date'] = pd.to_datetime(df['date'])\nif 'qty' in df.columns: df['qty'] = pd.to_numeric(df['qty'], errors='coerce').fillna(0).astype('float32')\nif 'sales_amt' in df.columns: df['sales_amt'] = pd.to_numeric(df['sales_amt'], errors='coerce').fillna(0).astype('float32')\n\nprint(f'èª­ã¿è¾¼ã¿å®Œäº†: {CSV_PATH.name} | shape={df.shape} | memory={df.memory_usage(deep=True).sum()/(1024**2):.1f}MB')\ndf.head(3)"
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—2: å£²ä¸Šæœ€å¤§åŒ–ã®ãŸã‚ã®ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šåˆ†æ",
    "",
    "### ğŸ¯ **ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„**",
    "**å£²ä¸Šã‚’æœ€å¤§åŒ–ã™ã‚‹ãŸã‚ã«ã€ã©ã®ãƒ•ãƒ©ã‚°ï¼ˆå¤©å€™ãƒ»æ›œæ—¥ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆç­‰ï¼‰ã®æ—¥ã«å£²ä¸ŠãŒä¼¸ã³ã‚‹ã‹ã‚’åˆ†æã—ã¾ã™ã€‚**",
    "",
    "### âš ï¸ **é‡è¦ãªå¤‰æ›´ç‚¹ï¼ˆå¾“æ¥ã®AutoVizã‹ã‚‰å¤‰æ›´ï¼‰**",
    "- âŒ **å‰Šé™¤**: æ—¥ä»˜ãƒ™ãƒ¼ã‚¹ã®æ™‚ç³»åˆ—ãƒ—ãƒ­ãƒƒãƒˆï¼ˆæ—¥ä»˜ã¨å£²ä¸Šã®æ¯”è¼ƒï¼‰",
    "- âœ… **è¿½åŠ **: ãƒ•ãƒ©ã‚°åˆ¥ã®å£²ä¸Šæ¯”è¼ƒï¼ˆé™é›¨ãƒ•ãƒ©ã‚°ã€é€±æœ«ãƒ•ãƒ©ã‚°ç­‰ã¨å£²ä¸Šã®ç›¸é–¢ï¼‰",
    "- âœ… **è¿½åŠ **: å•†å“ã‚«ãƒ†ã‚´ãƒªé¸æŠæ©Ÿèƒ½ï¼ˆç‰¹å®šã‚«ãƒ†ã‚´ãƒªã«çµã£ãŸåˆ†æãŒå¯èƒ½ï¼‰",
    "",
    "### ğŸ“ˆ **ä½•ãŒåˆ†æã•ã‚Œã‚‹ã‹**",
    "",
    "#### 1ï¸âƒ£ **ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šå¢—åŠ ç‡ãƒ©ãƒ³ã‚­ãƒ³ã‚°**",
    "- å„ãƒ•ãƒ©ã‚°ï¼ˆé™é›¨ã€é€±æœ«ã€çŒ›æš‘æ—¥ãªã©ï¼‰ãŒONã®æ—¥ã¨OFFã®æ—¥ã§ã€å£²ä¸ŠãŒã©ã‚Œã ã‘å¤‰ã‚ã‚‹ã‹ã‚’è¨ˆç®—",
    "- å£²ä¸Šå¢—åŠ ç‡ãŒé«˜ã„ãƒ•ãƒ©ã‚° = å£²ä¸Šæœ€å¤§åŒ–ã®ãƒãƒ£ãƒ³ã‚¹æ—¥",
    "",
    "#### 2ï¸âƒ£ **ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šåˆ†å¸ƒã®å¯è¦–åŒ–**",
    "- ãƒ•ãƒ©ã‚°ONæ™‚ã¨OFFæ™‚ã®å£²ä¸Šåˆ†å¸ƒã‚’æ¯”è¼ƒ",
    "- ã©ã®ãƒ•ãƒ©ã‚°ã®æ—¥ã«é«˜é¡å£²ä¸ŠãŒç™ºç”Ÿã—ã‚„ã™ã„ã‹ã‚’è¦–è¦šçš„ã«æŠŠæ¡",
    "",
    "#### 3ï¸âƒ£ **ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ†æ**",
    "- å•†å“ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ã€ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®å£²ä¸Šãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ",
    "- ä¾‹: ã€Œé£²æ–™ã€ã‚«ãƒ†ã‚´ãƒªã¯çŒ›æš‘æ—¥ã«å£²ä¸Šâ†‘ã€ã€ŒãŠã§ã‚“ã€ã¯å†¬æ—¥ã«å£²ä¸Šâ†‘",
    "",
    "### ğŸ‘€ **åº—é•·ãŒç¢ºèªã™ã¹ãã“ã¨**",
    "",
    "#### âœ… **å®Ÿè¡Œå¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹æƒ…å ±**",
    "1. **ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šå¢—åŠ ç‡ TOP10 ãƒ†ãƒ¼ãƒ–ãƒ«**",
    "   - å„ãƒ•ãƒ©ã‚°ã®ON/OFFæ™‚ã®å¹³å‡å£²ä¸Š",
    "   - å£²ä¸Šå¢—åŠ ç‡ï¼ˆ%ï¼‰",
    "   - è©²å½“æ—¥æ•°",
    "",
    "2. **ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šå¢—åŠ ç‡ã®æ£’ã‚°ãƒ©ãƒ•**",
    "   - èµ¤ã„æ£’ï¼ˆãƒ—ãƒ©ã‚¹ï¼‰: ã“ã®ãƒ•ãƒ©ã‚°ã®æ—¥ã¯å£²ä¸ŠãŒå¢—åŠ  â†’ **é™³åˆ—ãƒ»ç™ºæ³¨ã‚’å¼·åŒ–ã™ã¹ãæ—¥**",
    "   - é’ã„æ£’ï¼ˆãƒã‚¤ãƒŠã‚¹ï¼‰: ã“ã®ãƒ•ãƒ©ã‚°ã®æ—¥ã¯å£²ä¸ŠãŒæ¸›å°‘ â†’ åœ¨åº«ã‚’æŠ‘åˆ¶",
    "",
    "3. **ä¸Šä½5ãƒ•ãƒ©ã‚°ã®ON/OFFå£²ä¸Šåˆ†å¸ƒã‚°ãƒ©ãƒ•**",
    "   - èµ¤ã„åˆ†å¸ƒï¼ˆãƒ•ãƒ©ã‚°ONï¼‰ãŒå³ã«ã‚·ãƒ•ãƒˆ â†’ ãã®ãƒ•ãƒ©ã‚°ã®æ—¥ã¯é«˜é¡å£²ä¸ŠãŒç™ºç”Ÿã—ã‚„ã™ã„",
    "   - é’ã„åˆ†å¸ƒï¼ˆãƒ•ãƒ©ã‚°OFFï¼‰ã¨ã®å·®ãŒå¤§ãã„ â†’ ãã®ãƒ•ãƒ©ã‚°ã®å½±éŸ¿ãŒå¤§ãã„",
    "",
    "### ğŸ’¡ **åº—é•·ã®å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**",
    "",
    "#### ğŸ¯ **å£²ä¸Šå¢—åŠ ç‡ãŒé«˜ã„ãƒ•ãƒ©ã‚°ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆ**",
    "",
    "**ä¾‹: ã€Œé™é›¨ãƒ•ãƒ©ã‚°ã€ã®å£²ä¸Šå¢—åŠ ç‡ +25%**",
    "â†’ **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:",
    "- é™é›¨äºˆå ±ã®æ—¥ã®å‰æ—¥ã«ã€æ¸©ã‹ã„ç·èœãƒ»ã‚«ãƒƒãƒ—éººãƒ»ãƒ›ãƒƒãƒˆé£²æ–™ã®ç™ºæ³¨ã‚’1.3å€ã«å¢—ã‚„ã™",
    "- å…¥å£ä»˜è¿‘ã«å‚˜ãƒ»ãƒ¬ã‚¤ãƒ³ã‚³ãƒ¼ãƒˆãƒ»ãƒ›ãƒƒãƒˆå•†å“ã®ç‰¹è¨­ã‚³ãƒ¼ãƒŠãƒ¼ã‚’è¨­ç½®",
    "- ä¸­è¯ã¾ã‚“ãƒ»ãŠã§ã‚“ã®ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æ‹¡å¤§",
    "",
    "**ä¾‹: ã€Œé€±æœ«ãƒ•ãƒ©ã‚°ã€ã®å£²ä¸Šå¢—åŠ ç‡ +18%**",
    "â†’ **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:",
    "- é‡‘æ›œå¤•æ–¹ã‹ã‚‰å¼å½“ãƒ»ãƒ‡ã‚¶ãƒ¼ãƒˆãƒ»é…’é¡ã®é™³åˆ—ã‚’å¼·åŒ–",
    "- åœŸæ—¥ã®æœã¯æœé£Ÿéœ€è¦ï¼ˆãƒ‘ãƒ³ãƒ»ã‚³ãƒ¼ãƒ’ãƒ¼ï¼‰ã€æ˜¼ã¯å¼å½“ã€å¤•æ–¹ã¯é…’é¡ã®ãƒ”ãƒ¼ã‚¯å¯¾å¿œ",
    "- å®¶æ—å‘ã‘å¤§å®¹é‡å•†å“ã®ãƒ•ã‚§ãƒ¼ã‚¹æ‹¡å¤§",
    "",
    "**ä¾‹: ã€Œçµ¦æ–™æ—¥ãƒ•ãƒ©ã‚°ã€ã®å£²ä¸Šå¢—åŠ ç‡ +12%**",
    "â†’ **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:",
    "- çµ¦æ–™æ—¥ï¼ˆ25æ—¥å‰å¾Œï¼‰ã¯é«˜å˜ä¾¡å¼å½“ãƒ»ã‚¹ã‚¤ãƒ¼ãƒ„ãƒ»ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å•†å“ã‚’ç›®ç«‹ã¤ä½ç½®ã«",
    "- å¤•æ–¹ã®å‰å‡ºã—æ™‚é–“ã‚’æ—©ã‚ã‚‹ï¼ˆ17æ™‚â†’16æ™‚30åˆ†ï¼‰",
    "",
    "#### ğŸ“Š **ã‚«ãƒ†ã‚´ãƒªé¸æŠã®æ´»ç”¨æ–¹æ³•**",
    "",
    "ä¸Šã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆï¼ˆSelectMultipleï¼‰ã§å•†å“ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã™ã‚‹ã¨ã€ãã®ã‚«ãƒ†ã‚´ãƒªã«ç‰¹åŒ–ã—ãŸãƒ•ãƒ©ã‚°åˆ†æãŒå†å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚",
    "",
    "**ä½¿ã„æ–¹**:",
    "1. ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‹ã‚‰åˆ†æã—ãŸã„ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠï¼ˆCtrl/Cmd + ã‚¯ãƒªãƒƒã‚¯ã§è¤‡æ•°é¸æŠï¼‰",
    "2. è‡ªå‹•ã§å†åˆ†æãŒå®Ÿè¡Œã•ã‚Œã€ãã®ã‚«ãƒ†ã‚´ãƒªã®å£²ä¸Šæœ€å¤§åŒ–ãƒ•ãƒ©ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹",
    "3. ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®æœ€é©ãªç™ºæ³¨ãƒ»é™³åˆ—æˆ¦ç•¥ã‚’ç«‹ã¦ã‚‹",
    "",
    "**ä¾‹**:",
    "- **ã€Œé£²æ–™ã€**ã‚’é¸æŠ â†’ ã€ŒçŒ›æš‘æ—¥ã€ã€ŒçœŸå¤æ—¥ã€ãƒ•ãƒ©ã‚°ã§å£²ä¸Šâ†‘ â†’ å¤æ—¥ã®å†·é£²æ–™ç™ºæ³¨å¼·åŒ–",
    "- **ã€Œå¼å½“ã€**ã‚’é¸æŠ â†’ ã€Œé€±æœ«ãƒ•ãƒ©ã‚°ã€ã€Œæ˜¼ãƒ”ãƒ¼ã‚¯ã€ã§å£²ä¸Šâ†‘ â†’ åœŸæ—¥ã®å¼å½“ç™ºæ³¨1.5å€",
    "- **ã€Œãƒ‡ã‚¶ãƒ¼ãƒˆã€**ã‚’é¸æŠ â†’ ã€Œçµ¦æ–™æ—¥ã€ã€Œé€±æœ«ã€ã§å£²ä¸Šâ†‘ â†’ é«˜å˜ä¾¡ã‚¹ã‚¤ãƒ¼ãƒ„é™³åˆ—å¼·åŒ–",
    "",
    "### ğŸš€ **å®Ÿè¡Œæ–¹æ³•**",
    "ä¸‹ã®ã‚»ãƒ«ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚è‡ªå‹•ã§ä»¥ä¸‹ãŒè¡Œã‚ã‚Œã¾ã™:",
    "1. ã‚«ãƒ†ã‚´ãƒªé¸æŠã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã®è¡¨ç¤ºï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰",
    "2. å…¨ã‚«ãƒ†ã‚´ãƒªã§ã®ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šåˆ†æ",
    "3. TOP10ãƒ•ãƒ©ã‚°ã®è¡¨ç¤ºã¨ã‚°ãƒ©ãƒ•å¯è¦–åŒ–",
    "4. ã‚«ãƒ†ã‚´ãƒªé¸æŠæ™‚ã®è‡ªå‹•å†åˆ†æ",
    "",
    "### ğŸ’¾ **GPUé«˜é€ŸåŒ–ã«ã¤ã„ã¦**",
    "- ã“ã®ã‚»ãƒ«ã§ã¯ä¸»ã«ã‚°ãƒ©ãƒ•æç”»ã‚’è¡Œã†ãŸã‚ã€GPUåŠ¹æœã¯é™å®šçš„ã§ã™",
    "- æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPyCaretï¼‰ã§å¤§è¦æ¨¡ãªAIå­¦ç¿’ãŒå®Ÿè¡Œã•ã‚Œã€GPUã®åŠ¹æœãŒæœ€å¤§åŒ–ã•ã‚Œã¾ã™"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ========================================# ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—2: å£²ä¸Šæœ€å¤§åŒ–ã®ãŸã‚ã®ç‰¹å¾´é‡åˆ†æ# ========================================print('='*60)print('ğŸ“Š å£²ä¸Šæœ€å¤§åŒ–åˆ†æ: ã‚«ãƒ†ã‚´ãƒªé¸æŠ + ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šæ¯”è¼ƒ')print('='*60)# ã‚«ãƒ†ã‚´ãƒªé¸æŠï¼ˆipywidgetsï¼‰if WIDGETS and 'category_l' in df.columns:    category_opts = ['å…¨ã‚«ãƒ†ã‚´ãƒª'] + sorted(df['category_l'].dropna().unique().tolist())    category_selector = widgets.SelectMultiple(        options=category_opts,        value=tuple(['å…¨ã‚«ãƒ†ã‚´ãƒª']),        description='å•†å“ã‚«ãƒ†ã‚´ãƒª:',        rows=min(10, len(category_opts))    )    print('âœ… ã‚«ãƒ†ã‚´ãƒªé¸æŠã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆæº–å‚™å®Œäº†')    print('ğŸ‘‰ ä¸‹ã‹ã‚‰åˆ†æã—ãŸã„ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠå¯ï¼šCtrl/Cmd + ã‚¯ãƒªãƒƒã‚¯ï¼‰')    display(category_selector)else:    print('âš ï¸ ã‚«ãƒ†ã‚´ãƒªåˆ—ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€å…¨ãƒ‡ãƒ¼ã‚¿ã§åˆ†æã—ã¾ã™')    category_selector = None# ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šæ¯”è¼ƒã®å®Ÿè¡Œdef analyze_sales_by_flags(df_all, selected_categories=None):    \"\"\"    å£²ä¸Šæœ€å¤§åŒ–ã®ãŸã‚ã®ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šåˆ†æ    - æ—¥ä»˜ãƒ™ãƒ¼ã‚¹ã®æ™‚ç³»åˆ—ã§ã¯ãªãã€ãƒ•ãƒ©ã‚°æ¡ä»¶åˆ¥ã®å£²ä¸Šã‚’æ¯”è¼ƒ    - å„ãƒ•ãƒ©ã‚°ãŒå£²ä¸Šã«ä¸ãˆã‚‹å½±éŸ¿ã‚’å®šé‡åŒ–    \"\"\"    import matplotlib.pyplot as plt    from matplotlib.font_manager import FontProperties        # æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè¨­å®šï¼ˆJP_FPä½¿ç”¨ï¼‰    JP_FP = FontProperties(fname='/usr/share/fonts/opentype/noto/NotoSansCJK-Regular.ttc') if Path('/usr/share/fonts/opentype/noto/NotoSansCJK-Regular.ttc').exists() else None    if JP_FP is None:        try:            import japanize_matplotlib            japanize_matplotlib.japanize()        except:            pass        # ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°    d = df_all.copy()    if selected_categories and 'å…¨ã‚«ãƒ†ã‚´ãƒª' not in selected_categories and 'category_l' in d.columns:        d = d[d['category_l'].isin(selected_categories)]        cat_label = f\"ã‚«ãƒ†ã‚´ãƒª: {', '.join(selected_categories)}\"    else:        cat_label = \"å…¨ã‚«ãƒ†ã‚´ãƒª\"        if d.empty:        print('âš ï¸ é¸æŠã•ã‚ŒãŸã‚«ãƒ†ã‚´ãƒªã«ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“')        return        print(f'\\nåˆ†æå¯¾è±¡: {cat_label} | ãƒ‡ãƒ¼ã‚¿è¡Œæ•°: {len(d):,}')        # ãƒ•ãƒ©ã‚°åˆ—ã‚’æ¤œå‡º    flag_cols = [c for c in d.columns if 'ãƒ•ãƒ©ã‚°' in c or c in ['çŒ›æš‘æ—¥', 'çœŸå¤æ—¥', 'å¤æ—¥', 'å†¬æ—¥', 'çœŸå†¬æ—¥', 'çµ¦æ–™æ—¥', 'çµ¦æ–™æ—¥ç›´å¾Œ', 'æœˆåˆ3æ—¥', 'æœˆæœ«3æ—¥']]        if not flag_cols:        print('âš ï¸ ãƒ•ãƒ©ã‚°åˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“')        return        print(f'\\næ¤œå‡ºã•ã‚ŒãŸãƒ•ãƒ©ã‚°: {len(flag_cols)}å€‹')    for fc in flag_cols[:10]:  # æœ€åˆã®10å€‹ã‚’è¡¨ç¤º        print(f'  - {fc}')    if len(flag_cols) > 10:        print(f'  ... ä»–{len(flag_cols)-10}å€‹')        # ãƒ•ãƒ©ã‚°åˆ¥ã®å¹³å‡å£²ä¸Šã‚’è¨ˆç®—    flag_impact = []        for flag_col in flag_cols:        if flag_col not in d.columns:            continue                # ãƒ•ãƒ©ã‚°ONæ™‚ã®å¹³å‡å£²ä¸Š        sales_on = d[d[flag_col] == 1]['sales_amt'].mean() if 'sales_amt' in d.columns else 0                # ãƒ•ãƒ©ã‚°OFFæ™‚ã®å¹³å‡å£²ä¸Š        sales_off = d[d[flag_col] != 1]['sales_amt'].mean() if 'sales_amt' in d.columns else 0                # å£²ä¸Šå¢—åŠ ç‡ï¼ˆUpliftï¼‰        if sales_off > 0:            uplift_pct = ((sales_on - sales_off) / sales_off) * 100        else:            uplift_pct = 0                # è©²å½“æ—¥æ•°        days_on = (d[flag_col] == 1).sum() if flag_col in d.columns else 0                flag_impact.append({            'ãƒ•ãƒ©ã‚°': flag_col,            'ãƒ•ãƒ©ã‚°ONæ™‚å¹³å‡å£²ä¸Š': sales_on,            'ãƒ•ãƒ©ã‚°OFFæ™‚å¹³å‡å£²ä¸Š': sales_off,            'å£²ä¸Šå¢—åŠ ç‡(%)': uplift_pct,            'è©²å½“æ—¥æ•°': days_on        })        # DataFrameåŒ–ã—ã¦å£²ä¸Šå¢—åŠ ç‡ã§ã‚½ãƒ¼ãƒˆ    impact_df = pd.DataFrame(flag_impact).sort_values('å£²ä¸Šå¢—åŠ ç‡(%)', ascending=False)        print(f'\\n' + '='*60)    print(f'ğŸ¯ å£²ä¸Šæœ€å¤§åŒ–ã®ãŸã‚ã®é‡è¦ãƒ•ãƒ©ã‚° TOP10 ({cat_label})')    print('='*60)    print('ğŸ’¡ å£²ä¸Šå¢—åŠ ç‡ãŒé«˜ã„ãƒ•ãƒ©ã‚°ã®æ—¥ã¯ã€è©²å½“ã‚«ãƒ†ã‚´ãƒªã®é™³åˆ—ãƒ»ç™ºæ³¨ã‚’å¼·åŒ–ã™ã¹ãæ—¥ã§ã™\\n')    display(impact_df.head(10))        # å¯è¦–åŒ–1: ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šå¢—åŠ ç‡ï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰    top10 = impact_df.head(10)    if not top10.empty:        fig, ax = plt.subplots(figsize=(12, 6))        colors = ['#FF4B4B' if x > 0 else '#4B4BFF' for x in top10['å£²ä¸Šå¢—åŠ ç‡(%)']]        ax.barh(top10['ãƒ•ãƒ©ã‚°'], top10['å£²ä¸Šå¢—åŠ ç‡(%)'], color=colors)        ax.set_xlabel('å£²ä¸Šå¢—åŠ ç‡ (%)', fontproperties=JP_FP, fontsize=12)        ax.set_title(f'ãƒ•ãƒ©ã‚°åˆ¥å£²ä¸Šå¢—åŠ ç‡ TOP10 ({cat_label})', fontproperties=JP_FP, fontsize=14, fontweight='bold')        ax.axvline(0, color='black', linewidth=0.8, linestyle='--')        ax.grid(axis='x', alpha=0.3)                # Yè»¸ãƒ©ãƒ™ãƒ«ã«æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆé©ç”¨        if JP_FP:            ax.set_yticklabels(top10['ãƒ•ãƒ©ã‚°'], fontproperties=JP_FP)                plt.tight_layout()        plt.show()                print('\\nğŸ“Š ã‚°ãƒ©ãƒ•ã®è¦‹æ–¹:')        print('  - èµ¤ã„æ£’ï¼ˆãƒ—ãƒ©ã‚¹ï¼‰: ã“ã®ãƒ•ãƒ©ã‚°ã®æ—¥ã¯å£²ä¸ŠãŒå¢—åŠ  â†’ é™³åˆ—ãƒ»ç™ºæ³¨å¼·åŒ–')        print('  - é’ã„æ£’ï¼ˆãƒã‚¤ãƒŠã‚¹ï¼‰: ã“ã®ãƒ•ãƒ©ã‚°ã®æ—¥ã¯å£²ä¸ŠãŒæ¸›å°‘ â†’ åœ¨åº«æŠ‘åˆ¶')        # å¯è¦–åŒ–2: ãƒ•ãƒ©ã‚°ON/OFFæ™‚ã®å£²ä¸Šåˆ†å¸ƒæ¯”è¼ƒï¼ˆä¸Šä½5ãƒ•ãƒ©ã‚°ï¼‰    top5_flags = impact_df.head(5)['ãƒ•ãƒ©ã‚°'].tolist()        if top5_flags:        print(f'\\n' + '='*60)        print(f'ğŸ“ˆ ä¸Šä½5ãƒ•ãƒ©ã‚°ã®ON/OFFå£²ä¸Šåˆ†å¸ƒæ¯”è¼ƒ')        print('='*60)                fig, axes = plt.subplots(2, 3, figsize=(16, 10))        axes = axes.flatten()                for idx, flag_col in enumerate(top5_flags):            if idx >= 6:                break                        if flag_col not in d.columns:                continue                        ax = axes[idx]                        # ãƒ•ãƒ©ã‚°ON/OFFåˆ¥ã®å£²ä¸Šåˆ†å¸ƒ            sales_on = d[d[flag_col] == 1]['sales_amt'].dropna()            sales_off = d[d[flag_col] != 1]['sales_amt'].dropna()                        ax.hist(sales_on, bins=30, alpha=0.7, label=f'{flag_col} ON', color='red', edgecolor='black')            ax.hist(sales_off, bins=30, alpha=0.5, label=f'{flag_col} OFF', color='blue', edgecolor='black')                        ax.set_xlabel('å£²ä¸Šé‡‘é¡', fontproperties=JP_FP, fontsize=10)            ax.set_ylabel('é »åº¦', fontproperties=JP_FP, fontsize=10)            ax.set_title(f'{flag_col} ã®å£²ä¸Šåˆ†å¸ƒ', fontproperties=JP_FP, fontsize=11, fontweight='bold')            ax.legend(prop=JP_FP)            ax.grid(alpha=0.3)                # æ®‹ã‚Šã®ç©ºã‚»ãƒ«ã‚’éè¡¨ç¤º        for idx in range(len(top5_flags), 6):            axes[idx].axis('off')                plt.tight_layout()        plt.show()                print('\\nğŸ“Š ã‚°ãƒ©ãƒ•ã®è¦‹æ–¹:')        print('  - èµ¤ã„åˆ†å¸ƒï¼ˆãƒ•ãƒ©ã‚°ONï¼‰ãŒå³ã«ã‚·ãƒ•ãƒˆ â†’ ãã®ãƒ•ãƒ©ã‚°ã®æ—¥ã¯å£²ä¸ŠãŒé«˜ã„å‚¾å‘')        print('  - é’ã„åˆ†å¸ƒï¼ˆãƒ•ãƒ©ã‚°OFFï¼‰ãŒå·¦ â†’ é€šå¸¸æ—¥ã®å£²ä¸Š')        return impact_df# åˆ†æå®Ÿè¡Œï¼ˆã‚«ãƒ†ã‚´ãƒªé¸æŠãªã—ã§å…¨ãƒ‡ãƒ¼ã‚¿ï¼‰if 'sales_amt' in df.columns:    print('\\nğŸš€ åˆ†æé–‹å§‹: å…¨ã‚«ãƒ†ã‚´ãƒªã§å®Ÿè¡Œ')    impact_result = analyze_sales_by_flags(df, selected_categories=None)else:    print('âš ï¸ sales_amtåˆ—ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€åˆ†æã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™')    impact_result = None# ã‚«ãƒ†ã‚´ãƒªé¸æŠæ™‚ã®å†åˆ†æï¼ˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãŒã‚ã‚Œã°ï¼‰if category_selector is not None:    def on_category_change(change):        if change['name'] == 'value':            selected = list(change['owner'].value)            print('\\n' + '='*60)            print(f'ğŸ”„ ã‚«ãƒ†ã‚´ãƒªå†é¸æŠ: {selected}')            print('='*60)            analyze_sales_by_flags(df, selected_categories=selected)        category_selector.observe(on_category_change, names='value')    print('\\nâœ… ã‚«ãƒ†ã‚´ãƒªé¸æŠã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆæœ‰åŠ¹åŒ–')    print('ğŸ‘‰ ä¸Šã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã§ã‚«ãƒ†ã‚´ãƒªã‚’å¤‰æ›´ã™ã‚‹ã¨ã€è‡ªå‹•ã§å†åˆ†æã•ã‚Œã¾ã™')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": "## ğŸ”§ ã‚¹ãƒ†ãƒƒãƒ—3: ç‰¹å¾´é‡ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ\n\n### ğŸ¯ **ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„**\nAIãŒåˆ†æã—ã‚„ã™ã„ã‚ˆã†ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’æ—¥æ¬¡Ã—åº—èˆ—å˜ä½ã«æ•´ç†ã—ã¾ã™ã€‚\n\n### ğŸ‘€ **åº—é•·ãŒç¢ºèªã™ã¹ãã“ã¨**\nå®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š\n```\n[INFO] åˆ©ç”¨å¯èƒ½ç‰¹å¾´é‡: 28/30 å€‹\n[INFO] ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°: ['category_l', 'category_m', 'store_id']\n[INFO] ç‰¹å¾´é‡ãƒ†ãƒ¼ãƒ–ãƒ«: (2500, 35) (è¡ŒÃ—åˆ—)\n[INFO] æ¬ æå€¤: 150 å€‹\n```\n\n**æ„å‘³**:\n- **28å€‹ã®è¦å› **ï¼ˆæ°—æ¸©ã€æ›œæ—¥ã€å¤©æ°—ãªã©ï¼‰ã‚’ä½¿ç”¨\n- **2,500æ—¥åˆ†**ã®ãƒ‡ãƒ¼ã‚¿ã§åˆ†æ\n- æ¬ æå€¤ã¯è‡ªå‹•å‡¦ç†ã•ã‚Œã‚‹\n\n### ğŸ’¡ **è¿½åŠ ã•ã‚ŒãŸç‰¹å¾´é‡ã®æ„å‘³**\nã“ã®ã‚»ãƒ«ã§ã€ä»¥ä¸‹ã®ä¾¿åˆ©ãªç‰¹å¾´é‡ãŒè‡ªå‹•è¿½åŠ ã•ã‚Œã¾ã™ï¼š\n\n| ç‰¹å¾´é‡ | æ„å‘³ | å®Ÿå‹™ã§ã®æ´»ç”¨ |\n|--------|------|------------|\n| `sales_lag_1` | å‰æ—¥ã®å£²ä¸Š | ã€Œæ˜¨æ—¥å£²ã‚ŒãŸã‹ã‚‰ä»Šæ—¥ã‚‚å£²ã‚Œã‚‹ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ç™ºè¦‹ |\n| `sales_lag_7` | 1é€±é–“å‰ã®å£²ä¸Š | ã€Œå…ˆé€±ã®æœˆæ›œã¨ä»Šé€±ã®æœˆæ›œã¯ä¼¼ã¦ã„ã‚‹ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ç™ºè¦‹ |\n| `sales_rolling_7` | 7æ—¥ç§»å‹•å¹³å‡ | ãƒˆãƒ¬ãƒ³ãƒ‰æŠŠæ¡ï¼ˆå£²ä¸ŠãŒä¼¸ã³ã¦ã„ã‚‹ã‹ä¸‹ãŒã£ã¦ã„ã‚‹ã‹ï¼‰ |\n| `day_of_week` | æ›œæ—¥ï¼ˆ0=æœˆæ›œã€6=æ—¥æ›œï¼‰ | æ›œæ—¥åˆ¥ã®å£²ä¸Šãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ |\n| `is_weekend` | é€±æœ«ãƒ•ãƒ©ã‚°ï¼ˆåœŸæ—¥=1ï¼‰ | é€±æœ«åŠ¹æœã®æ¸¬å®š |\n\n**åˆ¤æ–­ãƒã‚¤ãƒ³ãƒˆ**:\n- æ¬ æå€¤ãŒ50%è¶…ã®åˆ— â†’ è‡ªå‹•ã§é™¤å¤–ã•ã‚Œã‚‹\n- ç‰¹å¾´é‡ãŒ10å€‹æœªæº€ â†’ ãƒ‡ãƒ¼ã‚¿æœŸé–“ã‚’å»¶é•·æ¤œè¨\n\nã“ã®ã‚»ãƒ«ã¯è‡ªå‹•å®Ÿè¡Œã™ã‚‹ã ã‘ã§OKã§ã™ã€‚\n\n---\n\n**æ¬¡ã®ã‚»ãƒ«ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ â†“**"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": "# å…¨ã¦ã®æ•°å€¤åˆ—ã‚’ç‰¹å¾´é‡ã¨ã—ã¦ä½¿ç”¨ï¼ˆäº‹å‰ã®çµã‚Šè¾¼ã¿ãªã—ï¼‰\nprint('[INFO] ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã‚‹å…¨ã¦ã®åˆ—ã‚’ä½¿ç”¨ã—ã¾ã™ï¼ˆäº‹å‰çµã‚Šè¾¼ã¿ãªã—ï¼‰')\n\n# é™¤å¤–ã™ã¹ãåˆ—ï¼ˆåˆ†æå¯¾è±¡ã§ãªã„åˆ—ï¼‰\nexclude_cols = ['åº—èˆ—', 'å•†å“å', 'æ—¥ä»˜', 'date', 'store_id', 'sku_id', \n                'category_l', 'category_m', 'category_s',\n                'ãƒ•ã‚§ã‚¤ã‚¹ããã‚Šå¤§åˆ†é¡', 'ãƒ•ã‚§ã‚¤ã‚¹ããã‚Šä¸­åˆ†é¡', 'ãƒ•ã‚§ã‚¤ã‚¹ããã‚Šå°åˆ†é¡',\n                'å£²ä¸Šæ•°é‡', 'å£²ä¸Šé‡‘é¡', 'qty', 'sales_amt', 'price',\n                'æ˜¨å¹´åŒæ—¥_å£²ä¸Š', 'æ˜¨å¹´åŒæ—¥_å®¢æ•°', 'æ˜¨å¹´åŒæ—¥_å®¢å˜ä¾¡']  # ç›®çš„å¤‰æ•°ã¨é–¢é€£åˆ—ã‚’é™¤å¤–\n\n# å…¨åˆ—ãƒªã‚¹ãƒˆ\nall_cols = df.columns.tolist()\n\n# æ•°å€¤åˆ—ã®ã¿æŠ½å‡ºï¼ˆæ–‡å­—åˆ—ãƒ»æ—¥ä»˜å‹ã‚’é™¤ãï¼‰\nnumeric_cols = df.select_dtypes(include=[np.number]).columns.tolist()\n\n# ç‰¹å¾´é‡å€™è£œï¼šæ•°å€¤åˆ—ã‹ã‚‰é™¤å¤–åˆ—ã‚’å¼•ã\nfeature_cols = [c for c in numeric_cols if c not in exclude_cols]\n\nprint(f'[INFO] å…¨åˆ—æ•°: {len(all_cols)}')\nprint(f'[INFO] æ•°å€¤åˆ—æ•°: {len(numeric_cols)}')\nprint(f'[INFO] é™¤å¤–åˆ—æ•°: {len([c for c in exclude_cols if c in all_cols])}')\nprint(f'[INFO] ä½¿ç”¨ã™ã‚‹ç‰¹å¾´é‡: {len(feature_cols)} å€‹')\nprint(f'\\n[ç‰¹å¾´é‡ãƒªã‚¹ãƒˆï¼ˆå…¨{len(feature_cols)}å€‹ï¼‰]:')\nfor i, col in enumerate(feature_cols, 1):\n    print(f'  {i}. {col}')\n\n# ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã®ç¢ºèª\ncategorical_cols = df.select_dtypes(include=['object']).columns.tolist()\ncategorical_present = [c for c in categorical_cols if c not in exclude_cols and c in df.columns]\nprint(f'\\n[INFO] ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°: {len(categorical_present)} å€‹ â†’ {categorical_present}')\n\n# åŸºæœ¬ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹ç¯‰ï¼ˆå…¨ã¦ã®æ•°å€¤ç‰¹å¾´é‡ã‚’ä½¿ç”¨ï¼‰\nkeep = ['date', 'store_id', 'sales_amt'] + feature_cols\ntmp = df[[c for c in keep if c in df.columns]].copy()\n\n# æ—¥ä»˜Ã—åº—èˆ—ã§ç‰¹å¾´é‡ã‚’ä»£è¡¨åŒ–ï¼ˆæ•°å€¤ã¯å¹³å‡ï¼‰ã€å£²ä¸Šã¯åˆè¨ˆ\nXdf = tmp.groupby(['date','store_id'], as_index=False)[feature_cols].mean() if feature_cols else tmp[['date','store_id']].drop_duplicates()\nydf = tmp.groupby(['date','store_id'], as_index=False)['sales_amt'].sum()\nfeat = Xdf.merge(ydf, on=['date','store_id'], how='inner')\n\n# ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã®è¿½åŠ ï¼ˆå…ƒãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ï¼‰\nif categorical_present:\n    cat_data = df[['date','store_id'] + categorical_present].drop_duplicates()\n    feat = feat.merge(cat_data, on=['date','store_id'], how='left')\n    print(f'[INFO] ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã‚’ãƒãƒ¼ã‚¸: {categorical_present}')\n\nprint(f'\\n[INFO] ç‰¹å¾´é‡ãƒ†ãƒ¼ãƒ–ãƒ«: {feat.shape} (è¡ŒÃ—åˆ—)')\nprint(f'[INFO] æ¬ æå€¤: {feat.isnull().sum().sum()} å€‹ ({feat.isnull().sum().sum() / feat.size * 100:.2f}%)')\n\n# æ¬ æå€¤ãŒå¤šã„åˆ—ã‚’è­¦å‘Š\nmissing_ratio = feat.isnull().sum() / len(feat)\nhigh_missing = missing_ratio[missing_ratio > 0.5].sort_values(ascending=False)\nif not high_missing.empty:\n    print(f'\\n[WARNING] æ¬ æå€¤50%è¶…ã®åˆ—ï¼ˆ{len(high_missing)}å€‹ï¼‰:')\n    for col, ratio in high_missing.items():\n        print(f'  - {col}: {ratio*100:.1f}% æ¬ æ')\n\nfeat.head(3)"
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": "## ğŸ¤– ã‚¹ãƒ†ãƒƒãƒ—4: PyCaret â€” AIã§å£²ä¸Šäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆ\n\n### ğŸ¯ **ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„**\n**PyCaretã®å…¨å›å¸°ãƒ¢ãƒ‡ãƒ«ï¼ˆ15ï½20ç¨®é¡ï¼‰ã‚’è‡ªå‹•ã§è©¦ã—ã€ã©ã®ãƒ¢ãƒ‡ãƒ«ãŒä¸€ç•ªå£²ä¸Šã‚’äºˆæ¸¬ã§ãã‚‹ã‹ç«¶ã‚ã›ã¾ã™ã€‚**\n\n---\n\n### ğŸ“Š **æ¯”è¼ƒã•ã‚Œã‚‹ãƒ¢ãƒ‡ãƒ«ï¼ˆå…¨ç¨®é¡ï¼‰**\n\nä»¥ä¸‹ã®ãƒ¢ãƒ‡ãƒ«ãŒè‡ªå‹•çš„ã«æ¯”è¼ƒã•ã‚Œã¾ã™ï¼š\n\n| ã‚«ãƒ†ã‚´ãƒª | ãƒ¢ãƒ‡ãƒ«å | ç‰¹å¾´ |\n|----------|----------|------|\n| **ç·šå½¢ãƒ¢ãƒ‡ãƒ«** | Linear Regression (lr) | ã‚·ãƒ³ãƒ—ãƒ«ã€è§£é‡ˆã—ã‚„ã™ã„ |\n| | Ridge Regression (ridge) | éå­¦ç¿’ã‚’é˜²ãç·šå½¢ãƒ¢ãƒ‡ãƒ« |\n| | Lasso Regression (lasso) | ä¸è¦ãªç‰¹å¾´ã‚’è‡ªå‹•é™¤å¤– |\n| | Elastic Net (en) | Ridge + Lasso ã®çµ„ã¿åˆã‚ã› |\n| | Least Angle Regression (lar) | ç‰¹å¾´é¸æŠã«å„ªã‚Œã‚‹ |\n| | Lasso Least Angle Regression (llar) | LAR + Lasso |\n| | Orthogonal Matching Pursuit (omp) | ã‚¹ãƒ‘ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ« |\n| **æœ¨ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«** | Decision Tree (dt) | ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã€è§£é‡ˆã—ã‚„ã™ã„ |\n| | Random Forest (rf) | é«˜ç²¾åº¦ã€å®‰å®šæ€§ãŒé«˜ã„ |\n| | Extra Trees (et) | Random Forestã®æ”¹è‰¯ç‰ˆ |\n| | Gradient Boosting (gbr) | é«˜ç²¾åº¦ã€è¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³å¯¾å¿œ |\n| | AdaBoost (ada) | å¼±å­¦ç¿’å™¨ã®çµ„ã¿åˆã‚ã› |\n| **é«˜åº¦ãªãƒ¢ãƒ‡ãƒ«** | Light Gradient Boosting (lightgbm) | é«˜é€Ÿãƒ»é«˜ç²¾åº¦ |\n| | CatBoost (catboost) | ã‚«ãƒ†ã‚´ãƒªå¤‰æ•°ã«å¼·ã„ |\n| | XGBoost (xgboost) | ã‚³ãƒ³ãƒšã§äººæ°—ã®é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ« |\n| **ãã®ä»–** | K Neighbors Regressor (knn) | è¿‘å‚ãƒ™ãƒ¼ã‚¹ |\n| | Support Vector Regressor (svm) | ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ |\n| | Huber Regressor (huber) | å¤–ã‚Œå€¤ã«å¼·ã„ |\n| | Bayesian Ridge (br) | ãƒ™ã‚¤ã‚ºçµ±è¨ˆãƒ™ãƒ¼ã‚¹ |\n| | Passive Aggressive (par) | ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å­¦ç¿’å‘ã‘ |\n\n**åˆè¨ˆ: 15ï½20ç¨®é¡ã®ãƒ¢ãƒ‡ãƒ«ã‚’è‡ªå‹•æ¯”è¼ƒ**\n\n---\n\n### ğŸ‘€ **åº—é•·ãŒè¦‹ã‚‹ã¹ãæƒ…å ±ã¨åˆ¤æ–­æ–¹æ³•**\n\n#### **ğŸ“Š Leaderboardï¼ˆæˆç¸¾è¡¨ï¼‰ã®è¦‹æ–¹**\n\nå®Ÿè¡Œã™ã‚‹ã¨ã€å…¨ãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒçµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š\n\n| Modelï¼ˆãƒ¢ãƒ‡ãƒ«åï¼‰ | R2 | RMSE | MAE | RMSLE | MAPE |\n|-------------------|-----|------|-----|-------|------|\n| **lightgbm** | **0.87** | 1050 | 820 | 0.15 | 0.12 |\n| xgboost | 0.86 | 1100 | 850 | 0.16 | 0.13 |\n| catboost | 0.85 | 1150 | 880 | 0.17 | 0.14 |\n| rf | 0.83 | 1250 | 920 | 0.18 | 0.15 |\n| gbr | 0.82 | 1300 | 950 | 0.19 | 0.16 |\n| ... | ... | ... | ... | ... | ... |\n\n**å„åˆ—ã®æ„å‘³**:\n- **R2ï¼ˆæ±ºå®šä¿‚æ•°ï¼‰**: **æœ€é‡è¦æŒ‡æ¨™** â€” äºˆæ¸¬ç²¾åº¦ï¼ˆ0ï½1ã€é«˜ã„ã»ã©è‰¯ã„ï¼‰\n- **RMSE**: äºˆæ¸¬èª¤å·®ã®å¹³å‡ï¼ˆå°ã•ã„ã»ã©è‰¯ã„ï¼‰\n- **MAE**: çµ¶å¯¾èª¤å·®ã®å¹³å‡ï¼ˆå°ã•ã„ã»ã©è‰¯ã„ï¼‰\n- **RMSLE**: å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ã®èª¤å·®ï¼ˆå°ã•ã„ã»ã©è‰¯ã„ï¼‰\n- **MAPE**: ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆèª¤å·®ï¼ˆå°ã•ã„ã»ã©è‰¯ã„ã€0.2æœªæº€ãŒå®Ÿç”¨ãƒ¬ãƒ™ãƒ«ï¼‰\n\n---\n\n### ğŸ“ˆ **R2ã‚¹ã‚³ã‚¢ã®èª­ã¿æ–¹**\n\n| R2ã®å€¤ | æ„å‘³ | å®Ÿå‹™ã§ã®åˆ¤æ–­ |\n|--------|------|------------|\n| **0.8ä»¥ä¸Š** | éå¸¸ã«å„ªç§€ | âœ… ã“ã®ãƒ¢ãƒ‡ãƒ«ã§æ¥é€±ã®ç™ºæ³¨è¨ˆç”»ã‚’ç«‹ã¦ã¦OK |\n| **0.6ï½0.8** | ã¾ã‚ã¾ã‚ä½¿ãˆã‚‹ | âœ… è£œåŠ©çš„ã«ä½¿ç”¨ï¼ˆåº—é•·ã®çµŒé¨“ã¨ä½µç”¨ï¼‰ |\n| **0.5ï½0.6** | ã‚„ã‚„ä¸è¶³ | âš ï¸ ãƒ‡ãƒ¼ã‚¿æœŸé–“ã‚’å»¶é•·ã™ã‚‹ã‹ã€è¦å› ã‚’è¿½åŠ æ¤œè¨ |\n| **0.5æœªæº€** | äºˆæ¸¬ç²¾åº¦ä½ã„ | âŒ ãƒ—ãƒ­ãƒ¢æƒ…å ±ãƒ»ç«¶åˆæƒ…å ±ãªã©ã‚’è¿½åŠ ãŒå¿…è¦ |\n\n---\n\n### ğŸ† **ä¸Šä½ãƒ¢ãƒ‡ãƒ«ã®ç‰¹å¾´**\n\n#### **LightGBM / XGBoost / CatBoost ãŒä¸Šä½ã®å ´åˆ**\n- **æ„å‘³**: å£²ä¸ŠãŒè¤‡é›‘ãªè¦å› ã§æ±ºã¾ã‚‹ï¼ˆå¤©å€™ãƒ»æ›œæ—¥ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã®çµ„ã¿åˆã‚ã›ï¼‰\n- **ãƒ¡ãƒªãƒƒãƒˆ**: é«˜ç²¾åº¦ã§ã€éç·šå½¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ‰ãˆã‚‰ã‚Œã‚‹\n- **å®Ÿå‹™**: æ¬¡ã®ã€Œç‰¹å¾´é‡é‡è¦åº¦ã€ã§ä¸»è¦å› ã‚’ç‰¹å®šã—ã€é‡ç‚¹å¯¾ç­–\n\n#### **Random Forest / Gradient Boosting ãŒä¸Šä½ã®å ´åˆ**\n- **æ„å‘³**: ãƒ‡ãƒ¼ã‚¿ã«ãƒã‚¤ã‚ºãŒã‚ã‚‹ãŒã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯æ‰ãˆã‚‰ã‚Œã‚‹\n- **ãƒ¡ãƒªãƒƒãƒˆ**: å®‰å®šæ€§ãŒé«˜ãã€å¤–ã‚Œå€¤ã«å¼·ã„\n- **å®Ÿå‹™**: ç‰¹å¾´é‡é‡è¦åº¦ãƒˆãƒƒãƒ—5ã‚’æ¯é€±ãƒã‚§ãƒƒã‚¯\n\n#### **Linear Regression / Ridge ãŒä¸Šä½ã®å ´åˆ**\n- **æ„å‘³**: å£²ä¸ŠãŒã‚·ãƒ³ãƒ—ãƒ«ãªè¦å› ã§æ±ºã¾ã‚‹ï¼ˆæ°—æ¸©ãƒ»æ›œæ—¥ãªã©ï¼‰\n- **ãƒ¡ãƒªãƒƒãƒˆ**: è§£é‡ˆã—ã‚„ã™ãã€èª¬æ˜ãŒç°¡å˜\n- **å®Ÿå‹™**: 1ï½2å€‹ã®ä¸»è¦å› ã«é›†ä¸­å¯¾ç­–\n\n---\n\n### ğŸ’» **GPUä½¿ç”¨ã«ã¤ã„ã¦**\n\n**Q: ã“ã®AIäºˆæ¸¬å‡¦ç†ã«GPUã¯ä½¿ã‚ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ**\n\n**A: ã„ã„ãˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯CPUã®ã¿ã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚**\n\n#### **GPUã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•**\n\nç‰¹å®šã®ãƒ¢ãƒ‡ãƒ«ã¯GPUã§é«˜é€ŸåŒ–ã§ãã¾ã™ï¼š\n\n| ãƒ¢ãƒ‡ãƒ« | GPUå¯¾å¿œ | è¨­å®šæ–¹æ³• |\n|--------|---------|----------|\n| **LightGBM** | âœ… å¯¾å¿œ | `device='gpu'` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ  |\n| **XGBoost** | âœ… å¯¾å¿œ | `tree_method='gpu_hist'` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ  |\n| **CatBoost** | âœ… å¯¾å¿œ | `task_type='GPU'` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ  |\n| Random Forest | âŒ éå¯¾å¿œ | CPU ã®ã¿ |\n| Gradient Boosting | âŒ éå¯¾å¿œ | CPU ã®ã¿ |\n\n**GPUä½¿ç”¨ä¾‹ï¼ˆLightGBMï¼‰**:\n```python\nfrom pycaret.regression import create_model\nlgbm_gpu = create_model('lightgbm', device='gpu')\n```\n\n**GPUä½¿ç”¨ã®ãƒ¡ãƒªãƒƒãƒˆ**:\n- å­¦ç¿’æ™‚é–“ãŒ2ï½10å€é«˜é€ŸåŒ–\n- å¤§é‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ10ä¸‡è¡Œä»¥ä¸Šï¼‰ã§åŠ¹æœå¤§\n- å•†å“æ•°ãŒå¤šã„å ´åˆï¼ˆ1000+ SKUï¼‰ã«æœ‰åŠ¹\n\n**æ³¨æ„ç‚¹**:\n- GPUå¯¾å¿œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ï¼ˆ`pip install lightgbm --config-settings=cmake.args=\"-DUSE_GPU=1\"`ï¼‰\n- NVIDIA GPU + CUDAç’°å¢ƒãŒå¿…è¦\n- å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ï¼ˆæ•°åƒè¡Œï¼‰ã§ã¯CPUã®æ–¹ãŒé€Ÿã„å ´åˆã‚‚ã‚ã‚‹\n\n---\n\n### ğŸ” **Feature Importanceï¼ˆé‡è¦åº¦ã‚°ãƒ©ãƒ•ï¼‰ã®è¦‹æ–¹**\n\nLeaderboardã®å¾Œã«ã€æœ€è‰¯ãƒ¢ãƒ‡ãƒ«ã®ç‰¹å¾´é‡é‡è¦åº¦ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\n\n**èª­ã¿æ–¹**:\n- æ¨ªè»¸ï¼šå„ç‰¹å¾´é‡ã®é‡è¦åº¦ï¼ˆ0ï½1ï¼‰\n- ç¸¦è»¸ï¼šç‰¹å¾´é‡å\n- **é‡è¦åº¦ãŒé«˜ã„ = å£²ä¸Šã¸ã®å½±éŸ¿ãŒå¤§ãã„**\n\n**å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆé‡è¦åº¦åˆ¥ï¼‰**:\n\n| é‡è¦åº¦ | ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |\n|--------|-----------|\n| **30%ä»¥ä¸Š** | ğŸ”´ æ¯æ—¥ãƒã‚§ãƒƒã‚¯å¿…é ˆï¼ˆä¾‹ï¼šå¤©æ°—äºˆå ±ã‚’æ¯æœç¢ºèªï¼‰ |\n| **15ï½30%** | ğŸŸ¡ é€±1å›ãƒã‚§ãƒƒã‚¯ï¼ˆä¾‹ï¼šé€±æœ«ç™ºæ³¨ã‚’æœ¨æ›œã«ç¢ºèªï¼‰ |\n| **5ï½15%** | ğŸŸ¢ æœˆ1å›ãƒã‚§ãƒƒã‚¯ï¼ˆä¾‹ï¼šçµ¦æ–™æ—¥å‰ã®é™³åˆ—ã‚’æœˆåˆã«è¨ˆç”»ï¼‰ |\n| **5%æœªæº€** | âšª å‚è€ƒç¨‹åº¦ |\n\n---\n\n### ğŸ“Š **æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆï¼ˆResiduals Plotï¼‰ã®è¦‹æ–¹**\n\nFeature Importanceã®å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•ã€‚\n\n**è¦‹ã‚‹ã¹ããƒã‚¤ãƒ³ãƒˆ**:\n```\nâœ… ç‚¹ãŒãƒ©ãƒ³ãƒ€ãƒ ã«æ•£ã‚‰ã°ã£ã¦ã„ã‚‹ â†’ ãƒ¢ãƒ‡ãƒ«ãŒæ­£ã—ãæ©Ÿèƒ½\nâš ï¸ ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¦‹ãˆã‚‹ï¼ˆå³ä¸ŠãŒã‚Š/å³ä¸‹ãŒã‚Šï¼‰ â†’ ãƒ¢ãƒ‡ãƒ«ã«æ”¹å–„ä½™åœ°\nâš ï¸ æ¥µç«¯ãªå¤–ã‚Œå€¤ãŒã‚ã‚‹ â†’ ç•°å¸¸æ—¥ã‚’æ¤œå‡ºï¼ˆã‚»ãƒ¼ãƒ«æ—¥ãªã©ï¼‰\n```\n\n**å®Ÿå‹™ã§ã®ä½¿ã„æ–¹**:\n- ãƒ©ãƒ³ãƒ€ãƒ åˆ†å¸ƒ â†’ ã“ã®ãƒ¢ãƒ‡ãƒ«ã§äºˆæ¸¬ã—ã¦OK\n- ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚ã‚Š â†’ ãƒ‡ãƒ¼ã‚¿è¿½åŠ ï¼ˆãƒ—ãƒ­ãƒ¢æƒ…å ±ç­‰ï¼‰ã‚’æ¤œè¨\n- å¤–ã‚Œå€¤ â†’ ã€Œã‚»ãƒ¼ãƒ«æ—¥ã€ã€Œç«¶åˆåº—é–‹åº—æ—¥ã€ãªã©ã‚’è¨˜éŒ²\n\n---\n\n### â±ï¸ **å®Ÿè¡Œæ™‚é–“ã®ç›®å®‰**\n\n| ãƒ‡ãƒ¼ã‚¿è¦æ¨¡ | CPUå®Ÿè¡Œæ™‚é–“ | GPUå®Ÿè¡Œæ™‚é–“ï¼ˆå‚è€ƒï¼‰ |\n|-----------|------------|-------------------|\n| å°è¦æ¨¡ï¼ˆï½1,000è¡Œï¼‰ | 30ç§’ï½1åˆ† | - |\n| ä¸­è¦æ¨¡ï¼ˆ1,000ï½10,000è¡Œï¼‰ | 1ï½3åˆ† | 30ç§’ï½1åˆ† |\n| å¤§è¦æ¨¡ï¼ˆ10,000ï½100,000è¡Œï¼‰ | 5ï½15åˆ† | 1ï½3åˆ† |\n| è¶…å¤§è¦æ¨¡ï¼ˆ100,000è¡Œï½ï¼‰ | 15åˆ†ï½1æ™‚é–“ | 3ï½10åˆ† |\n\n**æ³¨**: å®Ÿè¡Œæ™‚é–“ã¯ç‰¹å¾´é‡æ•°ãƒ»ãƒ¢ãƒ‡ãƒ«æ•°ã«ã‚‚ä¾å­˜ã—ã¾ã™ã€‚\n\n---\n\n**ã“ã®ã‚»ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€AIãŒè‡ªå‹•ã§å…¨ãƒ¢ãƒ‡ãƒ«ã‚’æ¯”è¼ƒã—ã¾ã™ï¼ˆç’°å¢ƒã«ã‚ˆã£ã¦æ•°åˆ†ï½åæ•°åˆ†ã‹ã‹ã‚Šã¾ã™ï¼‰ â†“**"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "if PYC_OK and len(feat) >= MIN_SAMPLES_PYCARET:    print(f'[INFO] PyCareté–‹å§‹: {len(feat)}è¡Œ (>= {MIN_SAMPLES_PYCARET}è¡Œ)')        # PyCaretã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”¨ãƒ‡ãƒ¼ã‚¿æº–å‚™    data = feat.drop(columns=['date','store_id'], errors='ignore').copy()        # æ¬ æå€¤ãŒå¤šã„åˆ—ã‚’å‰Šé™¤ï¼ˆ50%ä»¥ä¸Šæ¬ æï¼‰    missing_ratio = data.isnull().sum() / len(data)    drop_cols = missing_ratio[missing_ratio > 0.5].index.tolist()    if drop_cols:        print(f'[WARNING] æ¬ æå€¤50%è¶…ã®åˆ—ã‚’é™¤å¤–: {drop_cols}')        data = data.drop(columns=drop_cols)        print(f'[INFO] å­¦ç¿’ãƒ‡ãƒ¼ã‚¿: {data.shape} | ç›®çš„å¤‰æ•°: sales_amt')        # GPUè¨­å®šã®æº–å‚™    gpu_params = {}    if USE_GPU and GPU_AVAILABLE:        print('ğŸš€ [INFO] GPUä½¿ç”¨ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œï¼ˆLightGBM/XGBoost/CatBoostå¯¾å¿œï¼‰')        gpu_params = {            'lightgbm': {'device': 'gpu', 'gpu_platform_id': 0, 'gpu_device_id': 0},            'xgboost': {'tree_method': 'gpu_hist', 'gpu_id': 0},            'catboost': {'task_type': 'GPU', 'devices': '0'}        }    else:        print('â„¹ï¸ [INFO] CPUä½¿ç”¨ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ')        try:        # PyCaretã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—        _ = setup(            data=data,             target='sales_amt',             session_id=42,             fold=3,            verbose=False,            normalize=True,            transformation=True,            ignore_features=['sales_lag_1', 'sales_lag_7', 'sales_rolling_7']  # lagç‰¹å¾´é‡ã¯ãƒªãƒ¼ã‚¯ã®å¯èƒ½æ€§ã‚ã‚‹ãŸã‚é™¤å¤–ã‚‚æ¤œè¨        )                # ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒï¼ˆå…¨ãƒ¢ãƒ‡ãƒ«ã§å®Ÿè¡Œã€GPUå¯¾å¿œï¼‰        print('[INFO] ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒå®Ÿè¡Œä¸­ï¼ˆå…¨ãƒ¢ãƒ‡ãƒ«ï¼‰...')        print('[INFO] æ¯”è¼ƒå¯¾è±¡: PyCaretã®å…¨å›å¸°ãƒ¢ãƒ‡ãƒ«ï¼ˆ15ï½20ç¨®é¡ï¼‰')        if USE_GPU:            print('[INFO] âœ… GPUåŠ é€Ÿæœ‰åŠ¹ï¼ˆLightGBM/XGBoost/CatBoostï¼‰')        print('[INFO] â€» å®Ÿè¡Œã«æ•°åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™')                # GPUå¯¾å¿œãƒ¢ãƒ‡ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®š        import time        start_time = time.time()                best = compare_models(            sort='R2',            n_select=1        )                elapsed_time = time.time() - start_time                leaderboard = pull()        print('[SUCCESS] ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒå®Œäº†')        print(f'â±ï¸ å®Ÿè¡Œæ™‚é–“: {elapsed_time:.1f}ç§’')        if USE_GPU:            print('ğŸ’¡ GPUã«ã‚ˆã‚Šé«˜é€ŸåŒ–ã•ã‚Œã¾ã—ãŸ')        print(f'\\nğŸ“Š å…¨{len(leaderboard)}ãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒçµæœ:')        display(leaderboard)                # æœ€è‰¯ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒŠãƒ©ã‚¤ã‚ºï¼ˆGPUè¨­å®šã‚’é©ç”¨ï¼‰        if USE_GPU and type(best).__name__ in ['LGBMRegressor', 'XGBRegressor', 'CatBoostRegressor']:            model_name = type(best).__name__            print(f'ğŸš€ [INFO] {model_name}ã«GPUè¨­å®šã‚’é©ç”¨')            if 'LGBM' in model_name:                best.set_params(**gpu_params.get('lightgbm', {}))            elif 'XGB' in model_name:                best.set_params(**gpu_params.get('xgboost', {}))            elif 'CatBoost' in model_name:                best.set_params(**gpu_params.get('catboost', {}))                final = finalize_model(best)        print(f'\\n[INFO] æœ€è‰¯ãƒ¢ãƒ‡ãƒ«: {type(best).__name__}')        print(f'[INFO] R2ã‚¹ã‚³ã‚¢: {leaderboard.iloc[0][\"R2\"]:.4f}')        print(f'[INFO] RMSE: {leaderboard.iloc[0][\"RMSE\"]:.2f}')        print(f'[INFO] MAE: {leaderboard.iloc[0][\"MAE\"]:.2f}')                # å¯è¦–åŒ–        try:            print('\\n[INFO] ç‰¹å¾´é‡é‡è¦åº¦ãƒ—ãƒ­ãƒƒãƒˆ')            plot_model(final, plot='feature')        except Exception as e:            print(f'[WARNING] ç‰¹å¾´é‡ãƒ—ãƒ­ãƒƒãƒˆå¤±æ•—: {e}')                try:            print('\\n[INFO] æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆ')            plot_model(final, plot='residuals')        except Exception as e:            print(f'[WARNING] æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆå¤±æ•—: {e}')                except Exception as e:        print(f'[ERROR] PyCaretå®Ÿè¡Œå¤±æ•—')        print(f'  ã‚¨ãƒ©ãƒ¼å‹: {type(e).__name__}')        print(f'  è©³ç´°: {e}')        import traceback        traceback.print_exc()        elif PYC_OK:    print(f'[WARNING] ãƒ‡ãƒ¼ã‚¿ä¸è¶³ï¼ˆ{len(feat)}è¡Œ < {MIN_SAMPLES_PYCARET}è¡Œï¼‰ã€‚PyCaretã‚¹ã‚­ãƒƒãƒ—ã€‚')else:    print('[WARNING] PyCaretæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚ã‚¹ã‚­ãƒƒãƒ—ã€‚')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "79z9lrfba1r",
   "source": "## ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—5: çµæœã®è§£é‡ˆã¨å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³\n\n### ğŸ¯ **ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„**\n**ä¸Šã®PyCaretçµæœã‚’è¦‹ã¦ã€æ˜æ—¥ã‹ã‚‰ä½•ã‚’ã™ã¹ãã‹åˆ¤æ–­ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚**\n\n---\n\n## 1ï¸âƒ£ ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒè¡¨ï¼ˆLeaderboardï¼‰ã®èª­ã¿æ–¹\n\nä¸Šã®ã‚»ãƒ«ã§è¡¨ç¤ºã•ã‚ŒãŸè¡¨ã®è¦‹æ–¹ï¼š\n\n### ğŸ“ˆ **æœ€é‡è¦æŒ‡æ¨™: R2ï¼ˆæ±ºå®šä¿‚æ•°ï¼‰**\n\n| R2ã®å€¤ | æ„å‘³ | å®Ÿå‹™ã§ã®åˆ¤æ–­ |\n|--------|------|------------|\n| **0.8ä»¥ä¸Š** | éå¸¸ã«å„ªç§€ | âœ… ã“ã®ãƒ¢ãƒ‡ãƒ«ã§æ¥é€±ã®ç™ºæ³¨è¨ˆç”»ã‚’ç«‹ã¦ã¦OK |\n| **0.6ï½0.8** | ã¾ã‚ã¾ã‚ä½¿ãˆã‚‹ | âœ… è£œåŠ©çš„ã«ä½¿ç”¨ï¼ˆåº—é•·ã®çµŒé¨“ã¨ä½µç”¨ï¼‰ |\n| **0.5ï½0.6** | ã‚„ã‚„ä¸è¶³ | âš ï¸ ãƒ‡ãƒ¼ã‚¿æœŸé–“ã‚’å»¶é•·ã™ã‚‹ã‹ã€è¦å› ã‚’è¿½åŠ æ¤œè¨ |\n| **0.5æœªæº€** | äºˆæ¸¬ç²¾åº¦ä½ã„ | âŒ ãƒ—ãƒ­ãƒ¢æƒ…å ±ãƒ»ç«¶åˆæƒ…å ±ãªã©ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ã‚ã‚Š |\n\n---\n\n### ğŸ“Š **ãã®ä»–ã®æŒ‡æ¨™**\n\n| æŒ‡æ¨™ | æ„å‘³ | è¦‹æ–¹ |\n|------|------|------|\n| **MAE** | å¹³å‡çµ¶å¯¾èª¤å·® | ä¾‹: MAE=5000å†† â†’ ã€Œäºˆæ¸¬ãŒå¹³å‡5,000å††ã‚ºãƒ¬ã‚‹ã€ |\n| **RMSE** | äºŒä¹—å¹³å‡å¹³æ–¹æ ¹èª¤å·® | MAEã‚ˆã‚Šå¤§ãã„å¤–ã‚Œå€¤ã«æ•æ„Ÿã€‚MAEã¨è¿‘ã„å€¤ãªã‚‰OK |\n| **MAPE** | å¹³å‡çµ¶å¯¾ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆèª¤å·® | ä¾‹: MAPE=0.15 â†’ ã€Œäºˆæ¸¬ãŒå¹³å‡15%ã‚ºãƒ¬ã‚‹ã€ |\n\n**åˆ¤æ–­åŸºæº–**:\n```\nâœ… MAPE < 0.2 (20%æœªæº€) â†’ å®Ÿç”¨ãƒ¬ãƒ™ãƒ«\nâš ï¸ MAPE 0.2ï½0.3 â†’ å‚è€ƒç¨‹åº¦ã«ä½¿ã†\nâŒ MAPE > 0.3 â†’ ãƒ‡ãƒ¼ã‚¿è¿½åŠ ãŒå¿…è¦\n```\n\n---\n\n### ğŸ† **æœ€è‰¯ãƒ¢ãƒ‡ãƒ«ã®ç¢ºèª**\n\nä¸Šã®ã‚»ãƒ«ã®æœ€å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹ï¼š\n```\n[INFO] æœ€è‰¯ãƒ¢ãƒ‡ãƒ«: GradientBoostingRegressor\n```\n\n**å„ãƒ¢ãƒ‡ãƒ«ã®ç‰¹å¾´**:\n\n| ãƒ¢ãƒ‡ãƒ«å | ç‰¹å¾´ | å‘ã„ã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ |\n|----------|------|------------------|\n| **GradientBoostingRegressor (gbr)** | é«˜ç²¾åº¦ã€è¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³å¯¾å¿œ | å£²ä¸ŠãŒå¤©å€™ãƒ»æ›œæ—¥ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã§è¤‡é›‘ã«å¤‰åŒ– |\n| **RandomForestRegressor (rf)** | å®‰å®šæ€§ãŒé«˜ã„ | ãƒ‡ãƒ¼ã‚¿ã«ãƒã‚¤ã‚ºãŒå¤šã„ |\n| **LinearRegression (lr)** | ã‚·ãƒ³ãƒ—ãƒ«ã€è§£é‡ˆã—ã‚„ã™ã„ | å£²ä¸ŠãŒå˜ç´”ãªè¦å› ã§æ±ºã¾ã‚‹ï¼ˆæ°—æ¸©ã ã‘ç­‰ï¼‰ |\n| **DecisionTree (dt)** | ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ | ã€Œæ°—æ¸©30åº¦ä»¥ä¸Šãªã‚‰å†·é£²æ–™ãŒå£²ã‚Œã‚‹ã€ç­‰ã®æ˜ç¢ºãªãƒ«ãƒ¼ãƒ« |\n\n**å®Ÿå‹™ã§ã®åˆ¤æ–­**:\n- **gbr/rf ãŒä¸Šä½** â†’ å£²ä¸ŠãŒè¤‡é›‘ãªè¦å› ã§æ±ºã¾ã‚‹ â†’ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆç‰¹å¾´é‡é‡è¦åº¦ï¼‰ã§ä¸»è¦å› ã‚’ç‰¹å®š\n- **lr ãŒä¸Šä½** â†’ å£²ä¸ŠãŒã‚·ãƒ³ãƒ—ãƒ«ãªè¦å› ã§æ±ºã¾ã‚‹ â†’ 1ã€œ2å€‹ã®ä¸»è¦å› ã«é›†ä¸­å¯¾ç­–\n\n---\n\n## 2ï¸âƒ£ ç‰¹å¾´é‡é‡è¦åº¦ã‚°ãƒ©ãƒ•ã®èª­ã¿æ–¹\n\nä¸Šã®ã‚»ãƒ«ã§è¡¨ç¤ºã•ã‚Œã‚‹æ£’ã‚°ãƒ©ãƒ•ã€ŒFeature Importanceã€:\n\n### ğŸ“Š **é‡è¦åº¦ã®æ„å‘³**\n\n| é‡è¦åº¦ | æ„å‘³ | å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |\n|--------|------|----------------|\n| **30%ä»¥ä¸Š** | è¶…é‡è¦ï¼ˆå£²ä¸Šã®ä¸»è¦å› ï¼‰ | ğŸ”´ **æ¯æ—¥ãƒã‚§ãƒƒã‚¯å¿…é ˆ** |\n| **15ï½30%** | é‡è¦ | ğŸŸ¡ **é€±1å›ãƒã‚§ãƒƒã‚¯** |\n| **5ï½15%** | ã‚„ã‚„é‡è¦ | ğŸŸ¢ **æœˆ1å›ãƒã‚§ãƒƒã‚¯** |\n| **5%æœªæº€** | å‚è€ƒç¨‹åº¦ | âšª æ°—ã«ã—ãªãã¦OK |\n\n---\n\n### ğŸ’¡ **è¦å› åˆ¥ã®å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¾‹**\n\nå®Ÿè¡Œçµæœã«å‡ºã¦ãã‚‹ä¸»ãªè¦å› ã¨ã€ãã®å¯¾å¿œæ–¹æ³•ï¼š\n\n#### **ğŸŒ¡ï¸ æ°—æ¸©ç³»ï¼ˆå¹³å‡æ°—æ¸©ã€æœ€é«˜æ°—æ¸©ã€æ°—æ¸©å·®ï¼‰ãŒä¸Šä½**\n\n**æ„å‘³**: æ°—æ¸©ãŒå£²ä¸Šã®ä¸»è¦å› \n\n**æ˜æ—¥ã‹ã‚‰ã‚„ã‚‹ã¹ãã“ã¨**:\n1. **æ¯é€±æœˆæ›œ**ã«é€±é–“å¤©æ°—äºˆå ±ã‚’ãƒã‚§ãƒƒã‚¯\n2. **æ°—æ¸©30åº¦ä»¥ä¸Šã®äºˆå ±**\n   - å†·ãŸã„é£²æ–™ï¼šé€šå¸¸ã®1.5å€ç™ºæ³¨\n   - ã‚¢ã‚¤ã‚¹ãƒ»ãƒãƒ«ãƒ‰ãƒ‡ã‚¶ãƒ¼ãƒˆï¼šãƒ•ã‚§ãƒ¼ã‚¹å¢—\n   - å†·ã‚±ãƒ¼ã‚¹å‰ã®å°ç·šç¢ºä¿\n3. **æ°—æ¸©15åº¦ä»¥ä¸‹ã®äºˆå ±**\n   - ãŠã§ã‚“ãƒ»ä¸­è¯ã¾ã‚“ï¼šãƒ•ã‚§ãƒ¼ã‚¹å¢—\n   - ãƒ›ãƒƒãƒˆé£²æ–™ï¼šãƒ¬ã‚¸æ¨ªã«é™³åˆ—\n   - æ¸©ã‹ã„ç·èœï¼šæ‰‹å‰é™³åˆ—\n\n---\n\n#### **ğŸ—“ï¸ æ›œæ—¥ç³»ï¼ˆé€±æœ«ãƒ•ãƒ©ã‚°ã€åœŸæ›œãƒ•ãƒ©ã‚°ã€æ—¥æ›œãƒ•ãƒ©ã‚°ï¼‰ãŒä¸Šä½**\n\n**æ„å‘³**: æ›œæ—¥ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå£²ä¸Šã®ä¸»è¦å› \n\n**æ˜æ—¥ã‹ã‚‰ã‚„ã‚‹ã¹ãã“ã¨**:\n1. **æœ¨æ›œå¤•æ–¹**ã«é€±æœ«å‘ã‘ç™ºæ³¨ã‚’ç¢ºå®š\n2. **é‡‘æ›œã®æœ**ã«é€±æœ«å‘ã‘å•†å“ã‚’å‰å‡ºã—\n3. **é€±æœ«ã«å£²ã‚Œã‚‹ã‚«ãƒ†ã‚´ãƒª**ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã€Œææ¡ˆãƒ“ãƒ¥ãƒ¼ã€ã§ç¢ºèªï¼‰:\n   - å¼å½“ãƒ»ç·èœï¼šãƒ•ã‚§ãƒ¼ã‚¹1.5å€\n   - ãƒ‡ã‚¶ãƒ¼ãƒˆãƒ»ã‚¹ã‚¤ãƒ¼ãƒ„ï¼šå°ç·šå¼·åŒ–\n   - éººé¡ï¼šæ‰‹å‰é™³åˆ—\n\n---\n\n#### **â˜” é™é›¨ãƒ•ãƒ©ã‚°ãŒä¸Šä½**\n\n**æ„å‘³**: é›¨ã®æ—¥ã®å£²ä¸Šå¤‰åŒ–ãŒå¤§ãã„\n\n**æ˜æ—¥ã‹ã‚‰ã‚„ã‚‹ã¹ãã“ã¨**:\n1. **æ¯æœã®å¤©æ°—äºˆå ±**ã§é™é›¨ç¢ºç‡ã‚’ãƒã‚§ãƒƒã‚¯\n2. **é™é›¨ç¢ºç‡50%ä»¥ä¸Š**ã®å ´åˆ:\n   - æ¸©ã‹ã„ç·èœï¼šå‰å‡ºã—å¼·åŒ–\n   - ã‚«ãƒƒãƒ—éººãƒ»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ãƒˆé£Ÿå“ï¼šæ‰‹å‰é™³åˆ—\n   - ãƒ›ãƒƒãƒˆé£²æ–™ï¼šãƒ¬ã‚¸æ¨ªã«é…ç½®\n   - ä¸­è¯ã¾ã‚“ãƒ»ãŠã§ã‚“ï¼šå…¥å£è¿‘ãã«\n\n---\n\n#### **ğŸ’° çµ¦æ–™æ—¥ã€çµ¦æ–™æ—¥ç›´å¾ŒãŒä¸Šä½**\n\n**æ„å‘³**: çµ¦æ–™æ—¥ã§è³¼è²·è¡Œå‹•ãŒå¤‰ã‚ã‚‹\n\n**æ˜æ—¥ã‹ã‚‰ã‚„ã‚‹ã¹ãã“ã¨**:\n1. **æ¯æœˆ25æ—¥å‰å¾Œ**ï¼ˆä¸€èˆ¬çš„ãªçµ¦æ–™æ—¥ï¼‰:\n   - é«˜å˜ä¾¡å¼å½“ãƒ»ã‚¹ã‚¤ãƒ¼ãƒ„ï¼šåšã‚é™³åˆ—\n   - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å•†å“ï¼šç›®ç«‹ã¤ä½ç½®ã«\n2. **æœˆåˆ3æ—¥**:\n   - å®šç•ªå“ã®åœ¨åº«ç¢ºä¿ï¼ˆè²·ã„ã ã‚éœ€è¦ï¼‰\n3. **æœˆæœ«3æ—¥**:\n   - å€¤é ƒå“ãƒ»ç¯€ç´„è¨´æ±‚ï¼ˆä¾¡æ ¼ãƒãƒƒãƒ—å¼·åŒ–ï¼‰\n\n---\n\n#### **ğŸ“… å­£ç¯€å¤‰å‹•æŒ‡æ•°ï¼ˆæœˆ/é€±ï¼‰ãŒä¸Šä½**\n\n**æ„å‘³**: å­£ç¯€ãƒˆãƒ¬ãƒ³ãƒ‰ãŒå¼·ã„\n\n**æ˜æ—¥ã‹ã‚‰ã‚„ã‚‹ã¹ãã“ã¨**:\n1. **æ¯æœˆåˆ**ã«å…ˆæœˆå¯¾æ¯”ã‚’ãƒã‚§ãƒƒã‚¯\n2. **ä¸Šæ˜‡ãƒˆãƒ¬ãƒ³ãƒ‰**ãªã‚‰ä¸»åŠ›å“ã®ç™ºæ³¨ã‚’10%å¢—\n3. **ä¸‹é™ãƒˆãƒ¬ãƒ³ãƒ‰**ãªã‚‰è¦‹åˆ‡ã‚Šã‚’æ—©ã‚ã«åˆ¤æ–­\n\n---\n\n## 3ï¸âƒ£ æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆï¼ˆResidualsï¼‰ã®èª­ã¿æ–¹\n\nç‰¹å¾´é‡é‡è¦åº¦ã®æ¬¡ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•:\n\n### ğŸ“Š **è¦‹ã‚‹ã¹ããƒã‚¤ãƒ³ãƒˆ**\n\n| ãƒ‘ã‚¿ãƒ¼ãƒ³ | æ„å‘³ | å®Ÿå‹™ã§ã®åˆ¤æ–­ |\n|----------|------|------------|\n| **ç‚¹ãŒãƒ©ãƒ³ãƒ€ãƒ ã«æ•£ã‚‰ã°ã£ã¦ã„ã‚‹** | âœ… ãƒ¢ãƒ‡ãƒ«ãŒæ­£ã—ãæ©Ÿèƒ½ | ã“ã®ãƒ¢ãƒ‡ãƒ«ã§äºˆæ¸¬ã—ã¦OK |\n| **å³ä¸ŠãŒã‚Š/å³ä¸‹ãŒã‚Šã®ç·šãŒè¦‹ãˆã‚‹** | âš ï¸ ãƒ¢ãƒ‡ãƒ«ã«æ”¹å–„ä½™åœ°ã‚ã‚Š | ã‚ˆã‚Šé«˜åº¦ãªãƒ¢ãƒ‡ãƒ«ãŒå¿…è¦ï¼ˆè¦ç›¸è«‡ï¼‰ |\n| **ä¸€éƒ¨ã«æ¥µç«¯ãªå¤–ã‚Œå€¤** | âš ï¸ ç•°å¸¸æ—¥ã‚’æ¤œå‡º | ãã®æ—¥ã®å£²ä¸Šã‚’å€‹åˆ¥èª¿æŸ» |\n\n**å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:\n- ãƒ©ãƒ³ãƒ€ãƒ åˆ†å¸ƒ â†’ AIã®äºˆæ¸¬ã‚’ä¿¡é ¼ã—ã¦OK\n- ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚ã‚Š â†’ ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã«ç›¸è«‡\n- å¤–ã‚Œå€¤ â†’ ã€Œã‚»ãƒ¼ãƒ«æ—¥ã€ã€Œç«¶åˆåº—é–‹åº—æ—¥ã€ãªã©ã‚’è¨˜éŒ²\n\n---\n\n## 4ï¸âƒ£ ä»Šæ—¥ã‹ã‚‰å§‹ã‚ã‚‹3ã‚¹ãƒ†ãƒƒãƒ—\n\n### ğŸ“ **ã‚¹ãƒ†ãƒƒãƒ—1: ä»Šæ—¥ã®é‡è¦åº¦ãƒˆãƒƒãƒ—3ã‚’ç¢ºèª**\n\nä¸Šã®ã€ŒFeature Importanceã€ã‚°ãƒ©ãƒ•ã§ï¼š\n1. 1ä½ã®è¦å› ã¯ï¼Ÿ â†’ æ¯æ—¥ãƒã‚§ãƒƒã‚¯ã™ã‚‹\n2. 2ä½ã®è¦å› ã¯ï¼Ÿ â†’ é€±1å›ãƒã‚§ãƒƒã‚¯ã™ã‚‹\n3. 3ä½ã®è¦å› ã¯ï¼Ÿ â†’ æœˆ1å›ãƒã‚§ãƒƒã‚¯ã™ã‚‹\n\n**ä¾‹**:\n```\n1ä½: å¹³å‡æ°—æ¸©_MA7 (35%) â†’ æ¯é€±æœˆæ›œã«é€±é–“å¤©æ°—äºˆå ±\n2ä½: é€±æœ«ãƒ•ãƒ©ã‚° (22%) â†’ æœ¨æ›œã«é€±æœ«ç™ºæ³¨ç¢ºå®š\n3ä½: é™é›¨ãƒ•ãƒ©ã‚° (18%) â†’ æ¯æœã®å¤©æ°—äºˆå ±ã§é™é›¨ç¢ºç‡ãƒã‚§ãƒƒã‚¯\n```\n\n---\n\n### ğŸ“ **ã‚¹ãƒ†ãƒƒãƒ—2: ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ä½œã‚‹**\n\n| æ›œæ—¥ | ã‚„ã‚‹ã“ã¨ | ç¢ºèªã™ã‚‹è¦å›  |\n|------|----------|------------|\n| **æ¯æœ** | å¤©æ°—äºˆå ±ãƒã‚§ãƒƒã‚¯ | é™é›¨ãƒ•ãƒ©ã‚°ã€æ°—æ¸© |\n| **æœˆæ›œ** | é€±é–“å¤©æ°—äºˆå ±ãƒã‚§ãƒƒã‚¯ | å¹³å‡æ°—æ¸©_MA7 |\n| **æœ¨æ›œå¤•** | é€±æœ«ç™ºæ³¨ç¢ºå®š | é€±æœ«ãƒ•ãƒ©ã‚° |\n| **æœˆåˆ1æ—¥** | å­£ç¯€ãƒˆãƒ¬ãƒ³ãƒ‰ç¢ºèª | å­£ç¯€å¤‰å‹•æŒ‡æ•°_æœˆ |\n| **25æ—¥å‰å¾Œ** | çµ¦æ–™æ—¥å¯¾å¿œ | çµ¦æ–™æ—¥ãƒ•ãƒ©ã‚° |\n\n---\n\n### ğŸ“ **ã‚¹ãƒ†ãƒƒãƒ—3: 1é€±é–“è©¦ã—ã¦ã€åŠ¹æœã‚’æ¸¬å®š**\n\n**è©¦ã™å†…å®¹**:\n- é‡è¦åº¦ãƒˆãƒƒãƒ—3ã®è¦å› ã‚’æ¯æ—¥ãƒã‚§ãƒƒã‚¯\n- ãã®è¦å› ã«å¿œã˜ã¦é™³åˆ—ãƒ»ç™ºæ³¨ã‚’èª¿æ•´\n\n**åŠ¹æœæ¸¬å®š**ï¼ˆ1é€±é–“å¾Œï¼‰:\n```\nâ–¡ å£²ä¸ŠãŒå‰é€±æ¯”ã§ä¸ŠãŒã£ãŸã‹ï¼Ÿ\nâ–¡ æ¬ å“ãŒæ¸›ã£ãŸã‹ï¼Ÿ\nâ–¡ å»ƒæ£„ãŒæ¸›ã£ãŸã‹ï¼Ÿ\n```\n\n**åŠ¹æœãŒã‚ã‚Œã°** â†’ ãšã£ã¨ç¶šã‘ã‚‹  \n**åŠ¹æœãŒãªã‘ã‚Œã°** â†’ ãƒ‡ãƒ¼ã‚¿æœŸé–“ã‚’å»¶é•·ï¼ˆ3ãƒ¶æœˆâ†’6ãƒ¶æœˆï¼‰ã—ã¦å†åˆ†æ\n\n---\n\n## ğŸ“Œ ã¾ã¨ã‚: AIã®çµæœã‚’ã“ã†ä½¿ã†\n\n| è¦‹ã‚‹ã‚‚ã® | ä½•ã‚’ç¢ºèªï¼Ÿ | å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ |\n|----------|-----------|----------------|\n| **Leaderboard** | R2ãŒ0.8ä»¥ä¸Šã‹ï¼Ÿ | 0.8ä»¥ä¸Šãªã‚‰äºˆæ¸¬ã‚’ä¿¡é ¼ |\n| **Feature Importance** | é‡è¦åº¦ãƒˆãƒƒãƒ—3ã¯ï¼Ÿ | ãã®3ã¤ã‚’æ¯æ—¥/é€±/æœˆãƒã‚§ãƒƒã‚¯ |\n| **Residuals** | ãƒ©ãƒ³ãƒ€ãƒ åˆ†å¸ƒã‹ï¼Ÿ | ãƒ©ãƒ³ãƒ€ãƒ ãªã‚‰ãƒ¢ãƒ‡ãƒ«OK |\n\n**æœ€é‡è¦ãƒã‚¤ãƒ³ãƒˆ**:\n> ã€Œé‡è¦åº¦ãƒˆãƒƒãƒ—3ã€ã‚’æ¯æ—¥ãƒã‚§ãƒƒã‚¯ã™ã‚‹ç¿’æ…£ã‚’ã¤ã‘ã‚‹ã ã‘ã§ã€å£²ä¸Šã¯ç¢ºå®Ÿã«æ”¹å–„ã—ã¾ã™ã€‚\n\n**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**:\n- ã“ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’æ¯æœˆ1å›å®Ÿè¡Œã—ã¦ã€é‡è¦åº¦ã®å¤‰åŒ–ã‚’è¿½è·¡\n- å­£ç¯€ï¼ˆå¤/å†¬ï¼‰ã§é‡è¦åº¦ãŒå¤‰ã‚ã‚‹ã®ã§ã€3ãƒ¶æœˆã”ã¨ã«è¦‹ç›´ã—\n\n---\n\n**ä»¥ä¸Šã§ã€AIã«ã‚ˆã‚‹å£²ä¸Šåˆ†æã¯å®Œäº†ã§ã™ï¼**",
   "metadata": {}
  },
  {
   "cell_type": "markdown",
   "id": "2br5d2hc0od",
   "source": "## ğŸ“¦ ã‚¹ãƒ†ãƒƒãƒ—6: 1é€±é–“å…ˆã®ç™ºæ³¨æ•°é‡äºˆæ¸¬ï¼ˆå…¨å•†å“ï¼‰\n\n### ğŸ¯ **ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„**\n**å­¦ç¿’ã—ãŸAIãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ã€2025å¹´10æœˆ15æ—¥ã‹ã‚‰1é€±é–“åˆ†ã®å…¨å•†å“ã®è²©å£²æ•°é‡ã‚’äºˆæ¸¬ã—ã€ç™ºæ³¨æ•°é‡ã‚’è‡ªå‹•è¨ˆç®—ã—ã¾ã™ã€‚**\n\n---\n\n### ğŸ“‹ **äºˆæ¸¬ã®æµã‚Œ**\n\n1. **å¤–éƒ¨è¦å› ã®å…¥åŠ›** â†’ 1é€±é–“åˆ†ã®å¤©æ°—äºˆå ±ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æƒ…å ±ã‚’å…¥åŠ›\n2. **AIãŒäºˆæ¸¬** â†’ å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã§å•†å“Ã—æ—¥ä»˜ã”ã¨ã«è²©å£²æ•°é‡ã‚’äºˆæ¸¬\n3. **ç™ºæ³¨æ•°é‡ã®è¨ˆç®—** â†’ äºˆæ¸¬å€¤ Ã— å®‰å…¨ä¿‚æ•°ã§ç™ºæ³¨æ•°é‡ã‚’ç®—å‡º\n4. **CSVå‡ºåŠ›** â†’ ç™ºæ³¨è¡¨ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜\n\n---\n\n### ğŸ‘€ **åº—é•·ãŒå…¥åŠ›ã™ã¹ãæƒ…å ±**\n\næ¬¡ã®ã‚»ãƒ«ã§ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š\n\n| é …ç›® | å…¥åŠ›ä¾‹ | èª¬æ˜ |\n|------|--------|------|\n| **äºˆæ¸¬é–‹å§‹æ—¥** | `2025-10-15` | ç™ºæ³¨ã‚’é–‹å§‹ã™ã‚‹æ—¥ |\n| **äºˆæ¸¬æ—¥æ•°** | `7` | ä½•æ—¥åˆ†äºˆæ¸¬ã™ã‚‹ã‹ï¼ˆé€šå¸¸ã¯7æ—¥ï¼‰ |\n| **å¤©æ°—äºˆå ±** | `['æ™´ã‚Œ', 'æ›‡ã‚Š', 'é›¨', ...]` | 1é€±é–“åˆ†ã®å¤©æ°—äºˆå ± |\n| **å¹³å‡æ°—æ¸©** | `[22, 23, 20, 18, ...]` | 1é€±é–“åˆ†ã®äºˆæ¸¬æ°—æ¸©ï¼ˆâ„ƒï¼‰ |\n| **é™æ°´ç¢ºç‡** | `[10, 30, 70, ...]` | 1é€±é–“åˆ†ã®é™æ°´ç¢ºç‡ï¼ˆ%ï¼‰ |\n| **å®‰å…¨ä¿‚æ•°** | `1.2` | æ¬ å“é˜²æ­¢ã®ãŸã‚ã®ä½™è£•ç‡ï¼ˆé€šå¸¸1.1ï½1.3ï¼‰ |\n\n**å®‰å…¨ä¿‚æ•°ã®ç›®å®‰**:\n- `1.0` â†’ äºˆæ¸¬å€¤ãã®ã¾ã¾ï¼ˆãƒªã‚¹ã‚¯é«˜ï¼‰\n- `1.1ï½1.2` â†’ é€šå¸¸ã®é‹ç”¨ï¼ˆæ¨å¥¨ï¼‰\n- `1.3ï½1.5` â†’ æ¬ å“ã‚’çµ¶å¯¾ã«é¿ã‘ãŸã„ï¼ˆå»ƒæ£„ãƒªã‚¹ã‚¯å¢—ï¼‰\n\n---\n\n**æ¬¡ã®ã‚»ãƒ«ã§å¤–éƒ¨è¦å› ã‚’å…¥åŠ›ã—ã€äºˆæ¸¬ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ â†“**",
   "metadata": {}
  },
  {
   "cell_type": "code",
   "id": "rbi69vvi24",
   "source": "# ========================================\n# ğŸ“… Step 6-1: å¤–éƒ¨è¦å› ã®å…¥åŠ›ï¼ˆå¤©æ°—äºˆå ±ãƒ»ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æƒ…å ±ï¼‰\n# ========================================\n\n# äºˆæ¸¬æœŸé–“ã®è¨­å®š\nFORECAST_START_DATE = '2025-10-15'  # äºˆæ¸¬é–‹å§‹æ—¥\nFORECAST_DAYS = 7  # äºˆæ¸¬æ—¥æ•°ï¼ˆ1é€±é–“ï¼‰\n\n# ğŸŒ¤ï¸ å¤©æ°—äºˆå ±ï¼ˆ1é€±é–“åˆ†ï¼‰\n# æ³¨: å®Ÿéš›ã®å¤©æ°—äºˆå ±ã‚µã‚¤ãƒˆã‹ã‚‰å–å¾—ã—ãŸæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\nWEATHER_FORECAST = [\n    # 10/15(æ°´), 10/16(æœ¨), 10/17(é‡‘), 10/18(åœŸ), 10/19(æ—¥), 10/20(æœˆ), 10/21(ç«)\n    'æ™´ã‚Œ',    'æ™´ã‚Œ',    'æ›‡ã‚Š',    'æ™´ã‚Œ',    'é›¨',      'æ›‡ã‚Š',    'æ™´ã‚Œ'\n]\n\n# ğŸŒ¡ï¸ å¹³å‡æ°—æ¸©äºˆå ±ï¼ˆ1é€±é–“åˆ†ã€å˜ä½: â„ƒï¼‰\nTEMP_FORECAST = [\n    22,        23,        20,        21,        18,        19,        22\n]\n\n# ğŸŒ§ï¸ é™æ°´ç¢ºç‡ï¼ˆ1é€±é–“åˆ†ã€å˜ä½: %ï¼‰\nPRECIP_FORECAST = [\n    10,        10,        30,        10,        70,        40,        10\n]\n\n# ğŸ”¢ å®‰å…¨ä¿‚æ•°ï¼ˆæ¬ å“é˜²æ­¢ã®ãŸã‚ã®ä½™è£•ç‡ï¼‰\nSAFETY_FACTOR = 1.2  # 1.0ï½1.5 ã®ç¯„å›²ã§è¨­å®šï¼ˆæ¨å¥¨: 1.1ï½1.2ï¼‰\n\n# ========================================\n# äºˆæ¸¬æœŸé–“ã®æ—¥ä»˜ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆ\n# ========================================\nforecast_dates = pd.date_range(start=FORECAST_START_DATE, periods=FORECAST_DAYS, freq='D')\n\nprint('='*60)\nprint('ğŸ“… äºˆæ¸¬æœŸé–“è¨­å®š')\nprint('='*60)\nprint(f'é–‹å§‹æ—¥: {FORECAST_START_DATE}')\nprint(f'äºˆæ¸¬æ—¥æ•°: {FORECAST_DAYS}æ—¥')\nprint(f'å®‰å…¨ä¿‚æ•°: {SAFETY_FACTOR}')\nprint(f'\\näºˆæ¸¬å¯¾è±¡æ—¥:')\nfor i, date in enumerate(forecast_dates):\n    weather = WEATHER_FORECAST[i] if i < len(WEATHER_FORECAST) else 'ä¸æ˜'\n    temp = TEMP_FORECAST[i] if i < len(TEMP_FORECAST) else 'N/A'\n    precip = PRECIP_FORECAST[i] if i < len(PRECIP_FORECAST) else 'N/A'\n    print(f'  {date.strftime(\"%Y-%m-%d (%a)\")}: å¤©æ°—={weather}, æ°—æ¸©={temp}â„ƒ, é™æ°´ç¢ºç‡={precip}%')\n\n# ========================================\n# å¤–éƒ¨è¦å› ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ§‹ç¯‰\n# ========================================\n# å„æ—¥ä»˜ã®ç‰¹å¾´é‡ã‚’è¨ˆç®—\nforecast_features = []\nfor i, date in enumerate(forecast_dates):\n    # åŸºæœ¬æƒ…å ±\n    features = {\n        'date': date,\n        'å¹´': date.year,\n        'æœˆ': date.month,\n        'æ—¥': date.day,\n        'æ›œæ—¥': date.dayofweek,  # 0=æœˆæ›œ, 6=æ—¥æ›œ\n        'é€±ç•ªå·': date.isocalendar()[1],\n    }\n    \n    # æ›œæ—¥ãƒ•ãƒ©ã‚°\n    features['åœŸæ›œãƒ•ãƒ©ã‚°'] = 1 if date.dayofweek == 5 else 0\n    features['æ—¥æ›œãƒ•ãƒ©ã‚°'] = 1 if date.dayofweek == 6 else 0\n    features['é€±æœ«ãƒ•ãƒ©ã‚°'] = 1 if date.dayofweek >= 5 else 0\n    features['å¹³æ—¥ãƒ•ãƒ©ã‚°'] = 1 if date.dayofweek < 5 else 0\n    \n    # ç¥æ—¥ãƒ•ãƒ©ã‚°ï¼ˆç°¡æ˜“å®Ÿè£…: æ—¥æœ¬ã®ä¸»è¦ç¥æ—¥ï¼‰\n    # å®Ÿéš›ã«ã¯ jpholiday ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨\n    import datetime\n    year = date.year\n    holidays = [\n        datetime.date(year, 1, 1),   # å…ƒæ—¥\n        datetime.date(year, 2, 11),  # å»ºå›½è¨˜å¿µæ—¥\n        datetime.date(year, 3, 20),  # æ˜¥åˆ†ã®æ—¥ï¼ˆæ¦‚ç®—ï¼‰\n        datetime.date(year, 4, 29),  # æ˜­å’Œã®æ—¥\n        datetime.date(year, 5, 3),   # æ†²æ³•è¨˜å¿µæ—¥\n        datetime.date(year, 5, 4),   # ã¿ã©ã‚Šã®æ—¥\n        datetime.date(year, 5, 5),   # ã“ã©ã‚‚ã®æ—¥\n        datetime.date(year, 7, 15),  # æµ·ã®æ—¥ï¼ˆæ¦‚ç®—ï¼‰\n        datetime.date(year, 8, 11),  # å±±ã®æ—¥\n        datetime.date(year, 9, 16),  # æ•¬è€ã®æ—¥ï¼ˆæ¦‚ç®—ï¼‰\n        datetime.date(year, 9, 23),  # ç§‹åˆ†ã®æ—¥ï¼ˆæ¦‚ç®—ï¼‰\n        datetime.date(year, 10, 14), # ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥ï¼ˆæ¦‚ç®—ï¼‰\n        datetime.date(year, 11, 3),  # æ–‡åŒ–ã®æ—¥\n        datetime.date(year, 11, 23), # å‹¤åŠ´æ„Ÿè¬ã®æ—¥\n    ]\n    features['ç¥æ—¥ãƒ•ãƒ©ã‚°'] = 1 if date.date() in holidays else 0\n    features['ä¼‘æ—¥ãƒ•ãƒ©ã‚°'] = 1 if (features['é€±æœ«ãƒ•ãƒ©ã‚°'] == 1 or features['ç¥æ—¥ãƒ•ãƒ©ã‚°'] == 1) else 0\n    \n    # å¤©æ°—ãƒ»æ°—æ¸©æƒ…å ±\n    weather = WEATHER_FORECAST[i] if i < len(WEATHER_FORECAST) else 'æ™´ã‚Œ'\n    temp = TEMP_FORECAST[i] if i < len(TEMP_FORECAST) else 20\n    precip = PRECIP_FORECAST[i] if i < len(PRECIP_FORECAST) else 0\n    \n    features['å¤©æ°—'] = weather\n    features['å¹³å‡æ°—æ¸©'] = temp\n    features['é™æ°´é‡'] = precip * 0.5 if precip > 0 else 0  # é™æ°´ç¢ºç‡ã‹ã‚‰æ¦‚ç®—\n    features['é™é›¨ãƒ•ãƒ©ã‚°'] = 1 if precip >= 50 else 0\n    features['å¼±é›¨'] = 1 if 30 <= precip < 50 else 0\n    features['æ™®é€šé›¨'] = 1 if 50 <= precip < 70 else 0\n    features['å¼·é›¨'] = 1 if precip >= 70 else 0\n    \n    # æ°—æ¸©ã‚«ãƒ†ã‚´ãƒª\n    features['çŒ›æš‘æ—¥'] = 1 if temp >= 35 else 0\n    features['çœŸå¤æ—¥'] = 1 if 30 <= temp < 35 else 0\n    features['å¤æ—¥'] = 1 if 25 <= temp < 30 else 0\n    features['å†¬æ—¥'] = 1 if temp < 0 else 0\n    features['çœŸå†¬æ—¥'] = 1 if temp < -5 else 0\n    \n    # çµ¦æ–™æ—¥ãƒ•ãƒ©ã‚°ï¼ˆ25æ—¥å‰å¾Œï¼‰\n    features['çµ¦æ–™æ—¥'] = 1 if date.day == 25 else 0\n    features['çµ¦æ–™æ—¥ç›´å¾Œ'] = 1 if 26 <= date.day <= 28 else 0\n    \n    # æœˆåˆãƒ»æœˆæœ«ãƒ•ãƒ©ã‚°\n    features['æœˆåˆ'] = 1 if date.day <= 5 else 0\n    features['æœˆåˆ3æ—¥'] = 1 if date.day <= 3 else 0\n    features['æœˆæœ«3æ—¥'] = 1 if date.day >= 28 else 0  # ç°¡æ˜“å®Ÿè£…\n    features['æœˆæœ«'] = 1 if date.day >= 25 else 0\n    \n    forecast_features.append(features)\n\n# DataFrameã«å¤‰æ›\nforecast_df = pd.DataFrame(forecast_features)\n\nprint(f'\\nâœ… å¤–éƒ¨è¦å› ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆå®Œäº†: {forecast_df.shape}')\ndisplay(forecast_df.head(10))",
   "metadata": {},
   "execution_count": null,
   "outputs": []
  },
  {
   "cell_type": "code",
   "id": "2qr8mow022t",
   "source": "# ========================================\n# ğŸ“¦ Step 6-2: å…¨å•†å“Ã—å…¨æ—¥ä»˜ã®äºˆæ¸¬å®Ÿè¡Œ\n# ========================================\n\nif not PYC_OK or 'final' not in globals():\n    print('[ERROR] PyCaretãƒ¢ãƒ‡ãƒ«ãŒå­¦ç¿’ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚')\n    print('å…ˆã«ã‚¹ãƒ†ãƒƒãƒ—4ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚')\nelse:\n    print('='*60)\n    print('ğŸ¤– AIäºˆæ¸¬å®Ÿè¡Œä¸­...')\n    print('='*60)\n    \n    # å•†å“ãƒªã‚¹ãƒˆå–å¾—ï¼ˆéå»ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ï¼‰\n    if 'sku_id' in df.columns:\n        sku_list = df['sku_id'].dropna().unique().tolist()\n    else:\n        print('[ERROR] sku_idåˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚')\n        sku_list = []\n    \n    # åº—èˆ—ãƒªã‚¹ãƒˆå–å¾—\n    if 'store_id' in df.columns:\n        store_list = df['store_id'].dropna().unique().tolist()\n    else:\n        print('[WARNING] store_idåˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåº—èˆ—ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚')\n        store_list = ['default_store']\n    \n    print(f'\\nğŸ“Š äºˆæ¸¬å¯¾è±¡:')\n    print(f'  å•†å“æ•°: {len(sku_list)} SKU')\n    print(f'  åº—èˆ—æ•°: {len(store_list)} åº—èˆ—')\n    print(f'  æ—¥æ•°: {FORECAST_DAYS} æ—¥')\n    print(f'  åˆè¨ˆäºˆæ¸¬ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: {len(sku_list) * len(store_list) * FORECAST_DAYS:,} ä»¶')\n    \n    # å…¨å•†å“Ã—å…¨åº—èˆ—Ã—å…¨æ—¥ä»˜ã®çµ„ã¿åˆã‚ã›ã‚’ä½œæˆ\n    all_predictions = []\n    \n    # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤ºç”¨\n    total_combinations = len(sku_list) * len(store_list) * FORECAST_DAYS\n    processed = 0\n    \n    for store in store_list:\n        for sku in sku_list:\n            # å„æ—¥ä»˜ã”ã¨ã«äºˆæ¸¬\n            for idx, row in forecast_df.iterrows():\n                # äºˆæ¸¬ç”¨ã®ç‰¹å¾´é‡ã‚’æº–å‚™\n                pred_features = row.to_dict()\n                pred_features['store_id'] = store\n                pred_features['sku_id'] = sku\n                \n                # å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨åŒã˜ç‰¹å¾´é‡åˆ—ã«æƒãˆã‚‹\n                # ï¼ˆPyCaretã®setupã§ä½¿ç”¨ã—ãŸç‰¹å¾´é‡ã®ã¿ã‚’ä½¿ç”¨ï¼‰\n                pred_df = pd.DataFrame([pred_features])\n                \n                # date, store_id, sku_id ã¯äºˆæ¸¬ã«ä½¿ã‚ãªã„\n                pred_df = pred_df.drop(columns=['date'], errors='ignore')\n                \n                # å­¦ç¿’æ™‚ã«é™¤å¤–ã—ãŸåˆ—ã‚‚é™¤å¤–\n                for col in ['store_id', 'sku_id', 'å¤©æ°—']:\n                    if col in pred_df.columns:\n                        pred_df = pred_df.drop(columns=[col], errors='ignore')\n                \n                # å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«å­˜åœ¨ã—ãªã„åˆ—ã‚’å‰Šé™¤ã€ä¸è¶³åˆ—ã‚’è¿½åŠ ï¼ˆ0ã§åŸ‹ã‚ã‚‹ï¼‰\n                try:\n                    # PyCaretã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨åŒã˜åˆ—ã«æƒãˆã‚‹\n                    training_cols = [c for c in feat.columns if c not in ['date', 'store_id', 'sales_amt']]\n                    \n                    # ä¸è¶³åˆ—ã‚’è¿½åŠ ï¼ˆ0ã§åŸ‹ã‚ã‚‹ï¼‰\n                    for col in training_cols:\n                        if col not in pred_df.columns:\n                            pred_df[col] = 0\n                    \n                    # ä½™åˆ†ãªåˆ—ã‚’å‰Šé™¤\n                    pred_df = pred_df[[c for c in pred_df.columns if c in training_cols]]\n                    \n                    # æ¬ æå€¤ã‚’0ã§åŸ‹ã‚ã‚‹\n                    pred_df = pred_df.fillna(0)\n                    \n                    # äºˆæ¸¬å®Ÿè¡Œ\n                    pred_result = predict_model(final, data=pred_df)\n                    predicted_sales_amt = pred_result['prediction_label'].iloc[0]\n                    \n                    # éå»ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è©²å½“å•†å“ã®å¹³å‡å˜ä¾¡ã‚’å–å¾—\n                    if 'price' in df.columns and 'sku_id' in df.columns:\n                        sku_price = df[df['sku_id'] == sku]['price'].dropna()\n                        avg_price = sku_price.mean() if not sku_price.empty else 100  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ100å††\n                    else:\n                        avg_price = 100\n                    \n                    # è²©å£²æ•°é‡ = å£²ä¸Šé‡‘é¡ / å˜ä¾¡\n                    predicted_qty = predicted_sales_amt / avg_price if avg_price > 0 else 0\n                    predicted_qty = max(0, predicted_qty)  # è² ã®å€¤ã‚’é˜²æ­¢\n                    \n                    # ç™ºæ³¨æ•°é‡ = äºˆæ¸¬è²©å£²æ•°é‡ Ã— å®‰å…¨ä¿‚æ•°\n                    order_qty = predicted_qty * SAFETY_FACTOR\n                    order_qty = int(np.ceil(order_qty))  # åˆ‡ã‚Šä¸Šã’\n                    \n                    # ã‚«ãƒ†ã‚´ãƒªæƒ…å ±ã‚’å–å¾—ï¼ˆéå»ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ï¼‰\n                    sku_info = df[df['sku_id'] == sku][['category_l', 'category_m', 'category_s']].drop_duplicates()\n                    category_l = sku_info['category_l'].iloc[0] if not sku_info.empty and 'category_l' in sku_info.columns else 'ä¸æ˜'\n                    category_m = sku_info['category_m'].iloc[0] if not sku_info.empty and 'category_m' in sku_info.columns else 'ä¸æ˜'\n                    category_s = sku_info['category_s'].iloc[0] if not sku_info.empty and 'category_s' in sku_info.columns else 'ä¸æ˜'\n                    \n                    # çµæœã‚’ä¿å­˜\n                    all_predictions.append({\n                        'æ—¥ä»˜': row['date'].strftime('%Y-%m-%d'),\n                        'æ›œæ—¥': row['date'].strftime('%A'),\n                        'åº—èˆ—': store,\n                        'å•†å“ã‚³ãƒ¼ãƒ‰': sku,\n                        'å¤§åˆ†é¡': category_l,\n                        'ä¸­åˆ†é¡': category_m,\n                        'å°åˆ†é¡': category_s,\n                        'äºˆæ¸¬å£²ä¸Šé‡‘é¡': int(predicted_sales_amt),\n                        'äºˆæ¸¬è²©å£²æ•°é‡': int(predicted_qty),\n                        'ç™ºæ³¨æ•°é‡': order_qty,\n                        'å˜ä¾¡': int(avg_price),\n                        'å¤©æ°—': row['å¤©æ°—'],\n                        'æ°—æ¸©': row['å¹³å‡æ°—æ¸©'],\n                        'é€±æœ«': 'é€±æœ«' if row['é€±æœ«ãƒ•ãƒ©ã‚°'] == 1 else 'å¹³æ—¥',\n                    })\n                    \n                except Exception as e:\n                    # äºˆæ¸¬å¤±æ•—æ™‚ã¯ã‚¹ã‚­ãƒƒãƒ—\n                    pass\n                \n                # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤ºï¼ˆ100ä»¶ã”ã¨ï¼‰\n                processed += 1\n                if processed % 100 == 0:\n                    progress_pct = (processed / total_combinations) * 100\n                    print(f'  é€²æ—: {processed:,}/{total_combinations:,} ä»¶ ({progress_pct:.1f}%)', end='\\r')\n    \n    # DataFrameã«å¤‰æ›\n    forecast_result = pd.DataFrame(all_predictions)\n    \n    print(f'\\n\\nâœ… äºˆæ¸¬å®Œäº†: {len(forecast_result):,} ä»¶')\n    print(f'\\nğŸ“Š äºˆæ¸¬çµæœã‚µãƒãƒªãƒ¼:')\n    print(f'  ç·ç™ºæ³¨æ•°é‡: {forecast_result[\"ç™ºæ³¨æ•°é‡\"].sum():,} å€‹')\n    print(f'  ç·äºˆæ¸¬å£²ä¸Š: Â¥{forecast_result[\"äºˆæ¸¬å£²ä¸Šé‡‘é¡\"].sum():,}')\n    print(f'  å¹³å‡ç™ºæ³¨æ•°é‡/å•†å“/æ—¥: {forecast_result[\"ç™ºæ³¨æ•°é‡\"].mean():.1f} å€‹')\n    \n    # æ—¥ä»˜åˆ¥ã‚µãƒãƒªãƒ¼\n    print(f'\\nğŸ“… æ—¥ä»˜åˆ¥ã‚µãƒãƒªãƒ¼:')\n    daily_summary = forecast_result.groupby('æ—¥ä»˜').agg({\n        'ç™ºæ³¨æ•°é‡': 'sum',\n        'äºˆæ¸¬å£²ä¸Šé‡‘é¡': 'sum',\n        'å•†å“ã‚³ãƒ¼ãƒ‰': 'count'\n    }).rename(columns={'å•†å“ã‚³ãƒ¼ãƒ‰': 'å•†å“ç¨®é¡æ•°'})\n    display(daily_summary)\n    \n    # ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚µãƒãƒªãƒ¼\n    print(f'\\nğŸ“¦ ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚µãƒãƒªãƒ¼ï¼ˆå¤§åˆ†é¡ï¼‰:')\n    category_summary = forecast_result.groupby('å¤§åˆ†é¡').agg({\n        'ç™ºæ³¨æ•°é‡': 'sum',\n        'äºˆæ¸¬å£²ä¸Šé‡‘é¡': 'sum'\n    }).sort_values('äºˆæ¸¬å£²ä¸Šé‡‘é¡', ascending=False)\n    display(category_summary.head(10))\n    \n    # ä¸Šä½å•†å“ï¼ˆç™ºæ³¨æ•°é‡ãƒˆãƒƒãƒ—20ï¼‰\n    print(f'\\nğŸ” ç™ºæ³¨æ•°é‡ãƒˆãƒƒãƒ—20ï¼ˆ1é€±é–“åˆè¨ˆï¼‰:')\n    top_products = forecast_result.groupby(['å•†å“ã‚³ãƒ¼ãƒ‰', 'å¤§åˆ†é¡', 'ä¸­åˆ†é¡']).agg({\n        'ç™ºæ³¨æ•°é‡': 'sum',\n        'äºˆæ¸¬å£²ä¸Šé‡‘é¡': 'sum'\n    }).sort_values('ç™ºæ³¨æ•°é‡', ascending=False).head(20)\n    display(top_products)\n    \n    # ã‚µãƒ³ãƒ—ãƒ«è¡¨ç¤º\n    print(f'\\nğŸ“‹ äºˆæ¸¬çµæœã‚µãƒ³ãƒ—ãƒ«ï¼ˆæœ€åˆã®50ä»¶ï¼‰:')\n    display(forecast_result.head(50))",
   "metadata": {},
   "execution_count": null,
   "outputs": []
  },
  {
   "cell_type": "markdown",
   "id": "slf8tnkekhn",
   "source": "## ğŸ“Š ã‚¹ãƒ†ãƒƒãƒ—7: ç™ºæ³¨äºˆæ¸¬çµæœã®èª­ã¿æ–¹ã¨å®Ÿå‹™ã§ã®ä½¿ã„æ–¹\n\n### ğŸ¯ **ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„**\n**ä¸Šã§å‡ºåŠ›ã•ã‚ŒãŸç™ºæ³¨äºˆæ¸¬è¡¨ã‚’ã€æ˜æ—¥ã‹ã‚‰ã©ã†ä½¿ã†ã‹ã‚’è§£èª¬ã—ã¾ã™ã€‚**\n\n---\n\n## 1ï¸âƒ£ å‡ºåŠ›ã•ã‚ŒãŸCSVãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹\n\n### ğŸ“‹ **ãƒ¡ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«: `ç™ºæ³¨äºˆæ¸¬_2025-10-15_to_2025-10-21.csv`**\n\nã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€å…¨å•†å“Ã—7æ—¥åˆ†ã®ç™ºæ³¨äºˆæ¸¬ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚\n\n| åˆ—å | æ„å‘³ | ä½¿ã„æ–¹ |\n|------|------|--------|\n| **æ—¥ä»˜** | è²©å£²äºˆå®šæ—¥ | ã“ã®æ—¥ã«åº—é ­ã«ä¸¦ã¶å•†å“ |\n| **æ›œæ—¥** | æ›œæ—¥ï¼ˆMondayï½Sundayï¼‰ | æ›œæ—¥åˆ¥ã®ç™ºæ³¨ãƒ‘ã‚¿ãƒ¼ãƒ³ç¢ºèª |\n| **åº—èˆ—** | åº—èˆ—ã‚³ãƒ¼ãƒ‰ | è¤‡æ•°åº—èˆ—ã®å ´åˆã€åº—èˆ—ã”ã¨ã«åˆ†ã‘ã‚‹ |\n| **å•†å“ã‚³ãƒ¼ãƒ‰** | SKUè­˜åˆ¥å­ | ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å…¥åŠ›å€¤ |\n| **å¤§åˆ†é¡/ä¸­åˆ†é¡/å°åˆ†é¡** | ã‚«ãƒ†ã‚´ãƒª | ç™ºæ³¨ä½œæ¥­ã®æ•´ç†ç”¨ |\n| **äºˆæ¸¬è²©å£²æ•°é‡** | AIã®äºˆæ¸¬å€¤ | ã“ã®æ•°é‡ãŒå£²ã‚Œã‚‹ã¨äºˆæ¸¬ |\n| **ç™ºæ³¨æ•°é‡** | å®Ÿéš›ã®ç™ºæ³¨æ•° | **ã“ã‚Œã‚’ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ ã«å…¥åŠ›** |\n| **å˜ä¾¡** | å¹³å‡å˜ä¾¡ | äºˆç®—è¨ˆç®—ç”¨ |\n| **å¤©æ°—/æ°—æ¸©** | äºˆæ¸¬æ—¥ã®å¤©å€™ | åˆ¤æ–­ææ–™ |\n| **é€±æœ«** | é€±æœ«/å¹³æ—¥ãƒ•ãƒ©ã‚° | é€±æœ«å¯¾å¿œã®ç›®å° |\n\n---\n\n### ğŸ“… **æ—¥ä»˜åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«: `ç™ºæ³¨äºˆæ¸¬_2025-10-15.csv`**\n\nå„æ—¥ä»˜ã”ã¨ã«åˆ†å‰²ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚\n\n**ä½¿ã„æ–¹**:\n1. æ¯æœã€**ãã®æ—¥ã®ç™ºæ³¨ãƒ•ã‚¡ã‚¤ãƒ«**ã‚’é–‹ã\n2. **ç™ºæ³¨æ•°é‡**åˆ—ã‚’ãã®ã¾ã¾ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ ã«å…¥åŠ›\n3. ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ã‚½ãƒ¼ãƒˆã—ã¦ã€åŠ¹ç‡çš„ã«ç™ºæ³¨ä½œæ¥­ã‚’é€²ã‚ã‚‹\n\n---\n\n### ğŸª **åº—èˆ—åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«: `ç™ºæ³¨äºˆæ¸¬_åº—èˆ—A_2025-10-15.csv`**\n\nè¤‡æ•°åº—èˆ—ãŒã‚ã‚‹å ´åˆã€åº—èˆ—ã”ã¨ã«åˆ†å‰²ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚\n\n**ä½¿ã„æ–¹**:\n- å„åº—èˆ—ã®åº—é•·ã«é…å¸ƒ\n- åº—èˆ—ã”ã¨ã®ç‰¹æ€§ã‚’åæ˜ ã—ãŸç™ºæ³¨ãŒå¯èƒ½\n\n---\n\n## 2ï¸âƒ£ ç™ºæ³¨ä½œæ¥­ã®å®Ÿå‹™ãƒ•ãƒ­ãƒ¼ï¼ˆæ¯æ—¥ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ï¼‰\n\n### ğŸ“ **æ¯æœã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**\n\n#### **ã‚¹ãƒ†ãƒƒãƒ—1: CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãï¼ˆ5åˆ†ï¼‰**\n```\n1. output/ç™ºæ³¨äºˆæ¸¬_[ä»Šæ—¥ã®æ—¥ä»˜].csv ã‚’é–‹ã\n2. Excelã§é–‹ã„ã¦ã€ã‚«ãƒ†ã‚´ãƒªã§ã‚½ãƒ¼ãƒˆ\n3. ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ ã¨ç”»é¢ã‚’ä¸¦ã¹ã‚‹\n```\n\n#### **ã‚¹ãƒ†ãƒƒãƒ—2: ç™ºæ³¨æ•°é‡ã‚’ç¢ºèªï¼ˆ5åˆ†ï¼‰**\n```\nâ–¡ ç™ºæ³¨æ•°é‡ãŒç•°å¸¸ã«å¤šã„å•†å“ã¯ãªã„ã‹ï¼Ÿ\n  â†’ é€šå¸¸ã®2å€ä»¥ä¸Š â†’ å¤©æ°—ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã‚’å†ç¢ºèª\n  â†’ å•é¡Œãªã‘ã‚Œã°ãã®ã¾ã¾ç™ºæ³¨\n\nâ–¡ ç™ºæ³¨æ•°é‡ãŒ0ã®å•†å“ã¯ãªã„ã‹ï¼Ÿ\n  â†’ 0ã®å ´åˆ â†’ éå»å®Ÿç¸¾ã‚’ç¢ºèªã—ã¦å°‘é‡ç™ºæ³¨ã‚’æ¤œè¨\n```\n\n#### **ã‚¹ãƒ†ãƒƒãƒ—3: ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ ã«å…¥åŠ›ï¼ˆ10ï½15åˆ†ï¼‰**\n```\n1. ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«ç™ºæ³¨æ•°é‡ã‚’å…¥åŠ›\n2. ç‰¹ã«æ³¨æ„ã™ã¹ãå•†å“:\n   - ç™ºæ³¨æ•°é‡ãƒˆãƒƒãƒ—20 â†’ æ¬ å“ã•ã›ãªã„\n   - é›¨ã®æ—¥ã«å£²ã‚Œã‚‹å•†å“ â†’ é™æ°´ç¢ºç‡ã‚’å†ç¢ºèª\n   - é€±æœ«ã«å£²ã‚Œã‚‹å•†å“ â†’ é‡‘æ›œã®æœã¾ã§ã«ç™ºæ³¨\n```\n\n#### **ã‚¹ãƒ†ãƒƒãƒ—4: èª¿æ•´ï¼ˆ5åˆ†ï¼‰**\n```\nâ–¡ å¤©æ°—äºˆå ±ãŒå¤‰ã‚ã£ã¦ã„ãªã„ã‹ç¢ºèª\n  â†’ å¤‰ã‚ã£ã¦ã„ã‚‹å ´åˆã€æ‰‹å‹•ã§Â±10%èª¿æ•´\n\nâ–¡ çªç™ºã‚¤ãƒ™ãƒ³ãƒˆï¼ˆã‚»ãƒ¼ãƒ«ãªã©ï¼‰ãŒãªã„ã‹ç¢ºèª\n  â†’ ã‚ã‚‹å ´åˆã€è©²å½“ã‚«ãƒ†ã‚´ãƒªã‚’+20ï½30%å¢—é‡\n\nâ–¡ æ˜¨æ—¥ã®å£²ä¸Šå®Ÿç¸¾ã¨æ¯”è¼ƒ\n  â†’ äºˆæ¸¬ãŒå¤§ããå¤–ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯\n```\n\n---\n\n## 3ï¸âƒ£ çµæœã®èª­ã¿æ–¹ï¼ˆæ•°å­—ã®æ„å‘³ï¼‰\n\n### ğŸ“Š **æ—¥ä»˜åˆ¥ã‚µãƒãƒªãƒ¼ã®è¦‹æ–¹**\n\nä¸Šã®ã‚»ãƒ«ã§è¡¨ç¤ºã•ã‚ŒãŸã€Œæ—¥ä»˜åˆ¥ã‚µãƒãƒªãƒ¼ã€:\n\n| æ—¥ä»˜ | ç™ºæ³¨æ•°é‡ | äºˆæ¸¬å£²ä¸Šé‡‘é¡ | å•†å“ç¨®é¡æ•° |\n|------|----------|------------|----------|\n| 2025-10-15 | 850 | Â¥127,500 | 120 |\n| 2025-10-16 | 820 | Â¥123,000 | 120 |\n| 2025-10-19 (é›¨) | 950 | Â¥142,500 | 120 |\n\n**èª­ã¿æ–¹**:\n- **10/19ï¼ˆé›¨ã®æ—¥ï¼‰** â†’ ç™ºæ³¨æ•°é‡ãŒé€šå¸¸ã‚ˆã‚Š+15%å¢—\n- **æ„å‘³**: AIãŒã€Œé›¨ã®æ—¥ã¯å£²ä¸ŠãŒå¢—ãˆã‚‹ã€ã¨åˆ¤æ–­\n- **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: æ¸©ã‹ã„å•†å“ãƒ»ã‚«ãƒƒãƒ—éººãªã©ã‚’é‡ç‚¹ç™ºæ³¨\n\n---\n\n### ğŸ“¦ **ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚µãƒãƒªãƒ¼ã®è¦‹æ–¹**\n\n| å¤§åˆ†é¡ | ç™ºæ³¨æ•°é‡ | äºˆæ¸¬å£²ä¸Šé‡‘é¡ |\n|--------|----------|------------|\n| å¼å½“ | 2,100 | Â¥315,000 |\n| é£²æ–™ | 1,800 | Â¥108,000 |\n| ç·èœ | 1,500 | Â¥225,000 |\n\n**èª­ã¿æ–¹**:\n- **å¼å½“ãŒæœ€ã‚‚å£²ã‚Œã‚‹** â†’ é™³åˆ—ã‚¹ãƒšãƒ¼ã‚¹ã‚’æœ€å„ªå…ˆç¢ºä¿\n- **ç™ºæ³¨æ•°é‡ã®æ¯”ç‡** â†’ æ£šå‰²ã‚Šã®å‚è€ƒã«\n\n---\n\n### ğŸ” **ç™ºæ³¨æ•°é‡ãƒˆãƒƒãƒ—20ã®ä½¿ã„æ–¹**\n\nä¸Šä½20å•†å“ = **çµ¶å¯¾ã«æ¬ å“ã•ã›ã¦ã¯ã„ã‘ãªã„å•†å“**\n\n**å®Ÿå‹™ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:\n1. **æ¯æ—¥ãƒã‚§ãƒƒã‚¯** â†’ ãƒˆãƒƒãƒ—20å•†å“ã®åœ¨åº«ã‚’æ¯å¤•ç¢ºèª\n2. **ãƒ•ã‚§ãƒ¼ã‚¹å¢—** â†’ é™³åˆ—ã‚¹ãƒšãƒ¼ã‚¹ã‚’é€šå¸¸ã®1.5å€ç¢ºä¿\n3. **å‰å‡ºã—å¼·åŒ–** â†’ æ˜¼ãƒ»å¤•ãƒ”ãƒ¼ã‚¯å‰ã«å¿…ãšå‰å‡ºã—\n4. **æ¬ å“æ™‚ã®å¯¾å¿œ** â†’ äºˆå‚™åœ¨åº«ã‚’ç”¨æ„ã€ã¾ãŸã¯é¡ä¼¼å•†å“ã§ä»£æ›¿\n\n---\n\n## 4ï¸âƒ£ ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰\n\n### â“ **äºˆæ¸¬ãŒå¤–ã‚ŒãŸå ´åˆã¯ã©ã†ã™ã‚‹ï¼Ÿ**\n\n**å›ç­”**:\n- **1æ—¥ã ã‘å¤–ã‚ŒãŸ** â†’ çªç™ºè¦å› ï¼ˆç«¶åˆåº—ã®ã‚»ãƒ¼ãƒ«ç­‰ï¼‰ã®å¯èƒ½æ€§ã€‚è¨˜éŒ²ã—ã¦æ¬¡å›ã«æ´»ã‹ã™\n- **é€£ç¶šã§å¤–ã‚Œã‚‹** â†’ AIã®å†å­¦ç¿’ãŒå¿…è¦ã€‚ãƒ‡ãƒ¼ã‚¿æœŸé–“ã‚’å»¶é•·ï¼ˆ3ãƒ¶æœˆâ†’6ãƒ¶æœˆï¼‰ã—ã¦å†å®Ÿè¡Œ\n\n---\n\n### â“ **å®‰å…¨ä¿‚æ•°ã¯ã©ã†æ±ºã‚ã‚‹ï¼Ÿ**\n\n**å›ç­”**:\n\n| çŠ¶æ³ | æ¨å¥¨å€¤ | ç†ç”± |\n|------|--------|------|\n| **é€šå¸¸é‹ç”¨** | 1.1ï½1.2 | æ¬ å“ã¨å»ƒæ£„ã®ãƒãƒ©ãƒ³ã‚¹ |\n| **æ–°å•†å“** | 1.3ï½1.5 | éœ€è¦ãŒèª­ã‚ãªã„ãŸã‚ä¿å®ˆçš„ã« |\n| **å»ƒæ£„ç‡ãŒé«˜ã„** | 1.0ï½1.1 | å»ƒæ£„å‰Šæ¸›ã‚’å„ªå…ˆ |\n| **æ¬ å“ãŒå¤šç™º** | 1.2ï½1.3 | å£²ä¸Šæ©Ÿä¼šæå¤±ã‚’é˜²ã |\n\n**èª¿æ•´æ–¹æ³•**:\n- 1é€±é–“é‹ç”¨ã—ã¦ã€å»ƒæ£„ç‡ã¨æ¬ å“ç‡ã‚’æ¸¬å®š\n- å»ƒæ£„ç‡5%ä»¥ä¸Š â†’ å®‰å…¨ä¿‚æ•°ã‚’-0.1ä¸‹ã’ã‚‹\n- æ¬ å“ç‡3%ä»¥ä¸Š â†’ å®‰å…¨ä¿‚æ•°ã‚’+0.1ä¸Šã’ã‚‹\n\n---\n\n### â“ **å¤©æ°—äºˆå ±ãŒå¤‰ã‚ã£ãŸã‚‰ã©ã†ã™ã‚‹ï¼Ÿ**\n\n**å›ç­”**:\n1. **å‰æ—¥å¤•æ–¹** ã«æœ€æ–°ã®å¤©æ°—äºˆå ±ã‚’ç¢ºèª\n2. **é™æ°´ç¢ºç‡ãŒ30%ä»¥ä¸Šå¤‰ã‚ã£ãŸå ´åˆ**:\n   - æ™´ã‚Œâ†’é›¨ â†’ æ¸©ã‹ã„å•†å“ã‚’+10ï½20%å¢—é‡\n   - é›¨â†’æ™´ã‚Œ â†’ å†·ãŸã„å•†å“ã‚’+10ï½20%å¢—é‡\n3. **æ°—æ¸©ãŒ5â„ƒä»¥ä¸Šå¤‰ã‚ã£ãŸå ´åˆ**:\n   - æš‘ããªã‚‹ â†’ å†·é£²æ–™ãƒ»ã‚¢ã‚¤ã‚¹ã‚’+20%å¢—é‡\n   - å¯’ããªã‚‹ â†’ ãƒ›ãƒƒãƒˆé£²æ–™ãƒ»ç·èœã‚’+20%å¢—é‡\n\n---\n\n### â“ **ç™ºæ³¨æ•°é‡ãŒ0ã®å•†å“ã¯ã©ã†ã™ã‚‹ï¼Ÿ**\n\n**å›ç­”**:\n- **AIã®åˆ¤æ–­**: ãã®å•†å“ã¯ãã®æ—¥å£²ã‚Œã«ãã„\n- **å®Ÿå‹™å¯¾å¿œ**:\n  1. éå»å®Ÿç¸¾ã‚’ç¢ºèª â†’ æœ¬å½“ã«å£²ã‚Œã¦ã„ãªã„ã‹ï¼Ÿ\n  2. å£²ã‚Œã¦ã„ã‚‹ â†’ æœ€ä½ç™ºæ³¨æ•°ï¼ˆ1ï½2å€‹ï¼‰ã‚’æ‰‹å‹•å…¥åŠ›\n  3. å£²ã‚Œã¦ã„ãªã„ â†’ 0ã®ã¾ã¾ç™ºæ³¨ã—ãªã„ï¼ˆåœ¨åº«å‰Šæ¸›ï¼‰\n\n---\n\n## 5ï¸âƒ£ åŠ¹æœæ¸¬å®šï¼ˆ1é€±é–“å¾Œã«ãƒã‚§ãƒƒã‚¯ï¼‰\n\n### âœ… **æˆåŠŸæŒ‡æ¨™**\n\n| æŒ‡æ¨™ | ç›®æ¨™å€¤ | æ¸¬å®šæ–¹æ³• |\n|------|--------|----------|\n| **æ¬ å“ç‡** | 3%ä»¥ä¸‹ | æ¬ å“å•†å“æ•° Ã· å…¨å•†å“æ•° |\n| **å»ƒæ£„ç‡** | 5%ä»¥ä¸‹ | å»ƒæ£„æ•°é‡ Ã· ç™ºæ³¨æ•°é‡ |\n| **äºˆæ¸¬ç²¾åº¦** | 80%ä»¥ä¸Š | å®Ÿå£²æ•°é‡ Ã· äºˆæ¸¬æ•°é‡ |\n| **å£²ä¸Šå¢—åŠ ç‡** | +5%ä»¥ä¸Š | ä»Šé€±å£²ä¸Š vs å…ˆé€±å£²ä¸Š |\n\n**æ¸¬å®šã‚·ãƒ¼ãƒˆï¼ˆExcelã§ä½œæˆï¼‰**:\n```\n| æ—¥ä»˜ | ç™ºæ³¨æ•°é‡ | å®Ÿå£²æ•°é‡ | å»ƒæ£„æ•°é‡ | æ¬ å“å•†å“æ•° | äºˆæ¸¬ç²¾åº¦ |\n|------|----------|----------|----------|-----------|---------|\n| 10/15 | 850 | 820 | 30 | 2 | 96% |\n| 10/16 | 820 | 790 | 30 | 1 | 96% |\n| ...  | ... | ... | ... | ... | ... |\n```\n\n---\n\n## ğŸ“Œ ã¾ã¨ã‚: AIç™ºæ³¨äºˆæ¸¬ã®æ´»ç”¨ãƒã‚¤ãƒ³ãƒˆ\n\n### **æœ€é‡è¦ãƒã‚¤ãƒ³ãƒˆ 3ã¤**\n\n1. **æ¯æœ5åˆ†ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³åŒ–**\n   - CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã â†’ ç™ºæ³¨æ•°é‡ã‚’ç¢ºèª â†’ ç™ºæ³¨ã‚·ã‚¹ãƒ†ãƒ ã«å…¥åŠ›\n\n2. **ãƒˆãƒƒãƒ—20å•†å“ã¯çµ¶å¯¾æ¬ å“ã•ã›ãªã„**\n   - æ¯å¤•ã€åœ¨åº«ãƒã‚§ãƒƒã‚¯\n   - ãƒ•ã‚§ãƒ¼ã‚¹1.5å€ç¢ºä¿\n   - äºˆå‚™åœ¨åº«ã‚’ç”¨æ„\n\n3. **1é€±é–“é‹ç”¨ã—ã¦ã€å®‰å…¨ä¿‚æ•°ã‚’èª¿æ•´**\n   - å»ƒæ£„ç‡5%ä»¥ä¸Š â†’ ä¿‚æ•°-0.1\n   - æ¬ å“ç‡3%ä»¥ä¸Š â†’ ä¿‚æ•°+0.1\n\n---\n\n**ã“ã‚Œã§ã€AIç™ºæ³¨äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ ã®èª¬æ˜ã¯å®Œäº†ã§ã™ï¼**\n\næ˜æ—¥ã‹ã‚‰å®Ÿéš›ã«é‹ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚1é€±é–“å¾Œã«åŠ¹æœã‚’æ¸¬å®šã—ã€ç¶™ç¶šçš„ã«æ”¹å–„ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚",
   "metadata": {}
  },
  {
   "cell_type": "code",
   "id": "s6sn7okpdz",
   "source": "# ========================================\n# ğŸ’¾ Step 6-3: ç™ºæ³¨è¡¨ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›\n# ========================================\n\nif 'forecast_result' in globals() and not forecast_result.empty:\n    # å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å\n    output_filename = f'ç™ºæ³¨äºˆæ¸¬_{FORECAST_START_DATE}_to_{forecast_dates[-1].strftime(\"%Y-%m-%d\")}.csv'\n    output_path = Path('output') / output_filename\n    \n    # outputãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒãªã‘ã‚Œã°ä½œæˆ\n    output_path.parent.mkdir(parents=True, exist_ok=True)\n    \n    # CSVå‡ºåŠ›\n    forecast_result.to_csv(output_path, index=False, encoding='utf-8-sig')\n    \n    print('='*60)\n    print('ğŸ’¾ ç™ºæ³¨è¡¨ã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¾ã—ãŸ')\n    print('='*60)\n    print(f'ãƒ•ã‚¡ã‚¤ãƒ«å: {output_path}')\n    print(f'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: {output_path.stat().st_size / 1024:.1f} KB')\n    print(f'ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: {len(forecast_result):,} ä»¶')\n    \n    # æ—¥ä»˜åˆ¥ã«åˆ†å‰²ã—ãŸCSVã‚‚å‡ºåŠ›\n    print(f'\\nğŸ“… æ—¥ä»˜åˆ¥CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‡ºåŠ›ã—ã¾ã™...')\n    for date in forecast_result['æ—¥ä»˜'].unique():\n        date_df = forecast_result[forecast_result['æ—¥ä»˜'] == date].copy()\n        date_filename = f'ç™ºæ³¨äºˆæ¸¬_{date}.csv'\n        date_path = Path('output') / date_filename\n        date_df.to_csv(date_path, index=False, encoding='utf-8-sig')\n        print(f'  âœ… {date_filename} ({len(date_df):,} ä»¶)')\n    \n    # åº—èˆ—åˆ¥ã«åˆ†å‰²ã—ãŸCSVã‚‚å‡ºåŠ›\n    if 'åº—èˆ—' in forecast_result.columns and forecast_result['åº—èˆ—'].nunique() > 1:\n        print(f'\\nğŸª åº—èˆ—åˆ¥CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‡ºåŠ›ã—ã¾ã™...')\n        for store in forecast_result['åº—èˆ—'].unique():\n            store_df = forecast_result[forecast_result['åº—èˆ—'] == store].copy()\n            store_filename = f'ç™ºæ³¨äºˆæ¸¬_åº—èˆ—{store}_{FORECAST_START_DATE}.csv'\n            store_path = Path('output') / store_filename\n            store_df.to_csv(store_path, index=False, encoding='utf-8-sig')\n            print(f'  âœ… {store_filename} ({len(store_df):,} ä»¶)')\n    \n    print(f'\\nâœ… ã™ã¹ã¦ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ output/ ã«ä¿å­˜ã—ã¾ã—ãŸ')\n    \nelse:\n    print('[ERROR] äºˆæ¸¬çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã«Step 6-2ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚')",
   "metadata": {},
   "execution_count": null,
   "outputs": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "name": "python",
   "version": "3.x"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}